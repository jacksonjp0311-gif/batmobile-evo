// Auto-generated FUSED tensor product operations
// All CG paths fully unrolled at compile time for L_max=3
// Generated from e3nn Wigner 3j symbols

#pragma once

#include <cuda_runtime.h>

namespace batteries {
namespace fused {

constexpr int NUM_IRREPS = 16;       // (3+1)^2
constexpr int NUM_PATHS = 34;

// Simple tensor product: out += in1 x in2 (no weights)
__device__ __forceinline__ void tensor_product_simple_unrolled(
    const float* __restrict__ in1,
    const float* __restrict__ in2,
    float* __restrict__ out
) {
    // Path 0: (0,0)->0, 1 entries
    out[0] += 1.0000000000f * in1[0] * in2[0];

    // Path 1: (0,1)->1, 3 entries
    out[1] += 0.9999999821f * in1[0] * in2[1];
    out[2] += 0.9999999821f * in1[0] * in2[2];
    out[3] += 0.9999999821f * in1[0] * in2[3];

    // Path 2: (0,2)->2, 5 entries
    out[4] += 0.9999999880f * in1[0] * in2[4];
    out[5] += 0.9999999880f * in1[0] * in2[5];
    out[6] += 0.9999999880f * in1[0] * in2[6];
    out[7] += 0.9999999880f * in1[0] * in2[7];
    out[8] += 0.9999999880f * in1[0] * in2[8];

    // Path 3: (0,3)->3, 7 entries
    out[9] += 0.9999999836f * in1[0] * in2[9];
    out[10] += 0.9999999836f * in1[0] * in2[10];
    out[11] += 0.9999999836f * in1[0] * in2[11];
    out[12] += 0.9999999836f * in1[0] * in2[12];
    out[13] += 0.9999999836f * in1[0] * in2[13];
    out[14] += 0.9999999836f * in1[0] * in2[14];
    out[15] += 0.9999999836f * in1[0] * in2[15];

    // Path 4: (1,0)->1, 3 entries
    out[1] += 0.9999999821f * in1[1] * in2[0];
    out[2] += 0.9999999821f * in1[2] * in2[0];
    out[3] += 0.9999999821f * in1[3] * in2[0];

    // Path 5: (1,1)->0, 3 entries
    out[0] += 0.5773502588f * in1[1] * in2[1];
    out[0] += 0.5773502588f * in1[2] * in2[2];
    out[0] += 0.5773502588f * in1[3] * in2[3];

    // Path 6: (1,1)->1, 6 entries
    out[3] += 0.7071068069f * in1[1] * in2[2];
    out[2] += -0.7071068069f * in1[1] * in2[3];
    out[3] += -0.7071068069f * in1[2] * in2[1];
    out[1] += 0.7071068069f * in1[2] * in2[3];
    out[2] += 0.7071068069f * in1[3] * in2[1];
    out[1] += -0.7071068069f * in1[3] * in2[2];

    // Path 7: (1,1)->2, 11 entries
    out[6] += -0.4082482836f * in1[1] * in2[1];
    out[8] += -0.7071067764f * in1[1] * in2[1];
    out[5] += 0.7071067764f * in1[1] * in2[2];
    out[4] += 0.7071067764f * in1[1] * in2[3];
    out[5] += 0.7071067764f * in1[2] * in2[1];
    out[6] += 0.8164965671f * in1[2] * in2[2];
    out[7] += 0.7071067764f * in1[2] * in2[3];
    out[4] += 0.7071067764f * in1[3] * in2[1];
    out[7] += 0.7071067764f * in1[3] * in2[2];
    out[6] += -0.4082482836f * in1[3] * in2[3];
    out[8] += 0.7071067764f * in1[3] * in2[3];

    // Path 8: (1,2)->1, 11 entries
    out[3] += 0.5477225538f * in1[1] * in2[4];
    out[2] += 0.5477225538f * in1[1] * in2[5];
    out[1] += -0.3162277607f * in1[1] * in2[6];
    out[1] += -0.5477225538f * in1[1] * in2[8];
    out[1] += 0.5477225538f * in1[2] * in2[5];
    out[2] += 0.6324555213f * in1[2] * in2[6];
    out[3] += 0.5477225538f * in1[2] * in2[7];
    out[1] += 0.5477225538f * in1[3] * in2[4];
    out[3] += -0.3162277607f * in1[3] * in2[6];
    out[2] += 0.5477225538f * in1[3] * in2[7];
    out[3] += 0.5477225538f * in1[3] * in2[8];

    // Path 9: (1,2)->2, 16 entries
    out[5] += -0.4082482836f * in1[1] * in2[4];
    out[4] += 0.4082482836f * in1[1] * in2[5];
    out[7] += 0.7071067764f * in1[1] * in2[6];
    out[6] += -0.7071067764f * in1[1] * in2[7];
    out[8] += 0.4082482836f * in1[1] * in2[7];
    out[7] += -0.4082482836f * in1[1] * in2[8];
    out[8] += -0.8164965671f * in1[2] * in2[4];
    out[7] += -0.4082482836f * in1[2] * in2[5];
    out[5] += 0.4082482836f * in1[2] * in2[7];
    out[4] += 0.8164965671f * in1[2] * in2[8];
    out[7] += 0.4082482836f * in1[3] * in2[4];
    out[6] += 0.7071067764f * in1[3] * in2[5];
    out[8] += 0.4082482836f * in1[3] * in2[5];
    out[5] += -0.7071067764f * in1[3] * in2[6];
    out[4] += -0.4082482836f * in1[3] * in2[7];
    out[5] += -0.4082482836f * in1[3] * in2[8];

    // Path 10: (1,2)->3, 21 entries
    out[13] += -0.1825741828f * in1[1] * in2[4];
    out[15] += -0.7071067679f * in1[1] * in2[4];
    out[12] += -0.4472135802f * in1[1] * in2[5];
    out[14] += -0.5773502803f * in1[1] * in2[5];
    out[11] += 0.6324555384f * in1[1] * in2[6];
    out[10] += 0.5773502803f * in1[1] * in2[7];
    out[9] += 0.7071067679f * in1[1] * in2[8];
    out[11] += 0.1825741828f * in1[1] * in2[8];
    out[10] += 0.5773502803f * in1[2] * in2[4];
    out[11] += 0.7302967312f * in1[2] * in2[5];
    out[12] += 0.7745966857f * in1[2] * in2[6];
    out[13] += 0.7302967312f * in1[2] * in2[7];
    out[14] += 0.5773502803f * in1[2] * in2[8];
    out[9] += 0.7071067679f * in1[3] * in2[4];
    out[11] += -0.1825741828f * in1[3] * in2[4];
    out[10] += 0.5773502803f * in1[3] * in2[5];
    out[13] += 0.6324555384f * in1[3] * in2[6];
    out[12] += -0.4472135802f * in1[3] * in2[7];
    out[14] += 0.5773502803f * in1[3] * in2[7];
    out[13] += -0.1825741828f * in1[3] * in2[8];
    out[15] += 0.7071067679f * in1[3] * in2[8];

    // Path 11: (1,3)->2, 21 entries
    out[8] += 0.5976142935f * in1[1] * in2[9];
    out[7] += 0.4879500459f * in1[1] * in2[10];
    out[6] += 0.5345224892f * in1[1] * in2[11];
    out[8] += 0.1543033474f * in1[1] * in2[11];
    out[5] += -0.3779644601f * in1[1] * in2[12];
    out[4] += -0.1543033474f * in1[1] * in2[13];
    out[5] += -0.4879500459f * in1[1] * in2[14];
    out[4] += -0.5976142935f * in1[1] * in2[15];
    out[4] += 0.4879500459f * in1[2] * in2[10];
    out[5] += 0.6172133895f * in1[2] * in2[11];
    out[6] += 0.6546536846f * in1[2] * in2[12];
    out[7] += 0.6172133895f * in1[2] * in2[13];
    out[8] += 0.4879500459f * in1[2] * in2[14];
    out[4] += 0.5976142935f * in1[3] * in2[9];
    out[5] += 0.4879500459f * in1[3] * in2[10];
    out[4] += -0.1543033474f * in1[3] * in2[11];
    out[7] += -0.3779644601f * in1[3] * in2[12];
    out[6] += 0.5345224892f * in1[3] * in2[13];
    out[8] += -0.1543033474f * in1[3] * in2[13];
    out[7] += 0.4879500459f * in1[3] * in2[14];
    out[8] += 0.5976142935f * in1[3] * in2[15];

    // Path 12: (1,3)->3, 26 entries
    out[10] += -0.3535533840f * in1[1] * in2[9];
    out[9] += 0.3535533840f * in1[1] * in2[10];
    out[11] += -0.4564354668f * in1[1] * in2[10];
    out[10] += 0.4564354668f * in1[1] * in2[11];
    out[13] += 0.7071067679f * in1[1] * in2[12];
    out[12] += -0.7071067679f * in1[1] * in2[13];
    out[14] += 0.4564354668f * in1[1] * in2[13];
    out[13] += -0.4564354668f * in1[1] * in2[14];
    out[15] += 0.3535533840f * in1[1] * in2[14];
    out[14] += -0.3535533840f * in1[1] * in2[15];
    out[15] += -0.8660254007f * in1[2] * in2[9];
    out[14] += -0.5773502803f * in1[2] * in2[10];
    out[13] += -0.2886751401f * in1[2] * in2[11];
    out[11] += 0.2886751401f * in1[2] * in2[13];
    out[10] += 0.5773502803f * in1[2] * in2[14];
    out[9] += 0.8660254007f * in1[2] * in2[15];
    out[14] += 0.3535533840f * in1[3] * in2[9];
    out[13] += 0.4564354668f * in1[3] * in2[10];
    out[15] += 0.3535533840f * in1[3] * in2[10];
    out[12] += 0.7071067679f * in1[3] * in2[11];
    out[14] += 0.4564354668f * in1[3] * in2[11];
    out[11] += -0.7071067679f * in1[3] * in2[12];
    out[10] += -0.4564354668f * in1[3] * in2[13];
    out[9] += -0.3535533840f * in1[3] * in2[14];
    out[11] += -0.4564354668f * in1[3] * in2[14];
    out[10] += -0.3535533840f * in1[3] * in2[15];

    // Path 13: (2,0)->2, 5 entries
    out[4] += 0.9999999880f * in1[4] * in2[0];
    out[5] += 0.9999999880f * in1[5] * in2[0];
    out[6] += 0.9999999880f * in1[6] * in2[0];
    out[7] += 0.9999999880f * in1[7] * in2[0];
    out[8] += 0.9999999880f * in1[8] * in2[0];

    // Path 14: (2,1)->1, 11 entries
    out[3] += 0.5477225538f * in1[4] * in2[1];
    out[1] += 0.5477225538f * in1[4] * in2[3];
    out[2] += 0.5477225538f * in1[5] * in2[1];
    out[1] += 0.5477225538f * in1[5] * in2[2];
    out[1] += -0.3162277607f * in1[6] * in2[1];
    out[2] += 0.6324555213f * in1[6] * in2[2];
    out[3] += -0.3162277607f * in1[6] * in2[3];
    out[3] += 0.5477225538f * in1[7] * in2[2];
    out[2] += 0.5477225538f * in1[7] * in2[3];
    out[1] += -0.5477225538f * in1[8] * in2[1];
    out[3] += 0.5477225538f * in1[8] * in2[3];

    // Path 15: (2,1)->2, 16 entries
    out[5] += 0.4082482836f * in1[4] * in2[1];
    out[8] += 0.8164965671f * in1[4] * in2[2];
    out[7] += -0.4082482836f * in1[4] * in2[3];
    out[4] += -0.4082482836f * in1[5] * in2[1];
    out[7] += 0.4082482836f * in1[5] * in2[2];
    out[6] += -0.7071067764f * in1[5] * in2[3];
    out[8] += -0.4082482836f * in1[5] * in2[3];
    out[7] += -0.7071067764f * in1[6] * in2[1];
    out[5] += 0.7071067764f * in1[6] * in2[3];
    out[6] += 0.7071067764f * in1[7] * in2[1];
    out[8] += -0.4082482836f * in1[7] * in2[1];
    out[5] += -0.4082482836f * in1[7] * in2[2];
    out[4] += 0.4082482836f * in1[7] * in2[3];
    out[7] += 0.4082482836f * in1[8] * in2[1];
    out[4] += -0.8164965671f * in1[8] * in2[2];
    out[5] += 0.4082482836f * in1[8] * in2[3];

    // Path 16: (2,1)->3, 21 entries
    out[13] += -0.1825741828f * in1[4] * in2[1];
    out[15] += -0.7071067679f * in1[4] * in2[1];
    out[10] += 0.5773502803f * in1[4] * in2[2];
    out[9] += 0.7071067679f * in1[4] * in2[3];
    out[11] += -0.1825741828f * in1[4] * in2[3];
    out[12] += -0.4472135802f * in1[5] * in2[1];
    out[14] += -0.5773502803f * in1[5] * in2[1];
    out[11] += 0.7302967312f * in1[5] * in2[2];
    out[10] += 0.5773502803f * in1[5] * in2[3];
    out[11] += 0.6324555384f * in1[6] * in2[1];
    out[12] += 0.7745966857f * in1[6] * in2[2];
    out[13] += 0.6324555384f * in1[6] * in2[3];
    out[10] += 0.5773502803f * in1[7] * in2[1];
    out[13] += 0.7302967312f * in1[7] * in2[2];
    out[12] += -0.4472135802f * in1[7] * in2[3];
    out[14] += 0.5773502803f * in1[7] * in2[3];
    out[9] += 0.7071067679f * in1[8] * in2[1];
    out[11] += 0.1825741828f * in1[8] * in2[1];
    out[14] += 0.5773502803f * in1[8] * in2[2];
    out[13] += -0.1825741828f * in1[8] * in2[3];
    out[15] += 0.7071067679f * in1[8] * in2[3];

    // Path 17: (2,2)->0, 5 entries
    out[0] += 0.4472135901f * in1[4] * in2[4];
    out[0] += 0.4472135901f * in1[5] * in2[5];
    out[0] += 0.4472135901f * in1[6] * in2[6];
    out[0] += 0.4472135901f * in1[7] * in2[7];
    out[0] += 0.4472135901f * in1[8] * in2[8];

    // Path 18: (2,2)->1, 16 entries
    out[1] += -0.3162277607f * in1[4] * in2[5];
    out[3] += 0.3162277607f * in1[4] * in2[7];
    out[2] += -0.6324555213f * in1[4] * in2[8];
    out[1] += 0.3162277607f * in1[5] * in2[4];
    out[3] += 0.5477225538f * in1[5] * in2[6];
    out[2] += -0.3162277607f * in1[5] * in2[7];
    out[3] += 0.3162277607f * in1[5] * in2[8];
    out[3] += -0.5477225538f * in1[6] * in2[5];
    out[1] += 0.5477225538f * in1[6] * in2[7];
    out[3] += -0.3162277607f * in1[7] * in2[4];
    out[2] += 0.3162277607f * in1[7] * in2[5];
    out[1] += -0.5477225538f * in1[7] * in2[6];
    out[1] += 0.3162277607f * in1[7] * in2[8];
    out[2] += 0.6324555213f * in1[8] * in2[4];
    out[3] += -0.3162277607f * in1[8] * in2[5];
    out[1] += -0.3162277607f * in1[8] * in2[7];

    // Path 19: (2,2)->2, 25 entries
    out[6] += -0.5345224892f * in1[4] * in2[4];
    out[7] += 0.4629100588f * in1[4] * in2[5];
    out[4] += -0.5345224892f * in1[4] * in2[6];
    out[5] += 0.4629100588f * in1[4] * in2[7];
    out[7] += 0.4629100588f * in1[5] * in2[4];
    out[6] += 0.2672612446f * in1[5] * in2[5];
    out[8] += -0.4629100588f * in1[5] * in2[5];
    out[5] += 0.2672612446f * in1[5] * in2[6];
    out[4] += 0.4629100588f * in1[5] * in2[7];
    out[5] += -0.4629100588f * in1[5] * in2[8];
    out[4] += -0.5345224892f * in1[6] * in2[4];
    out[5] += 0.2672612446f * in1[6] * in2[5];
    out[6] += 0.5345224892f * in1[6] * in2[6];
    out[7] += 0.2672612446f * in1[6] * in2[7];
    out[8] += -0.5345224892f * in1[6] * in2[8];
    out[5] += 0.4629100588f * in1[7] * in2[4];
    out[4] += 0.4629100588f * in1[7] * in2[5];
    out[7] += 0.2672612446f * in1[7] * in2[6];
    out[6] += 0.2672612446f * in1[7] * in2[7];
    out[8] += 0.4629100588f * in1[7] * in2[7];
    out[7] += 0.4629100588f * in1[7] * in2[8];
    out[5] += -0.4629100588f * in1[8] * in2[5];
    out[8] += -0.5345224892f * in1[8] * in2[6];
    out[7] += 0.4629100588f * in1[8] * in2[7];
    out[6] += -0.5345224892f * in1[8] * in2[8];

    // Path 20: (2,2)->3, 28 entries
    out[9] += 0.4999999918f * in1[4] * in2[5];
    out[11] += 0.3872983429f * in1[4] * in2[5];
    out[14] += 0.7071067679f * in1[4] * in2[6];
    out[13] += -0.3872983429f * in1[4] * in2[7];
    out[15] += 0.4999999918f * in1[4] * in2[7];
    out[12] += 0.3162277692f * in1[4] * in2[8];
    out[9] += -0.4999999918f * in1[5] * in2[4];
    out[11] += -0.3872983429f * in1[5] * in2[4];
    out[13] += 0.4472135802f * in1[5] * in2[6];
    out[12] += -0.6324555384f * in1[5] * in2[7];
    out[13] += -0.3872983429f * in1[5] * in2[8];
    out[15] += -0.4999999918f * in1[5] * in2[8];
    out[14] += -0.7071067679f * in1[6] * in2[4];
    out[13] += -0.4472135802f * in1[6] * in2[5];
    out[11] += 0.4472135802f * in1[6] * in2[7];
    out[10] += 0.7071067679f * in1[6] * in2[8];
    out[13] += 0.3872983429f * in1[7] * in2[4];
    out[15] += -0.4999999918f * in1[7] * in2[4];
    out[12] += 0.6324555384f * in1[7] * in2[5];
    out[11] += -0.4472135802f * in1[7] * in2[6];
    out[9] += 0.4999999918f * in1[7] * in2[8];
    out[11] += -0.3872983429f * in1[7] * in2[8];
    out[12] += -0.3162277692f * in1[8] * in2[4];
    out[13] += 0.3872983429f * in1[8] * in2[5];
    out[15] += 0.4999999918f * in1[8] * in2[5];
    out[10] += -0.7071067679f * in1[8] * in2[6];
    out[9] += -0.4999999918f * in1[8] * in2[7];
    out[11] += 0.3872983429f * in1[8] * in2[7];

    // Path 21: (2,3)->1, 21 entries
    out[3] += 0.4629100412f * in1[4] * in2[9];
    out[2] += 0.3779644803f * in1[4] * in2[10];
    out[3] += -0.1195228589f * in1[4] * in2[11];
    out[1] += -0.1195228589f * in1[4] * in2[13];
    out[1] += -0.4629100412f * in1[4] * in2[15];
    out[3] += 0.3779644803f * in1[5] * in2[10];
    out[2] += 0.4780914358f * in1[5] * in2[11];
    out[1] += -0.2927700119f * in1[5] * in2[12];
    out[1] += -0.3779644803f * in1[5] * in2[14];
    out[1] += 0.4140393398f * in1[6] * in2[11];
    out[2] += 0.5070925636f * in1[6] * in2[12];
    out[3] += 0.4140393398f * in1[6] * in2[13];
    out[1] += 0.3779644803f * in1[7] * in2[10];
    out[3] += -0.2927700119f * in1[7] * in2[12];
    out[2] += 0.4780914358f * in1[7] * in2[13];
    out[3] += 0.3779644803f * in1[7] * in2[14];
    out[1] += 0.4629100412f * in1[8] * in2[9];
    out[1] += 0.1195228589f * in1[8] * in2[11];
    out[3] += -0.1195228589f * in1[8] * in2[13];
    out[2] += 0.3779644803f * in1[8] * in2[14];
    out[3] += 0.4629100412f * in1[8] * in2[15];

    // Path 22: (2,3)->2, 28 entries
    out[5] += -0.4225771204f * in1[4] * in2[9];
    out[5] += -0.3273268423f * in1[4] * in2[11];
    out[8] += -0.2672612446f * in1[4] * in2[12];
    out[7] += 0.3273268423f * in1[4] * in2[13];
    out[6] += -0.5976142935f * in1[4] * in2[14];
    out[7] += -0.4225771204f * in1[4] * in2[15];
    out[4] += 0.4225771204f * in1[5] * in2[9];
    out[4] += 0.3273268423f * in1[5] * in2[11];
    out[7] += 0.5345224892f * in1[5] * in2[12];
    out[6] += -0.3779644601f * in1[5] * in2[13];
    out[8] += 0.3273268423f * in1[5] * in2[13];
    out[8] += 0.4225771204f * in1[5] * in2[15];
    out[8] += -0.5976142935f * in1[6] * in2[10];
    out[7] += -0.3779644601f * in1[6] * in2[11];
    out[5] += 0.3779644601f * in1[6] * in2[13];
    out[4] += 0.5976142935f * in1[6] * in2[14];
    out[8] += -0.4225771204f * in1[7] * in2[9];
    out[6] += 0.3779644601f * in1[7] * in2[11];
    out[8] += 0.3273268423f * in1[7] * in2[11];
    out[5] += -0.5345224892f * in1[7] * in2[12];
    out[4] += -0.3273268423f * in1[7] * in2[13];
    out[4] += 0.4225771204f * in1[7] * in2[15];
    out[7] += 0.4225771204f * in1[8] * in2[9];
    out[6] += 0.5976142935f * in1[8] * in2[10];
    out[7] += -0.3273268423f * in1[8] * in2[11];
    out[4] += 0.2672612446f * in1[8] * in2[12];
    out[5] += -0.3273268423f * in1[8] * in2[13];
    out[5] += -0.4225771204f * in1[8] * in2[15];

    // Path 23: (2,3)->3, 41 entries
    out[13] += -0.2886751401f * in1[4] * in2[9];
    out[12] += -0.5773502803f * in1[4] * in2[10];
    out[13] += 0.4472135802f * in1[4] * in2[11];
    out[15] += 0.2886751401f * in1[4] * in2[11];
    out[10] += -0.5773502803f * in1[4] * in2[12];
    out[9] += -0.2886751401f * in1[4] * in2[13];
    out[11] += 0.4472135802f * in1[4] * in2[13];
    out[11] += 0.2886751401f * in1[4] * in2[15];
    out[14] += 0.4564354668f * in1[5] * in2[9];
    out[13] += 0.3535533840f * in1[5] * in2[10];
    out[15] += -0.4564354668f * in1[5] * in2[10];
    out[12] += 0.1825741828f * in1[5] * in2[11];
    out[14] += -0.3535533840f * in1[5] * in2[11];
    out[11] += 0.1825741828f * in1[5] * in2[12];
    out[10] += 0.3535533840f * in1[5] * in2[13];
    out[9] += 0.4564354668f * in1[5] * in2[14];
    out[11] += -0.3535533840f * in1[5] * in2[14];
    out[10] += -0.4564354668f * in1[5] * in2[15];
    out[9] += -0.6454972118f * in1[6] * in2[9];
    out[11] += 0.3872983429f * in1[6] * in2[11];
    out[12] += 0.5163977773f * in1[6] * in2[12];
    out[13] += 0.3872983429f * in1[6] * in2[13];
    out[15] += -0.6454972118f * in1[6] * in2[15];
    out[10] += 0.4564354668f * in1[7] * in2[9];
    out[9] += 0.4564354668f * in1[7] * in2[10];
    out[11] += 0.3535533840f * in1[7] * in2[10];
    out[10] += 0.3535533840f * in1[7] * in2[11];
    out[13] += 0.1825741828f * in1[7] * in2[12];
    out[12] += 0.1825741828f * in1[7] * in2[13];
    out[14] += 0.3535533840f * in1[7] * in2[13];
    out[13] += 0.3535533840f * in1[7] * in2[14];
    out[15] += 0.4564354668f * in1[7] * in2[14];
    out[14] += 0.4564354668f * in1[7] * in2[15];
    out[11] += -0.2886751401f * in1[8] * in2[9];
    out[9] += -0.2886751401f * in1[8] * in2[11];
    out[11] += -0.4472135802f * in1[8] * in2[11];
    out[14] += -0.5773502803f * in1[8] * in2[12];
    out[13] += 0.4472135802f * in1[8] * in2[13];
    out[15] += -0.2886751401f * in1[8] * in2[13];
    out[12] += -0.5773502803f * in1[8] * in2[14];
    out[13] += -0.2886751401f * in1[8] * in2[15];

    // Path 24: (3,0)->3, 7 entries
    out[9] += 0.9999999836f * in1[9] * in2[0];
    out[10] += 0.9999999836f * in1[10] * in2[0];
    out[11] += 0.9999999836f * in1[11] * in2[0];
    out[12] += 0.9999999836f * in1[12] * in2[0];
    out[13] += 0.9999999836f * in1[13] * in2[0];
    out[14] += 0.9999999836f * in1[14] * in2[0];
    out[15] += 0.9999999836f * in1[15] * in2[0];

    // Path 25: (3,1)->2, 21 entries
    out[8] += 0.5976142935f * in1[9] * in2[1];
    out[4] += 0.5976142935f * in1[9] * in2[3];
    out[7] += 0.4879500459f * in1[10] * in2[1];
    out[4] += 0.4879500459f * in1[10] * in2[2];
    out[5] += 0.4879500459f * in1[10] * in2[3];
    out[6] += 0.5345224892f * in1[11] * in2[1];
    out[8] += 0.1543033474f * in1[11] * in2[1];
    out[5] += 0.6172133895f * in1[11] * in2[2];
    out[4] += -0.1543033474f * in1[11] * in2[3];
    out[5] += -0.3779644601f * in1[12] * in2[1];
    out[6] += 0.6546536846f * in1[12] * in2[2];
    out[7] += -0.3779644601f * in1[12] * in2[3];
    out[4] += -0.1543033474f * in1[13] * in2[1];
    out[7] += 0.6172133895f * in1[13] * in2[2];
    out[6] += 0.5345224892f * in1[13] * in2[3];
    out[8] += -0.1543033474f * in1[13] * in2[3];
    out[5] += -0.4879500459f * in1[14] * in2[1];
    out[8] += 0.4879500459f * in1[14] * in2[2];
    out[7] += 0.4879500459f * in1[14] * in2[3];
    out[4] += -0.5976142935f * in1[15] * in2[1];
    out[8] += 0.5976142935f * in1[15] * in2[3];

    // Path 26: (3,1)->3, 26 entries
    out[10] += 0.3535533840f * in1[9] * in2[1];
    out[15] += 0.8660254007f * in1[9] * in2[2];
    out[14] += -0.3535533840f * in1[9] * in2[3];
    out[9] += -0.3535533840f * in1[10] * in2[1];
    out[11] += 0.4564354668f * in1[10] * in2[1];
    out[14] += 0.5773502803f * in1[10] * in2[2];
    out[13] += -0.4564354668f * in1[10] * in2[3];
    out[15] += -0.3535533840f * in1[10] * in2[3];
    out[10] += -0.4564354668f * in1[11] * in2[1];
    out[13] += 0.2886751401f * in1[11] * in2[2];
    out[12] += -0.7071067679f * in1[11] * in2[3];
    out[14] += -0.4564354668f * in1[11] * in2[3];
    out[13] += -0.7071067679f * in1[12] * in2[1];
    out[11] += 0.7071067679f * in1[12] * in2[3];
    out[12] += 0.7071067679f * in1[13] * in2[1];
    out[14] += -0.4564354668f * in1[13] * in2[1];
    out[11] += -0.2886751401f * in1[13] * in2[2];
    out[10] += 0.4564354668f * in1[13] * in2[3];
    out[13] += 0.4564354668f * in1[14] * in2[1];
    out[15] += -0.3535533840f * in1[14] * in2[1];
    out[10] += -0.5773502803f * in1[14] * in2[2];
    out[9] += 0.3535533840f * in1[14] * in2[3];
    out[11] += 0.4564354668f * in1[14] * in2[3];
    out[14] += 0.3535533840f * in1[15] * in2[1];
    out[9] += -0.8660254007f * in1[15] * in2[2];
    out[10] += 0.3535533840f * in1[15] * in2[3];

    // Path 27: (3,2)->1, 21 entries
    out[3] += 0.4629100412f * in1[9] * in2[4];
    out[1] += 0.4629100412f * in1[9] * in2[8];
    out[2] += 0.3779644803f * in1[10] * in2[4];
    out[3] += 0.3779644803f * in1[10] * in2[5];
    out[1] += 0.3779644803f * in1[10] * in2[7];
    out[3] += -0.1195228589f * in1[11] * in2[4];
    out[2] += 0.4780914358f * in1[11] * in2[5];
    out[1] += 0.4140393398f * in1[11] * in2[6];
    out[1] += 0.1195228589f * in1[11] * in2[8];
    out[1] += -0.2927700119f * in1[12] * in2[5];
    out[2] += 0.5070925636f * in1[12] * in2[6];
    out[3] += -0.2927700119f * in1[12] * in2[7];
    out[1] += -0.1195228589f * in1[13] * in2[4];
    out[3] += 0.4140393398f * in1[13] * in2[6];
    out[2] += 0.4780914358f * in1[13] * in2[7];
    out[3] += -0.1195228589f * in1[13] * in2[8];
    out[1] += -0.3779644803f * in1[14] * in2[5];
    out[3] += 0.3779644803f * in1[14] * in2[7];
    out[2] += 0.3779644803f * in1[14] * in2[8];
    out[1] += -0.4629100412f * in1[15] * in2[4];
    out[3] += 0.4629100412f * in1[15] * in2[8];

    // Path 28: (3,2)->2, 28 entries
    out[5] += 0.4225771204f * in1[9] * in2[4];
    out[4] += -0.4225771204f * in1[9] * in2[5];
    out[8] += 0.4225771204f * in1[9] * in2[7];
    out[7] += -0.4225771204f * in1[9] * in2[8];
    out[8] += 0.5976142935f * in1[10] * in2[6];
    out[6] += -0.5976142935f * in1[10] * in2[8];
    out[5] += 0.3273268423f * in1[11] * in2[4];
    out[4] += -0.3273268423f * in1[11] * in2[5];
    out[7] += 0.3779644601f * in1[11] * in2[6];
    out[6] += -0.3779644601f * in1[11] * in2[7];
    out[8] += -0.3273268423f * in1[11] * in2[7];
    out[7] += 0.3273268423f * in1[11] * in2[8];
    out[8] += 0.2672612446f * in1[12] * in2[4];
    out[7] += -0.5345224892f * in1[12] * in2[5];
    out[5] += 0.5345224892f * in1[12] * in2[7];
    out[4] += -0.2672612446f * in1[12] * in2[8];
    out[7] += -0.3273268423f * in1[13] * in2[4];
    out[6] += 0.3779644601f * in1[13] * in2[5];
    out[8] += -0.3273268423f * in1[13] * in2[5];
    out[5] += -0.3779644601f * in1[13] * in2[6];
    out[4] += 0.3273268423f * in1[13] * in2[7];
    out[5] += 0.3273268423f * in1[13] * in2[8];
    out[6] += 0.5976142935f * in1[14] * in2[4];
    out[4] += -0.5976142935f * in1[14] * in2[6];
    out[7] += 0.4225771204f * in1[15] * in2[4];
    out[8] += -0.4225771204f * in1[15] * in2[5];
    out[4] += -0.4225771204f * in1[15] * in2[7];
    out[5] += 0.4225771204f * in1[15] * in2[8];

    // Path 29: (3,2)->3, 41 entries
    out[13] += -0.2886751401f * in1[9] * in2[4];
    out[14] += 0.4564354668f * in1[9] * in2[5];
    out[9] += -0.6454972118f * in1[9] * in2[6];
    out[10] += 0.4564354668f * in1[9] * in2[7];
    out[11] += -0.2886751401f * in1[9] * in2[8];
    out[12] += -0.5773502803f * in1[10] * in2[4];
    out[13] += 0.3535533840f * in1[10] * in2[5];
    out[15] += -0.4564354668f * in1[10] * in2[5];
    out[9] += 0.4564354668f * in1[10] * in2[7];
    out[11] += 0.3535533840f * in1[10] * in2[7];
    out[13] += 0.4472135802f * in1[11] * in2[4];
    out[15] += 0.2886751401f * in1[11] * in2[4];
    out[12] += 0.1825741828f * in1[11] * in2[5];
    out[14] += -0.3535533840f * in1[11] * in2[5];
    out[11] += 0.3872983429f * in1[11] * in2[6];
    out[10] += 0.3535533840f * in1[11] * in2[7];
    out[9] += -0.2886751401f * in1[11] * in2[8];
    out[11] += -0.4472135802f * in1[11] * in2[8];
    out[10] += -0.5773502803f * in1[12] * in2[4];
    out[11] += 0.1825741828f * in1[12] * in2[5];
    out[12] += 0.5163977773f * in1[12] * in2[6];
    out[13] += 0.1825741828f * in1[12] * in2[7];
    out[14] += -0.5773502803f * in1[12] * in2[8];
    out[9] += -0.2886751401f * in1[13] * in2[4];
    out[11] += 0.4472135802f * in1[13] * in2[4];
    out[10] += 0.3535533840f * in1[13] * in2[5];
    out[13] += 0.3872983429f * in1[13] * in2[6];
    out[12] += 0.1825741828f * in1[13] * in2[7];
    out[14] += 0.3535533840f * in1[13] * in2[7];
    out[13] += 0.4472135802f * in1[13] * in2[8];
    out[15] += -0.2886751401f * in1[13] * in2[8];
    out[9] += 0.4564354668f * in1[14] * in2[5];
    out[11] += -0.3535533840f * in1[14] * in2[5];
    out[13] += 0.3535533840f * in1[14] * in2[7];
    out[15] += 0.4564354668f * in1[14] * in2[7];
    out[12] += -0.5773502803f * in1[14] * in2[8];
    out[11] += 0.2886751401f * in1[15] * in2[4];
    out[10] += -0.4564354668f * in1[15] * in2[5];
    out[15] += -0.6454972118f * in1[15] * in2[6];
    out[14] += 0.4564354668f * in1[15] * in2[7];
    out[13] += -0.2886751401f * in1[15] * in2[8];

    // Path 30: (3,3)->0, 7 entries
    out[0] += 0.3779644668f * in1[9] * in2[9];
    out[0] += 0.3779644668f * in1[10] * in2[10];
    out[0] += 0.3779644668f * in1[11] * in2[11];
    out[0] += 0.3779644668f * in1[12] * in2[12];
    out[0] += 0.3779644668f * in1[13] * in2[13];
    out[0] += 0.3779644668f * in1[14] * in2[14];
    out[0] += 0.3779644668f * in1[15] * in2[15];

    // Path 31: (3,3)->1, 26 entries
    out[1] += -0.2314550206f * in1[9] * in2[10];
    out[3] += 0.2314550206f * in1[9] * in2[14];
    out[2] += -0.5669467075f * in1[9] * in2[15];
    out[1] += 0.2314550206f * in1[10] * in2[9];
    out[1] += -0.2988071538f * in1[10] * in2[11];
    out[3] += 0.2988071538f * in1[10] * in2[13];
    out[2] += -0.3779644803f * in1[10] * in2[14];
    out[3] += 0.2314550206f * in1[10] * in2[15];
    out[1] += 0.2988071538f * in1[11] * in2[10];
    out[3] += 0.4629100412f * in1[11] * in2[12];
    out[2] += -0.1889822401f * in1[11] * in2[13];
    out[3] += 0.2988071538f * in1[11] * in2[14];
    out[3] += -0.4629100412f * in1[12] * in2[11];
    out[1] += 0.4629100412f * in1[12] * in2[13];
    out[3] += -0.2988071538f * in1[13] * in2[10];
    out[2] += 0.1889822401f * in1[13] * in2[11];
    out[1] += -0.4629100412f * in1[13] * in2[12];
    out[1] += 0.2988071538f * in1[13] * in2[14];
    out[3] += -0.2314550206f * in1[14] * in2[9];
    out[2] += 0.3779644803f * in1[14] * in2[10];
    out[3] += -0.2988071538f * in1[14] * in2[11];
    out[1] += -0.2988071538f * in1[14] * in2[13];
    out[1] += 0.2314550206f * in1[14] * in2[15];
    out[2] += 0.5669467075f * in1[15] * in2[9];
    out[3] += -0.2314550206f * in1[15] * in2[10];
    out[1] += -0.2314550206f * in1[15] * in2[14];

    // Path 32: (3,3)->2, 41 entries
    out[6] += -0.5455447150f * in1[9] * in2[9];
    out[7] += 0.3857583768f * in1[9] * in2[10];
    out[8] += -0.2439750229f * in1[9] * in2[11];
    out[4] += -0.2439750229f * in1[9] * in2[13];
    out[5] += 0.3857583768f * in1[9] * in2[14];
    out[7] += 0.3857583768f * in1[10] * in2[9];
    out[7] += 0.2988071467f * in1[10] * in2[11];
    out[4] += -0.4879500459f * in1[10] * in2[12];
    out[5] += 0.2988071467f * in1[10] * in2[13];
    out[5] += -0.3857583768f * in1[10] * in2[15];
    out[8] += -0.2439750229f * in1[11] * in2[9];
    out[7] += 0.2988071467f * in1[11] * in2[10];
    out[6] += 0.3273268423f * in1[11] * in2[11];
    out[8] += -0.3779644601f * in1[11] * in2[11];
    out[5] += 0.1543033474f * in1[11] * in2[12];
    out[4] += 0.3779644601f * in1[11] * in2[13];
    out[5] += -0.2988071467f * in1[11] * in2[14];
    out[4] += 0.2439750229f * in1[11] * in2[15];
    out[4] += -0.4879500459f * in1[12] * in2[10];
    out[5] += 0.1543033474f * in1[12] * in2[11];
    out[6] += 0.4364357787f * in1[12] * in2[12];
    out[7] += 0.1543033474f * in1[12] * in2[13];
    out[8] += -0.4879500459f * in1[12] * in2[14];
    out[4] += -0.2439750229f * in1[13] * in2[9];
    out[5] += 0.2988071467f * in1[13] * in2[10];
    out[4] += 0.3779644601f * in1[13] * in2[11];
    out[7] += 0.1543033474f * in1[13] * in2[12];
    out[6] += 0.3273268423f * in1[13] * in2[13];
    out[8] += 0.3779644601f * in1[13] * in2[13];
    out[7] += 0.2988071467f * in1[13] * in2[14];
    out[8] += -0.2439750229f * in1[13] * in2[15];
    out[5] += 0.3857583768f * in1[14] * in2[9];
    out[5] += -0.2988071467f * in1[14] * in2[11];
    out[8] += -0.4879500459f * in1[14] * in2[12];
    out[7] += 0.2988071467f * in1[14] * in2[13];
    out[7] += 0.3857583768f * in1[14] * in2[15];
    out[5] += -0.3857583768f * in1[15] * in2[10];
    out[4] += 0.2439750229f * in1[15] * in2[11];
    out[8] += -0.2439750229f * in1[15] * in2[13];
    out[7] += 0.3857583768f * in1[15] * in2[14];
    out[6] += -0.5455447150f * in1[15] * in2[15];

    // Path 33: (3,3)->3, 42 entries
    out[11] += 0.4082483091f * in1[9] * in2[10];
    out[10] += -0.4082483091f * in1[9] * in2[11];
    out[15] += -0.4082483091f * in1[9] * in2[12];
    out[14] += 0.4082483091f * in1[9] * in2[13];
    out[13] += -0.4082483091f * in1[9] * in2[14];
    out[12] += 0.4082483091f * in1[9] * in2[15];
    out[11] += -0.4082483091f * in1[10] * in2[9];
    out[9] += 0.4082483091f * in1[10] * in2[11];
    out[14] += 0.4082483091f * in1[10] * in2[12];
    out[15] += 0.4082483091f * in1[10] * in2[13];
    out[12] += -0.4082483091f * in1[10] * in2[14];
    out[13] += -0.4082483091f * in1[10] * in2[15];
    out[10] += 0.4082483091f * in1[11] * in2[9];
    out[9] += -0.4082483091f * in1[11] * in2[10];
    out[13] += 0.4082483091f * in1[11] * in2[12];
    out[12] += -0.4082483091f * in1[11] * in2[13];
    out[15] += -0.4082483091f * in1[11] * in2[14];
    out[14] += 0.4082483091f * in1[11] * in2[15];
    out[15] += 0.4082483091f * in1[12] * in2[9];
    out[14] += -0.4082483091f * in1[12] * in2[10];
    out[13] += -0.4082483091f * in1[12] * in2[11];
    out[11] += 0.4082483091f * in1[12] * in2[13];
    out[10] += 0.4082483091f * in1[12] * in2[14];
    out[9] += -0.4082483091f * in1[12] * in2[15];
    out[14] += -0.4082483091f * in1[13] * in2[9];
    out[15] += -0.4082483091f * in1[13] * in2[10];
    out[12] += 0.4082483091f * in1[13] * in2[11];
    out[11] += -0.4082483091f * in1[13] * in2[12];
    out[9] += 0.4082483091f * in1[13] * in2[14];
    out[10] += 0.4082483091f * in1[13] * in2[15];
    out[13] += 0.4082483091f * in1[14] * in2[9];
    out[12] += 0.4082483091f * in1[14] * in2[10];
    out[15] += 0.4082483091f * in1[14] * in2[11];
    out[10] += -0.4082483091f * in1[14] * in2[12];
    out[9] += -0.4082483091f * in1[14] * in2[13];
    out[11] += -0.4082483091f * in1[14] * in2[15];
    out[12] += -0.4082483091f * in1[15] * in2[9];
    out[13] += 0.4082483091f * in1[15] * in2[10];
    out[14] += -0.4082483091f * in1[15] * in2[11];
    out[9] += 0.4082483091f * in1[15] * in2[12];
    out[10] += -0.4082483091f * in1[15] * in2[13];
    out[11] += 0.4082483091f * in1[15] * in2[14];

}

// Full tensor product: processes one (sample, c_out) pair
// out[c_out, 16] = sum over c_in, paths of w[path,c_in,c_out] * CG * in1[c_in,m1] * in2[m2]
template<int C_IN, int C_OUT>
__device__ __forceinline__ void tensor_product_full_unrolled(
    const float* __restrict__ in1,      // [C_IN, 16] for this sample
    const float* __restrict__ in2,      // [16] for this sample
    const float* __restrict__ weights,  // [NUM_PATHS, C_IN, C_OUT]
    float* __restrict__ out,            // [16] output for this (sample, c_out)
    int c_out
) {
    float acc[16] = {0};

    #pragma unroll
    for (int c_in = 0; c_in < C_IN; c_in++) {
        const float* inp1 = in1 + c_in * 16;

        // Path 0: (0,0)->0
        {
            const float w = weights[0 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[0] += w * 1.0000000000f * inp1[0] * in2[0];
        }

        // Path 1: (0,1)->1
        {
            const float w = weights[1 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[1] += w * 0.9999999821f * inp1[0] * in2[1];
            acc[2] += w * 0.9999999821f * inp1[0] * in2[2];
            acc[3] += w * 0.9999999821f * inp1[0] * in2[3];
        }

        // Path 2: (0,2)->2
        {
            const float w = weights[2 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[4] += w * 0.9999999880f * inp1[0] * in2[4];
            acc[5] += w * 0.9999999880f * inp1[0] * in2[5];
            acc[6] += w * 0.9999999880f * inp1[0] * in2[6];
            acc[7] += w * 0.9999999880f * inp1[0] * in2[7];
            acc[8] += w * 0.9999999880f * inp1[0] * in2[8];
        }

        // Path 3: (0,3)->3
        {
            const float w = weights[3 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[9] += w * 0.9999999836f * inp1[0] * in2[9];
            acc[10] += w * 0.9999999836f * inp1[0] * in2[10];
            acc[11] += w * 0.9999999836f * inp1[0] * in2[11];
            acc[12] += w * 0.9999999836f * inp1[0] * in2[12];
            acc[13] += w * 0.9999999836f * inp1[0] * in2[13];
            acc[14] += w * 0.9999999836f * inp1[0] * in2[14];
            acc[15] += w * 0.9999999836f * inp1[0] * in2[15];
        }

        // Path 4: (1,0)->1
        {
            const float w = weights[4 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[1] += w * 0.9999999821f * inp1[1] * in2[0];
            acc[2] += w * 0.9999999821f * inp1[2] * in2[0];
            acc[3] += w * 0.9999999821f * inp1[3] * in2[0];
        }

        // Path 5: (1,1)->0
        {
            const float w = weights[5 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[0] += w * 0.5773502588f * inp1[1] * in2[1];
            acc[0] += w * 0.5773502588f * inp1[2] * in2[2];
            acc[0] += w * 0.5773502588f * inp1[3] * in2[3];
        }

        // Path 6: (1,1)->1
        {
            const float w = weights[6 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[3] += w * 0.7071068069f * inp1[1] * in2[2];
            acc[2] += w * -0.7071068069f * inp1[1] * in2[3];
            acc[3] += w * -0.7071068069f * inp1[2] * in2[1];
            acc[1] += w * 0.7071068069f * inp1[2] * in2[3];
            acc[2] += w * 0.7071068069f * inp1[3] * in2[1];
            acc[1] += w * -0.7071068069f * inp1[3] * in2[2];
        }

        // Path 7: (1,1)->2
        {
            const float w = weights[7 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[6] += w * -0.4082482836f * inp1[1] * in2[1];
            acc[8] += w * -0.7071067764f * inp1[1] * in2[1];
            acc[5] += w * 0.7071067764f * inp1[1] * in2[2];
            acc[4] += w * 0.7071067764f * inp1[1] * in2[3];
            acc[5] += w * 0.7071067764f * inp1[2] * in2[1];
            acc[6] += w * 0.8164965671f * inp1[2] * in2[2];
            acc[7] += w * 0.7071067764f * inp1[2] * in2[3];
            acc[4] += w * 0.7071067764f * inp1[3] * in2[1];
            acc[7] += w * 0.7071067764f * inp1[3] * in2[2];
            acc[6] += w * -0.4082482836f * inp1[3] * in2[3];
            acc[8] += w * 0.7071067764f * inp1[3] * in2[3];
        }

        // Path 8: (1,2)->1
        {
            const float w = weights[8 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[3] += w * 0.5477225538f * inp1[1] * in2[4];
            acc[2] += w * 0.5477225538f * inp1[1] * in2[5];
            acc[1] += w * -0.3162277607f * inp1[1] * in2[6];
            acc[1] += w * -0.5477225538f * inp1[1] * in2[8];
            acc[1] += w * 0.5477225538f * inp1[2] * in2[5];
            acc[2] += w * 0.6324555213f * inp1[2] * in2[6];
            acc[3] += w * 0.5477225538f * inp1[2] * in2[7];
            acc[1] += w * 0.5477225538f * inp1[3] * in2[4];
            acc[3] += w * -0.3162277607f * inp1[3] * in2[6];
            acc[2] += w * 0.5477225538f * inp1[3] * in2[7];
            acc[3] += w * 0.5477225538f * inp1[3] * in2[8];
        }

        // Path 9: (1,2)->2
        {
            const float w = weights[9 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[5] += w * -0.4082482836f * inp1[1] * in2[4];
            acc[4] += w * 0.4082482836f * inp1[1] * in2[5];
            acc[7] += w * 0.7071067764f * inp1[1] * in2[6];
            acc[6] += w * -0.7071067764f * inp1[1] * in2[7];
            acc[8] += w * 0.4082482836f * inp1[1] * in2[7];
            acc[7] += w * -0.4082482836f * inp1[1] * in2[8];
            acc[8] += w * -0.8164965671f * inp1[2] * in2[4];
            acc[7] += w * -0.4082482836f * inp1[2] * in2[5];
            acc[5] += w * 0.4082482836f * inp1[2] * in2[7];
            acc[4] += w * 0.8164965671f * inp1[2] * in2[8];
            acc[7] += w * 0.4082482836f * inp1[3] * in2[4];
            acc[6] += w * 0.7071067764f * inp1[3] * in2[5];
            acc[8] += w * 0.4082482836f * inp1[3] * in2[5];
            acc[5] += w * -0.7071067764f * inp1[3] * in2[6];
            acc[4] += w * -0.4082482836f * inp1[3] * in2[7];
            acc[5] += w * -0.4082482836f * inp1[3] * in2[8];
        }

        // Path 10: (1,2)->3
        {
            const float w = weights[10 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[13] += w * -0.1825741828f * inp1[1] * in2[4];
            acc[15] += w * -0.7071067679f * inp1[1] * in2[4];
            acc[12] += w * -0.4472135802f * inp1[1] * in2[5];
            acc[14] += w * -0.5773502803f * inp1[1] * in2[5];
            acc[11] += w * 0.6324555384f * inp1[1] * in2[6];
            acc[10] += w * 0.5773502803f * inp1[1] * in2[7];
            acc[9] += w * 0.7071067679f * inp1[1] * in2[8];
            acc[11] += w * 0.1825741828f * inp1[1] * in2[8];
            acc[10] += w * 0.5773502803f * inp1[2] * in2[4];
            acc[11] += w * 0.7302967312f * inp1[2] * in2[5];
            acc[12] += w * 0.7745966857f * inp1[2] * in2[6];
            acc[13] += w * 0.7302967312f * inp1[2] * in2[7];
            acc[14] += w * 0.5773502803f * inp1[2] * in2[8];
            acc[9] += w * 0.7071067679f * inp1[3] * in2[4];
            acc[11] += w * -0.1825741828f * inp1[3] * in2[4];
            acc[10] += w * 0.5773502803f * inp1[3] * in2[5];
            acc[13] += w * 0.6324555384f * inp1[3] * in2[6];
            acc[12] += w * -0.4472135802f * inp1[3] * in2[7];
            acc[14] += w * 0.5773502803f * inp1[3] * in2[7];
            acc[13] += w * -0.1825741828f * inp1[3] * in2[8];
            acc[15] += w * 0.7071067679f * inp1[3] * in2[8];
        }

        // Path 11: (1,3)->2
        {
            const float w = weights[11 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[8] += w * 0.5976142935f * inp1[1] * in2[9];
            acc[7] += w * 0.4879500459f * inp1[1] * in2[10];
            acc[6] += w * 0.5345224892f * inp1[1] * in2[11];
            acc[8] += w * 0.1543033474f * inp1[1] * in2[11];
            acc[5] += w * -0.3779644601f * inp1[1] * in2[12];
            acc[4] += w * -0.1543033474f * inp1[1] * in2[13];
            acc[5] += w * -0.4879500459f * inp1[1] * in2[14];
            acc[4] += w * -0.5976142935f * inp1[1] * in2[15];
            acc[4] += w * 0.4879500459f * inp1[2] * in2[10];
            acc[5] += w * 0.6172133895f * inp1[2] * in2[11];
            acc[6] += w * 0.6546536846f * inp1[2] * in2[12];
            acc[7] += w * 0.6172133895f * inp1[2] * in2[13];
            acc[8] += w * 0.4879500459f * inp1[2] * in2[14];
            acc[4] += w * 0.5976142935f * inp1[3] * in2[9];
            acc[5] += w * 0.4879500459f * inp1[3] * in2[10];
            acc[4] += w * -0.1543033474f * inp1[3] * in2[11];
            acc[7] += w * -0.3779644601f * inp1[3] * in2[12];
            acc[6] += w * 0.5345224892f * inp1[3] * in2[13];
            acc[8] += w * -0.1543033474f * inp1[3] * in2[13];
            acc[7] += w * 0.4879500459f * inp1[3] * in2[14];
            acc[8] += w * 0.5976142935f * inp1[3] * in2[15];
        }

        // Path 12: (1,3)->3
        {
            const float w = weights[12 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[10] += w * -0.3535533840f * inp1[1] * in2[9];
            acc[9] += w * 0.3535533840f * inp1[1] * in2[10];
            acc[11] += w * -0.4564354668f * inp1[1] * in2[10];
            acc[10] += w * 0.4564354668f * inp1[1] * in2[11];
            acc[13] += w * 0.7071067679f * inp1[1] * in2[12];
            acc[12] += w * -0.7071067679f * inp1[1] * in2[13];
            acc[14] += w * 0.4564354668f * inp1[1] * in2[13];
            acc[13] += w * -0.4564354668f * inp1[1] * in2[14];
            acc[15] += w * 0.3535533840f * inp1[1] * in2[14];
            acc[14] += w * -0.3535533840f * inp1[1] * in2[15];
            acc[15] += w * -0.8660254007f * inp1[2] * in2[9];
            acc[14] += w * -0.5773502803f * inp1[2] * in2[10];
            acc[13] += w * -0.2886751401f * inp1[2] * in2[11];
            acc[11] += w * 0.2886751401f * inp1[2] * in2[13];
            acc[10] += w * 0.5773502803f * inp1[2] * in2[14];
            acc[9] += w * 0.8660254007f * inp1[2] * in2[15];
            acc[14] += w * 0.3535533840f * inp1[3] * in2[9];
            acc[13] += w * 0.4564354668f * inp1[3] * in2[10];
            acc[15] += w * 0.3535533840f * inp1[3] * in2[10];
            acc[12] += w * 0.7071067679f * inp1[3] * in2[11];
            acc[14] += w * 0.4564354668f * inp1[3] * in2[11];
            acc[11] += w * -0.7071067679f * inp1[3] * in2[12];
            acc[10] += w * -0.4564354668f * inp1[3] * in2[13];
            acc[9] += w * -0.3535533840f * inp1[3] * in2[14];
            acc[11] += w * -0.4564354668f * inp1[3] * in2[14];
            acc[10] += w * -0.3535533840f * inp1[3] * in2[15];
        }

        // Path 13: (2,0)->2
        {
            const float w = weights[13 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[4] += w * 0.9999999880f * inp1[4] * in2[0];
            acc[5] += w * 0.9999999880f * inp1[5] * in2[0];
            acc[6] += w * 0.9999999880f * inp1[6] * in2[0];
            acc[7] += w * 0.9999999880f * inp1[7] * in2[0];
            acc[8] += w * 0.9999999880f * inp1[8] * in2[0];
        }

        // Path 14: (2,1)->1
        {
            const float w = weights[14 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[3] += w * 0.5477225538f * inp1[4] * in2[1];
            acc[1] += w * 0.5477225538f * inp1[4] * in2[3];
            acc[2] += w * 0.5477225538f * inp1[5] * in2[1];
            acc[1] += w * 0.5477225538f * inp1[5] * in2[2];
            acc[1] += w * -0.3162277607f * inp1[6] * in2[1];
            acc[2] += w * 0.6324555213f * inp1[6] * in2[2];
            acc[3] += w * -0.3162277607f * inp1[6] * in2[3];
            acc[3] += w * 0.5477225538f * inp1[7] * in2[2];
            acc[2] += w * 0.5477225538f * inp1[7] * in2[3];
            acc[1] += w * -0.5477225538f * inp1[8] * in2[1];
            acc[3] += w * 0.5477225538f * inp1[8] * in2[3];
        }

        // Path 15: (2,1)->2
        {
            const float w = weights[15 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[5] += w * 0.4082482836f * inp1[4] * in2[1];
            acc[8] += w * 0.8164965671f * inp1[4] * in2[2];
            acc[7] += w * -0.4082482836f * inp1[4] * in2[3];
            acc[4] += w * -0.4082482836f * inp1[5] * in2[1];
            acc[7] += w * 0.4082482836f * inp1[5] * in2[2];
            acc[6] += w * -0.7071067764f * inp1[5] * in2[3];
            acc[8] += w * -0.4082482836f * inp1[5] * in2[3];
            acc[7] += w * -0.7071067764f * inp1[6] * in2[1];
            acc[5] += w * 0.7071067764f * inp1[6] * in2[3];
            acc[6] += w * 0.7071067764f * inp1[7] * in2[1];
            acc[8] += w * -0.4082482836f * inp1[7] * in2[1];
            acc[5] += w * -0.4082482836f * inp1[7] * in2[2];
            acc[4] += w * 0.4082482836f * inp1[7] * in2[3];
            acc[7] += w * 0.4082482836f * inp1[8] * in2[1];
            acc[4] += w * -0.8164965671f * inp1[8] * in2[2];
            acc[5] += w * 0.4082482836f * inp1[8] * in2[3];
        }

        // Path 16: (2,1)->3
        {
            const float w = weights[16 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[13] += w * -0.1825741828f * inp1[4] * in2[1];
            acc[15] += w * -0.7071067679f * inp1[4] * in2[1];
            acc[10] += w * 0.5773502803f * inp1[4] * in2[2];
            acc[9] += w * 0.7071067679f * inp1[4] * in2[3];
            acc[11] += w * -0.1825741828f * inp1[4] * in2[3];
            acc[12] += w * -0.4472135802f * inp1[5] * in2[1];
            acc[14] += w * -0.5773502803f * inp1[5] * in2[1];
            acc[11] += w * 0.7302967312f * inp1[5] * in2[2];
            acc[10] += w * 0.5773502803f * inp1[5] * in2[3];
            acc[11] += w * 0.6324555384f * inp1[6] * in2[1];
            acc[12] += w * 0.7745966857f * inp1[6] * in2[2];
            acc[13] += w * 0.6324555384f * inp1[6] * in2[3];
            acc[10] += w * 0.5773502803f * inp1[7] * in2[1];
            acc[13] += w * 0.7302967312f * inp1[7] * in2[2];
            acc[12] += w * -0.4472135802f * inp1[7] * in2[3];
            acc[14] += w * 0.5773502803f * inp1[7] * in2[3];
            acc[9] += w * 0.7071067679f * inp1[8] * in2[1];
            acc[11] += w * 0.1825741828f * inp1[8] * in2[1];
            acc[14] += w * 0.5773502803f * inp1[8] * in2[2];
            acc[13] += w * -0.1825741828f * inp1[8] * in2[3];
            acc[15] += w * 0.7071067679f * inp1[8] * in2[3];
        }

        // Path 17: (2,2)->0
        {
            const float w = weights[17 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[0] += w * 0.4472135901f * inp1[4] * in2[4];
            acc[0] += w * 0.4472135901f * inp1[5] * in2[5];
            acc[0] += w * 0.4472135901f * inp1[6] * in2[6];
            acc[0] += w * 0.4472135901f * inp1[7] * in2[7];
            acc[0] += w * 0.4472135901f * inp1[8] * in2[8];
        }

        // Path 18: (2,2)->1
        {
            const float w = weights[18 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[1] += w * -0.3162277607f * inp1[4] * in2[5];
            acc[3] += w * 0.3162277607f * inp1[4] * in2[7];
            acc[2] += w * -0.6324555213f * inp1[4] * in2[8];
            acc[1] += w * 0.3162277607f * inp1[5] * in2[4];
            acc[3] += w * 0.5477225538f * inp1[5] * in2[6];
            acc[2] += w * -0.3162277607f * inp1[5] * in2[7];
            acc[3] += w * 0.3162277607f * inp1[5] * in2[8];
            acc[3] += w * -0.5477225538f * inp1[6] * in2[5];
            acc[1] += w * 0.5477225538f * inp1[6] * in2[7];
            acc[3] += w * -0.3162277607f * inp1[7] * in2[4];
            acc[2] += w * 0.3162277607f * inp1[7] * in2[5];
            acc[1] += w * -0.5477225538f * inp1[7] * in2[6];
            acc[1] += w * 0.3162277607f * inp1[7] * in2[8];
            acc[2] += w * 0.6324555213f * inp1[8] * in2[4];
            acc[3] += w * -0.3162277607f * inp1[8] * in2[5];
            acc[1] += w * -0.3162277607f * inp1[8] * in2[7];
        }

        // Path 19: (2,2)->2
        {
            const float w = weights[19 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[6] += w * -0.5345224892f * inp1[4] * in2[4];
            acc[7] += w * 0.4629100588f * inp1[4] * in2[5];
            acc[4] += w * -0.5345224892f * inp1[4] * in2[6];
            acc[5] += w * 0.4629100588f * inp1[4] * in2[7];
            acc[7] += w * 0.4629100588f * inp1[5] * in2[4];
            acc[6] += w * 0.2672612446f * inp1[5] * in2[5];
            acc[8] += w * -0.4629100588f * inp1[5] * in2[5];
            acc[5] += w * 0.2672612446f * inp1[5] * in2[6];
            acc[4] += w * 0.4629100588f * inp1[5] * in2[7];
            acc[5] += w * -0.4629100588f * inp1[5] * in2[8];
            acc[4] += w * -0.5345224892f * inp1[6] * in2[4];
            acc[5] += w * 0.2672612446f * inp1[6] * in2[5];
            acc[6] += w * 0.5345224892f * inp1[6] * in2[6];
            acc[7] += w * 0.2672612446f * inp1[6] * in2[7];
            acc[8] += w * -0.5345224892f * inp1[6] * in2[8];
            acc[5] += w * 0.4629100588f * inp1[7] * in2[4];
            acc[4] += w * 0.4629100588f * inp1[7] * in2[5];
            acc[7] += w * 0.2672612446f * inp1[7] * in2[6];
            acc[6] += w * 0.2672612446f * inp1[7] * in2[7];
            acc[8] += w * 0.4629100588f * inp1[7] * in2[7];
            acc[7] += w * 0.4629100588f * inp1[7] * in2[8];
            acc[5] += w * -0.4629100588f * inp1[8] * in2[5];
            acc[8] += w * -0.5345224892f * inp1[8] * in2[6];
            acc[7] += w * 0.4629100588f * inp1[8] * in2[7];
            acc[6] += w * -0.5345224892f * inp1[8] * in2[8];
        }

        // Path 20: (2,2)->3
        {
            const float w = weights[20 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[9] += w * 0.4999999918f * inp1[4] * in2[5];
            acc[11] += w * 0.3872983429f * inp1[4] * in2[5];
            acc[14] += w * 0.7071067679f * inp1[4] * in2[6];
            acc[13] += w * -0.3872983429f * inp1[4] * in2[7];
            acc[15] += w * 0.4999999918f * inp1[4] * in2[7];
            acc[12] += w * 0.3162277692f * inp1[4] * in2[8];
            acc[9] += w * -0.4999999918f * inp1[5] * in2[4];
            acc[11] += w * -0.3872983429f * inp1[5] * in2[4];
            acc[13] += w * 0.4472135802f * inp1[5] * in2[6];
            acc[12] += w * -0.6324555384f * inp1[5] * in2[7];
            acc[13] += w * -0.3872983429f * inp1[5] * in2[8];
            acc[15] += w * -0.4999999918f * inp1[5] * in2[8];
            acc[14] += w * -0.7071067679f * inp1[6] * in2[4];
            acc[13] += w * -0.4472135802f * inp1[6] * in2[5];
            acc[11] += w * 0.4472135802f * inp1[6] * in2[7];
            acc[10] += w * 0.7071067679f * inp1[6] * in2[8];
            acc[13] += w * 0.3872983429f * inp1[7] * in2[4];
            acc[15] += w * -0.4999999918f * inp1[7] * in2[4];
            acc[12] += w * 0.6324555384f * inp1[7] * in2[5];
            acc[11] += w * -0.4472135802f * inp1[7] * in2[6];
            acc[9] += w * 0.4999999918f * inp1[7] * in2[8];
            acc[11] += w * -0.3872983429f * inp1[7] * in2[8];
            acc[12] += w * -0.3162277692f * inp1[8] * in2[4];
            acc[13] += w * 0.3872983429f * inp1[8] * in2[5];
            acc[15] += w * 0.4999999918f * inp1[8] * in2[5];
            acc[10] += w * -0.7071067679f * inp1[8] * in2[6];
            acc[9] += w * -0.4999999918f * inp1[8] * in2[7];
            acc[11] += w * 0.3872983429f * inp1[8] * in2[7];
        }

        // Path 21: (2,3)->1
        {
            const float w = weights[21 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[3] += w * 0.4629100412f * inp1[4] * in2[9];
            acc[2] += w * 0.3779644803f * inp1[4] * in2[10];
            acc[3] += w * -0.1195228589f * inp1[4] * in2[11];
            acc[1] += w * -0.1195228589f * inp1[4] * in2[13];
            acc[1] += w * -0.4629100412f * inp1[4] * in2[15];
            acc[3] += w * 0.3779644803f * inp1[5] * in2[10];
            acc[2] += w * 0.4780914358f * inp1[5] * in2[11];
            acc[1] += w * -0.2927700119f * inp1[5] * in2[12];
            acc[1] += w * -0.3779644803f * inp1[5] * in2[14];
            acc[1] += w * 0.4140393398f * inp1[6] * in2[11];
            acc[2] += w * 0.5070925636f * inp1[6] * in2[12];
            acc[3] += w * 0.4140393398f * inp1[6] * in2[13];
            acc[1] += w * 0.3779644803f * inp1[7] * in2[10];
            acc[3] += w * -0.2927700119f * inp1[7] * in2[12];
            acc[2] += w * 0.4780914358f * inp1[7] * in2[13];
            acc[3] += w * 0.3779644803f * inp1[7] * in2[14];
            acc[1] += w * 0.4629100412f * inp1[8] * in2[9];
            acc[1] += w * 0.1195228589f * inp1[8] * in2[11];
            acc[3] += w * -0.1195228589f * inp1[8] * in2[13];
            acc[2] += w * 0.3779644803f * inp1[8] * in2[14];
            acc[3] += w * 0.4629100412f * inp1[8] * in2[15];
        }

        // Path 22: (2,3)->2
        {
            const float w = weights[22 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[5] += w * -0.4225771204f * inp1[4] * in2[9];
            acc[5] += w * -0.3273268423f * inp1[4] * in2[11];
            acc[8] += w * -0.2672612446f * inp1[4] * in2[12];
            acc[7] += w * 0.3273268423f * inp1[4] * in2[13];
            acc[6] += w * -0.5976142935f * inp1[4] * in2[14];
            acc[7] += w * -0.4225771204f * inp1[4] * in2[15];
            acc[4] += w * 0.4225771204f * inp1[5] * in2[9];
            acc[4] += w * 0.3273268423f * inp1[5] * in2[11];
            acc[7] += w * 0.5345224892f * inp1[5] * in2[12];
            acc[6] += w * -0.3779644601f * inp1[5] * in2[13];
            acc[8] += w * 0.3273268423f * inp1[5] * in2[13];
            acc[8] += w * 0.4225771204f * inp1[5] * in2[15];
            acc[8] += w * -0.5976142935f * inp1[6] * in2[10];
            acc[7] += w * -0.3779644601f * inp1[6] * in2[11];
            acc[5] += w * 0.3779644601f * inp1[6] * in2[13];
            acc[4] += w * 0.5976142935f * inp1[6] * in2[14];
            acc[8] += w * -0.4225771204f * inp1[7] * in2[9];
            acc[6] += w * 0.3779644601f * inp1[7] * in2[11];
            acc[8] += w * 0.3273268423f * inp1[7] * in2[11];
            acc[5] += w * -0.5345224892f * inp1[7] * in2[12];
            acc[4] += w * -0.3273268423f * inp1[7] * in2[13];
            acc[4] += w * 0.4225771204f * inp1[7] * in2[15];
            acc[7] += w * 0.4225771204f * inp1[8] * in2[9];
            acc[6] += w * 0.5976142935f * inp1[8] * in2[10];
            acc[7] += w * -0.3273268423f * inp1[8] * in2[11];
            acc[4] += w * 0.2672612446f * inp1[8] * in2[12];
            acc[5] += w * -0.3273268423f * inp1[8] * in2[13];
            acc[5] += w * -0.4225771204f * inp1[8] * in2[15];
        }

        // Path 23: (2,3)->3
        {
            const float w = weights[23 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[13] += w * -0.2886751401f * inp1[4] * in2[9];
            acc[12] += w * -0.5773502803f * inp1[4] * in2[10];
            acc[13] += w * 0.4472135802f * inp1[4] * in2[11];
            acc[15] += w * 0.2886751401f * inp1[4] * in2[11];
            acc[10] += w * -0.5773502803f * inp1[4] * in2[12];
            acc[9] += w * -0.2886751401f * inp1[4] * in2[13];
            acc[11] += w * 0.4472135802f * inp1[4] * in2[13];
            acc[11] += w * 0.2886751401f * inp1[4] * in2[15];
            acc[14] += w * 0.4564354668f * inp1[5] * in2[9];
            acc[13] += w * 0.3535533840f * inp1[5] * in2[10];
            acc[15] += w * -0.4564354668f * inp1[5] * in2[10];
            acc[12] += w * 0.1825741828f * inp1[5] * in2[11];
            acc[14] += w * -0.3535533840f * inp1[5] * in2[11];
            acc[11] += w * 0.1825741828f * inp1[5] * in2[12];
            acc[10] += w * 0.3535533840f * inp1[5] * in2[13];
            acc[9] += w * 0.4564354668f * inp1[5] * in2[14];
            acc[11] += w * -0.3535533840f * inp1[5] * in2[14];
            acc[10] += w * -0.4564354668f * inp1[5] * in2[15];
            acc[9] += w * -0.6454972118f * inp1[6] * in2[9];
            acc[11] += w * 0.3872983429f * inp1[6] * in2[11];
            acc[12] += w * 0.5163977773f * inp1[6] * in2[12];
            acc[13] += w * 0.3872983429f * inp1[6] * in2[13];
            acc[15] += w * -0.6454972118f * inp1[6] * in2[15];
            acc[10] += w * 0.4564354668f * inp1[7] * in2[9];
            acc[9] += w * 0.4564354668f * inp1[7] * in2[10];
            acc[11] += w * 0.3535533840f * inp1[7] * in2[10];
            acc[10] += w * 0.3535533840f * inp1[7] * in2[11];
            acc[13] += w * 0.1825741828f * inp1[7] * in2[12];
            acc[12] += w * 0.1825741828f * inp1[7] * in2[13];
            acc[14] += w * 0.3535533840f * inp1[7] * in2[13];
            acc[13] += w * 0.3535533840f * inp1[7] * in2[14];
            acc[15] += w * 0.4564354668f * inp1[7] * in2[14];
            acc[14] += w * 0.4564354668f * inp1[7] * in2[15];
            acc[11] += w * -0.2886751401f * inp1[8] * in2[9];
            acc[9] += w * -0.2886751401f * inp1[8] * in2[11];
            acc[11] += w * -0.4472135802f * inp1[8] * in2[11];
            acc[14] += w * -0.5773502803f * inp1[8] * in2[12];
            acc[13] += w * 0.4472135802f * inp1[8] * in2[13];
            acc[15] += w * -0.2886751401f * inp1[8] * in2[13];
            acc[12] += w * -0.5773502803f * inp1[8] * in2[14];
            acc[13] += w * -0.2886751401f * inp1[8] * in2[15];
        }

        // Path 24: (3,0)->3
        {
            const float w = weights[24 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[9] += w * 0.9999999836f * inp1[9] * in2[0];
            acc[10] += w * 0.9999999836f * inp1[10] * in2[0];
            acc[11] += w * 0.9999999836f * inp1[11] * in2[0];
            acc[12] += w * 0.9999999836f * inp1[12] * in2[0];
            acc[13] += w * 0.9999999836f * inp1[13] * in2[0];
            acc[14] += w * 0.9999999836f * inp1[14] * in2[0];
            acc[15] += w * 0.9999999836f * inp1[15] * in2[0];
        }

        // Path 25: (3,1)->2
        {
            const float w = weights[25 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[8] += w * 0.5976142935f * inp1[9] * in2[1];
            acc[4] += w * 0.5976142935f * inp1[9] * in2[3];
            acc[7] += w * 0.4879500459f * inp1[10] * in2[1];
            acc[4] += w * 0.4879500459f * inp1[10] * in2[2];
            acc[5] += w * 0.4879500459f * inp1[10] * in2[3];
            acc[6] += w * 0.5345224892f * inp1[11] * in2[1];
            acc[8] += w * 0.1543033474f * inp1[11] * in2[1];
            acc[5] += w * 0.6172133895f * inp1[11] * in2[2];
            acc[4] += w * -0.1543033474f * inp1[11] * in2[3];
            acc[5] += w * -0.3779644601f * inp1[12] * in2[1];
            acc[6] += w * 0.6546536846f * inp1[12] * in2[2];
            acc[7] += w * -0.3779644601f * inp1[12] * in2[3];
            acc[4] += w * -0.1543033474f * inp1[13] * in2[1];
            acc[7] += w * 0.6172133895f * inp1[13] * in2[2];
            acc[6] += w * 0.5345224892f * inp1[13] * in2[3];
            acc[8] += w * -0.1543033474f * inp1[13] * in2[3];
            acc[5] += w * -0.4879500459f * inp1[14] * in2[1];
            acc[8] += w * 0.4879500459f * inp1[14] * in2[2];
            acc[7] += w * 0.4879500459f * inp1[14] * in2[3];
            acc[4] += w * -0.5976142935f * inp1[15] * in2[1];
            acc[8] += w * 0.5976142935f * inp1[15] * in2[3];
        }

        // Path 26: (3,1)->3
        {
            const float w = weights[26 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[10] += w * 0.3535533840f * inp1[9] * in2[1];
            acc[15] += w * 0.8660254007f * inp1[9] * in2[2];
            acc[14] += w * -0.3535533840f * inp1[9] * in2[3];
            acc[9] += w * -0.3535533840f * inp1[10] * in2[1];
            acc[11] += w * 0.4564354668f * inp1[10] * in2[1];
            acc[14] += w * 0.5773502803f * inp1[10] * in2[2];
            acc[13] += w * -0.4564354668f * inp1[10] * in2[3];
            acc[15] += w * -0.3535533840f * inp1[10] * in2[3];
            acc[10] += w * -0.4564354668f * inp1[11] * in2[1];
            acc[13] += w * 0.2886751401f * inp1[11] * in2[2];
            acc[12] += w * -0.7071067679f * inp1[11] * in2[3];
            acc[14] += w * -0.4564354668f * inp1[11] * in2[3];
            acc[13] += w * -0.7071067679f * inp1[12] * in2[1];
            acc[11] += w * 0.7071067679f * inp1[12] * in2[3];
            acc[12] += w * 0.7071067679f * inp1[13] * in2[1];
            acc[14] += w * -0.4564354668f * inp1[13] * in2[1];
            acc[11] += w * -0.2886751401f * inp1[13] * in2[2];
            acc[10] += w * 0.4564354668f * inp1[13] * in2[3];
            acc[13] += w * 0.4564354668f * inp1[14] * in2[1];
            acc[15] += w * -0.3535533840f * inp1[14] * in2[1];
            acc[10] += w * -0.5773502803f * inp1[14] * in2[2];
            acc[9] += w * 0.3535533840f * inp1[14] * in2[3];
            acc[11] += w * 0.4564354668f * inp1[14] * in2[3];
            acc[14] += w * 0.3535533840f * inp1[15] * in2[1];
            acc[9] += w * -0.8660254007f * inp1[15] * in2[2];
            acc[10] += w * 0.3535533840f * inp1[15] * in2[3];
        }

        // Path 27: (3,2)->1
        {
            const float w = weights[27 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[3] += w * 0.4629100412f * inp1[9] * in2[4];
            acc[1] += w * 0.4629100412f * inp1[9] * in2[8];
            acc[2] += w * 0.3779644803f * inp1[10] * in2[4];
            acc[3] += w * 0.3779644803f * inp1[10] * in2[5];
            acc[1] += w * 0.3779644803f * inp1[10] * in2[7];
            acc[3] += w * -0.1195228589f * inp1[11] * in2[4];
            acc[2] += w * 0.4780914358f * inp1[11] * in2[5];
            acc[1] += w * 0.4140393398f * inp1[11] * in2[6];
            acc[1] += w * 0.1195228589f * inp1[11] * in2[8];
            acc[1] += w * -0.2927700119f * inp1[12] * in2[5];
            acc[2] += w * 0.5070925636f * inp1[12] * in2[6];
            acc[3] += w * -0.2927700119f * inp1[12] * in2[7];
            acc[1] += w * -0.1195228589f * inp1[13] * in2[4];
            acc[3] += w * 0.4140393398f * inp1[13] * in2[6];
            acc[2] += w * 0.4780914358f * inp1[13] * in2[7];
            acc[3] += w * -0.1195228589f * inp1[13] * in2[8];
            acc[1] += w * -0.3779644803f * inp1[14] * in2[5];
            acc[3] += w * 0.3779644803f * inp1[14] * in2[7];
            acc[2] += w * 0.3779644803f * inp1[14] * in2[8];
            acc[1] += w * -0.4629100412f * inp1[15] * in2[4];
            acc[3] += w * 0.4629100412f * inp1[15] * in2[8];
        }

        // Path 28: (3,2)->2
        {
            const float w = weights[28 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[5] += w * 0.4225771204f * inp1[9] * in2[4];
            acc[4] += w * -0.4225771204f * inp1[9] * in2[5];
            acc[8] += w * 0.4225771204f * inp1[9] * in2[7];
            acc[7] += w * -0.4225771204f * inp1[9] * in2[8];
            acc[8] += w * 0.5976142935f * inp1[10] * in2[6];
            acc[6] += w * -0.5976142935f * inp1[10] * in2[8];
            acc[5] += w * 0.3273268423f * inp1[11] * in2[4];
            acc[4] += w * -0.3273268423f * inp1[11] * in2[5];
            acc[7] += w * 0.3779644601f * inp1[11] * in2[6];
            acc[6] += w * -0.3779644601f * inp1[11] * in2[7];
            acc[8] += w * -0.3273268423f * inp1[11] * in2[7];
            acc[7] += w * 0.3273268423f * inp1[11] * in2[8];
            acc[8] += w * 0.2672612446f * inp1[12] * in2[4];
            acc[7] += w * -0.5345224892f * inp1[12] * in2[5];
            acc[5] += w * 0.5345224892f * inp1[12] * in2[7];
            acc[4] += w * -0.2672612446f * inp1[12] * in2[8];
            acc[7] += w * -0.3273268423f * inp1[13] * in2[4];
            acc[6] += w * 0.3779644601f * inp1[13] * in2[5];
            acc[8] += w * -0.3273268423f * inp1[13] * in2[5];
            acc[5] += w * -0.3779644601f * inp1[13] * in2[6];
            acc[4] += w * 0.3273268423f * inp1[13] * in2[7];
            acc[5] += w * 0.3273268423f * inp1[13] * in2[8];
            acc[6] += w * 0.5976142935f * inp1[14] * in2[4];
            acc[4] += w * -0.5976142935f * inp1[14] * in2[6];
            acc[7] += w * 0.4225771204f * inp1[15] * in2[4];
            acc[8] += w * -0.4225771204f * inp1[15] * in2[5];
            acc[4] += w * -0.4225771204f * inp1[15] * in2[7];
            acc[5] += w * 0.4225771204f * inp1[15] * in2[8];
        }

        // Path 29: (3,2)->3
        {
            const float w = weights[29 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[13] += w * -0.2886751401f * inp1[9] * in2[4];
            acc[14] += w * 0.4564354668f * inp1[9] * in2[5];
            acc[9] += w * -0.6454972118f * inp1[9] * in2[6];
            acc[10] += w * 0.4564354668f * inp1[9] * in2[7];
            acc[11] += w * -0.2886751401f * inp1[9] * in2[8];
            acc[12] += w * -0.5773502803f * inp1[10] * in2[4];
            acc[13] += w * 0.3535533840f * inp1[10] * in2[5];
            acc[15] += w * -0.4564354668f * inp1[10] * in2[5];
            acc[9] += w * 0.4564354668f * inp1[10] * in2[7];
            acc[11] += w * 0.3535533840f * inp1[10] * in2[7];
            acc[13] += w * 0.4472135802f * inp1[11] * in2[4];
            acc[15] += w * 0.2886751401f * inp1[11] * in2[4];
            acc[12] += w * 0.1825741828f * inp1[11] * in2[5];
            acc[14] += w * -0.3535533840f * inp1[11] * in2[5];
            acc[11] += w * 0.3872983429f * inp1[11] * in2[6];
            acc[10] += w * 0.3535533840f * inp1[11] * in2[7];
            acc[9] += w * -0.2886751401f * inp1[11] * in2[8];
            acc[11] += w * -0.4472135802f * inp1[11] * in2[8];
            acc[10] += w * -0.5773502803f * inp1[12] * in2[4];
            acc[11] += w * 0.1825741828f * inp1[12] * in2[5];
            acc[12] += w * 0.5163977773f * inp1[12] * in2[6];
            acc[13] += w * 0.1825741828f * inp1[12] * in2[7];
            acc[14] += w * -0.5773502803f * inp1[12] * in2[8];
            acc[9] += w * -0.2886751401f * inp1[13] * in2[4];
            acc[11] += w * 0.4472135802f * inp1[13] * in2[4];
            acc[10] += w * 0.3535533840f * inp1[13] * in2[5];
            acc[13] += w * 0.3872983429f * inp1[13] * in2[6];
            acc[12] += w * 0.1825741828f * inp1[13] * in2[7];
            acc[14] += w * 0.3535533840f * inp1[13] * in2[7];
            acc[13] += w * 0.4472135802f * inp1[13] * in2[8];
            acc[15] += w * -0.2886751401f * inp1[13] * in2[8];
            acc[9] += w * 0.4564354668f * inp1[14] * in2[5];
            acc[11] += w * -0.3535533840f * inp1[14] * in2[5];
            acc[13] += w * 0.3535533840f * inp1[14] * in2[7];
            acc[15] += w * 0.4564354668f * inp1[14] * in2[7];
            acc[12] += w * -0.5773502803f * inp1[14] * in2[8];
            acc[11] += w * 0.2886751401f * inp1[15] * in2[4];
            acc[10] += w * -0.4564354668f * inp1[15] * in2[5];
            acc[15] += w * -0.6454972118f * inp1[15] * in2[6];
            acc[14] += w * 0.4564354668f * inp1[15] * in2[7];
            acc[13] += w * -0.2886751401f * inp1[15] * in2[8];
        }

        // Path 30: (3,3)->0
        {
            const float w = weights[30 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[0] += w * 0.3779644668f * inp1[9] * in2[9];
            acc[0] += w * 0.3779644668f * inp1[10] * in2[10];
            acc[0] += w * 0.3779644668f * inp1[11] * in2[11];
            acc[0] += w * 0.3779644668f * inp1[12] * in2[12];
            acc[0] += w * 0.3779644668f * inp1[13] * in2[13];
            acc[0] += w * 0.3779644668f * inp1[14] * in2[14];
            acc[0] += w * 0.3779644668f * inp1[15] * in2[15];
        }

        // Path 31: (3,3)->1
        {
            const float w = weights[31 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[1] += w * -0.2314550206f * inp1[9] * in2[10];
            acc[3] += w * 0.2314550206f * inp1[9] * in2[14];
            acc[2] += w * -0.5669467075f * inp1[9] * in2[15];
            acc[1] += w * 0.2314550206f * inp1[10] * in2[9];
            acc[1] += w * -0.2988071538f * inp1[10] * in2[11];
            acc[3] += w * 0.2988071538f * inp1[10] * in2[13];
            acc[2] += w * -0.3779644803f * inp1[10] * in2[14];
            acc[3] += w * 0.2314550206f * inp1[10] * in2[15];
            acc[1] += w * 0.2988071538f * inp1[11] * in2[10];
            acc[3] += w * 0.4629100412f * inp1[11] * in2[12];
            acc[2] += w * -0.1889822401f * inp1[11] * in2[13];
            acc[3] += w * 0.2988071538f * inp1[11] * in2[14];
            acc[3] += w * -0.4629100412f * inp1[12] * in2[11];
            acc[1] += w * 0.4629100412f * inp1[12] * in2[13];
            acc[3] += w * -0.2988071538f * inp1[13] * in2[10];
            acc[2] += w * 0.1889822401f * inp1[13] * in2[11];
            acc[1] += w * -0.4629100412f * inp1[13] * in2[12];
            acc[1] += w * 0.2988071538f * inp1[13] * in2[14];
            acc[3] += w * -0.2314550206f * inp1[14] * in2[9];
            acc[2] += w * 0.3779644803f * inp1[14] * in2[10];
            acc[3] += w * -0.2988071538f * inp1[14] * in2[11];
            acc[1] += w * -0.2988071538f * inp1[14] * in2[13];
            acc[1] += w * 0.2314550206f * inp1[14] * in2[15];
            acc[2] += w * 0.5669467075f * inp1[15] * in2[9];
            acc[3] += w * -0.2314550206f * inp1[15] * in2[10];
            acc[1] += w * -0.2314550206f * inp1[15] * in2[14];
        }

        // Path 32: (3,3)->2
        {
            const float w = weights[32 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[6] += w * -0.5455447150f * inp1[9] * in2[9];
            acc[7] += w * 0.3857583768f * inp1[9] * in2[10];
            acc[8] += w * -0.2439750229f * inp1[9] * in2[11];
            acc[4] += w * -0.2439750229f * inp1[9] * in2[13];
            acc[5] += w * 0.3857583768f * inp1[9] * in2[14];
            acc[7] += w * 0.3857583768f * inp1[10] * in2[9];
            acc[7] += w * 0.2988071467f * inp1[10] * in2[11];
            acc[4] += w * -0.4879500459f * inp1[10] * in2[12];
            acc[5] += w * 0.2988071467f * inp1[10] * in2[13];
            acc[5] += w * -0.3857583768f * inp1[10] * in2[15];
            acc[8] += w * -0.2439750229f * inp1[11] * in2[9];
            acc[7] += w * 0.2988071467f * inp1[11] * in2[10];
            acc[6] += w * 0.3273268423f * inp1[11] * in2[11];
            acc[8] += w * -0.3779644601f * inp1[11] * in2[11];
            acc[5] += w * 0.1543033474f * inp1[11] * in2[12];
            acc[4] += w * 0.3779644601f * inp1[11] * in2[13];
            acc[5] += w * -0.2988071467f * inp1[11] * in2[14];
            acc[4] += w * 0.2439750229f * inp1[11] * in2[15];
            acc[4] += w * -0.4879500459f * inp1[12] * in2[10];
            acc[5] += w * 0.1543033474f * inp1[12] * in2[11];
            acc[6] += w * 0.4364357787f * inp1[12] * in2[12];
            acc[7] += w * 0.1543033474f * inp1[12] * in2[13];
            acc[8] += w * -0.4879500459f * inp1[12] * in2[14];
            acc[4] += w * -0.2439750229f * inp1[13] * in2[9];
            acc[5] += w * 0.2988071467f * inp1[13] * in2[10];
            acc[4] += w * 0.3779644601f * inp1[13] * in2[11];
            acc[7] += w * 0.1543033474f * inp1[13] * in2[12];
            acc[6] += w * 0.3273268423f * inp1[13] * in2[13];
            acc[8] += w * 0.3779644601f * inp1[13] * in2[13];
            acc[7] += w * 0.2988071467f * inp1[13] * in2[14];
            acc[8] += w * -0.2439750229f * inp1[13] * in2[15];
            acc[5] += w * 0.3857583768f * inp1[14] * in2[9];
            acc[5] += w * -0.2988071467f * inp1[14] * in2[11];
            acc[8] += w * -0.4879500459f * inp1[14] * in2[12];
            acc[7] += w * 0.2988071467f * inp1[14] * in2[13];
            acc[7] += w * 0.3857583768f * inp1[14] * in2[15];
            acc[5] += w * -0.3857583768f * inp1[15] * in2[10];
            acc[4] += w * 0.2439750229f * inp1[15] * in2[11];
            acc[8] += w * -0.2439750229f * inp1[15] * in2[13];
            acc[7] += w * 0.3857583768f * inp1[15] * in2[14];
            acc[6] += w * -0.5455447150f * inp1[15] * in2[15];
        }

        // Path 33: (3,3)->3
        {
            const float w = weights[33 * C_IN * C_OUT + c_in * C_OUT + c_out];
            acc[11] += w * 0.4082483091f * inp1[9] * in2[10];
            acc[10] += w * -0.4082483091f * inp1[9] * in2[11];
            acc[15] += w * -0.4082483091f * inp1[9] * in2[12];
            acc[14] += w * 0.4082483091f * inp1[9] * in2[13];
            acc[13] += w * -0.4082483091f * inp1[9] * in2[14];
            acc[12] += w * 0.4082483091f * inp1[9] * in2[15];
            acc[11] += w * -0.4082483091f * inp1[10] * in2[9];
            acc[9] += w * 0.4082483091f * inp1[10] * in2[11];
            acc[14] += w * 0.4082483091f * inp1[10] * in2[12];
            acc[15] += w * 0.4082483091f * inp1[10] * in2[13];
            acc[12] += w * -0.4082483091f * inp1[10] * in2[14];
            acc[13] += w * -0.4082483091f * inp1[10] * in2[15];
            acc[10] += w * 0.4082483091f * inp1[11] * in2[9];
            acc[9] += w * -0.4082483091f * inp1[11] * in2[10];
            acc[13] += w * 0.4082483091f * inp1[11] * in2[12];
            acc[12] += w * -0.4082483091f * inp1[11] * in2[13];
            acc[15] += w * -0.4082483091f * inp1[11] * in2[14];
            acc[14] += w * 0.4082483091f * inp1[11] * in2[15];
            acc[15] += w * 0.4082483091f * inp1[12] * in2[9];
            acc[14] += w * -0.4082483091f * inp1[12] * in2[10];
            acc[13] += w * -0.4082483091f * inp1[12] * in2[11];
            acc[11] += w * 0.4082483091f * inp1[12] * in2[13];
            acc[10] += w * 0.4082483091f * inp1[12] * in2[14];
            acc[9] += w * -0.4082483091f * inp1[12] * in2[15];
            acc[14] += w * -0.4082483091f * inp1[13] * in2[9];
            acc[15] += w * -0.4082483091f * inp1[13] * in2[10];
            acc[12] += w * 0.4082483091f * inp1[13] * in2[11];
            acc[11] += w * -0.4082483091f * inp1[13] * in2[12];
            acc[9] += w * 0.4082483091f * inp1[13] * in2[14];
            acc[10] += w * 0.4082483091f * inp1[13] * in2[15];
            acc[13] += w * 0.4082483091f * inp1[14] * in2[9];
            acc[12] += w * 0.4082483091f * inp1[14] * in2[10];
            acc[15] += w * 0.4082483091f * inp1[14] * in2[11];
            acc[10] += w * -0.4082483091f * inp1[14] * in2[12];
            acc[9] += w * -0.4082483091f * inp1[14] * in2[13];
            acc[11] += w * -0.4082483091f * inp1[14] * in2[15];
            acc[12] += w * -0.4082483091f * inp1[15] * in2[9];
            acc[13] += w * 0.4082483091f * inp1[15] * in2[10];
            acc[14] += w * -0.4082483091f * inp1[15] * in2[11];
            acc[9] += w * 0.4082483091f * inp1[15] * in2[12];
            acc[10] += w * -0.4082483091f * inp1[15] * in2[13];
            acc[11] += w * 0.4082483091f * inp1[15] * in2[14];
        }

    }

    // Write output
    #pragma unroll
    for (int i = 0; i < 16; i++) {
        out[i] = acc[i];
    }
}

// Dynamic channel version (for runtime flexibility)
__device__ __forceinline__ void tensor_product_full_dynamic(
    const float* __restrict__ in1,      // [C_in, 16] for this sample
    const float* __restrict__ in2,      // [16] for this sample
    const float* __restrict__ weights,  // [NUM_PATHS, C_in, C_out]
    float* __restrict__ out,            // [16] output for this (sample, c_out)
    int c_in_count,
    int c_out_count,
    int c_out
) {
    float acc[16] = {0};

    for (int c_in = 0; c_in < c_in_count; c_in++) {
        const float* inp1 = in1 + c_in * 16;

        // Path 0: (0,0)->0
        {
            const float w = weights[0 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[0] += w * 1.0000000000f * inp1[0] * in2[0];
        }
        // Path 1: (0,1)->1
        {
            const float w = weights[1 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[1] += w * 0.9999999821f * inp1[0] * in2[1];
            acc[2] += w * 0.9999999821f * inp1[0] * in2[2];
            acc[3] += w * 0.9999999821f * inp1[0] * in2[3];
        }
        // Path 2: (0,2)->2
        {
            const float w = weights[2 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[4] += w * 0.9999999880f * inp1[0] * in2[4];
            acc[5] += w * 0.9999999880f * inp1[0] * in2[5];
            acc[6] += w * 0.9999999880f * inp1[0] * in2[6];
            acc[7] += w * 0.9999999880f * inp1[0] * in2[7];
            acc[8] += w * 0.9999999880f * inp1[0] * in2[8];
        }
        // Path 3: (0,3)->3
        {
            const float w = weights[3 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[9] += w * 0.9999999836f * inp1[0] * in2[9];
            acc[10] += w * 0.9999999836f * inp1[0] * in2[10];
            acc[11] += w * 0.9999999836f * inp1[0] * in2[11];
            acc[12] += w * 0.9999999836f * inp1[0] * in2[12];
            acc[13] += w * 0.9999999836f * inp1[0] * in2[13];
            acc[14] += w * 0.9999999836f * inp1[0] * in2[14];
            acc[15] += w * 0.9999999836f * inp1[0] * in2[15];
        }
        // Path 4: (1,0)->1
        {
            const float w = weights[4 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[1] += w * 0.9999999821f * inp1[1] * in2[0];
            acc[2] += w * 0.9999999821f * inp1[2] * in2[0];
            acc[3] += w * 0.9999999821f * inp1[3] * in2[0];
        }
        // Path 5: (1,1)->0
        {
            const float w = weights[5 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[0] += w * 0.5773502588f * inp1[1] * in2[1];
            acc[0] += w * 0.5773502588f * inp1[2] * in2[2];
            acc[0] += w * 0.5773502588f * inp1[3] * in2[3];
        }
        // Path 6: (1,1)->1
        {
            const float w = weights[6 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[3] += w * 0.7071068069f * inp1[1] * in2[2];
            acc[2] += w * -0.7071068069f * inp1[1] * in2[3];
            acc[3] += w * -0.7071068069f * inp1[2] * in2[1];
            acc[1] += w * 0.7071068069f * inp1[2] * in2[3];
            acc[2] += w * 0.7071068069f * inp1[3] * in2[1];
            acc[1] += w * -0.7071068069f * inp1[3] * in2[2];
        }
        // Path 7: (1,1)->2
        {
            const float w = weights[7 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[6] += w * -0.4082482836f * inp1[1] * in2[1];
            acc[8] += w * -0.7071067764f * inp1[1] * in2[1];
            acc[5] += w * 0.7071067764f * inp1[1] * in2[2];
            acc[4] += w * 0.7071067764f * inp1[1] * in2[3];
            acc[5] += w * 0.7071067764f * inp1[2] * in2[1];
            acc[6] += w * 0.8164965671f * inp1[2] * in2[2];
            acc[7] += w * 0.7071067764f * inp1[2] * in2[3];
            acc[4] += w * 0.7071067764f * inp1[3] * in2[1];
            acc[7] += w * 0.7071067764f * inp1[3] * in2[2];
            acc[6] += w * -0.4082482836f * inp1[3] * in2[3];
            acc[8] += w * 0.7071067764f * inp1[3] * in2[3];
        }
        // Path 8: (1,2)->1
        {
            const float w = weights[8 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[3] += w * 0.5477225538f * inp1[1] * in2[4];
            acc[2] += w * 0.5477225538f * inp1[1] * in2[5];
            acc[1] += w * -0.3162277607f * inp1[1] * in2[6];
            acc[1] += w * -0.5477225538f * inp1[1] * in2[8];
            acc[1] += w * 0.5477225538f * inp1[2] * in2[5];
            acc[2] += w * 0.6324555213f * inp1[2] * in2[6];
            acc[3] += w * 0.5477225538f * inp1[2] * in2[7];
            acc[1] += w * 0.5477225538f * inp1[3] * in2[4];
            acc[3] += w * -0.3162277607f * inp1[3] * in2[6];
            acc[2] += w * 0.5477225538f * inp1[3] * in2[7];
            acc[3] += w * 0.5477225538f * inp1[3] * in2[8];
        }
        // Path 9: (1,2)->2
        {
            const float w = weights[9 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[5] += w * -0.4082482836f * inp1[1] * in2[4];
            acc[4] += w * 0.4082482836f * inp1[1] * in2[5];
            acc[7] += w * 0.7071067764f * inp1[1] * in2[6];
            acc[6] += w * -0.7071067764f * inp1[1] * in2[7];
            acc[8] += w * 0.4082482836f * inp1[1] * in2[7];
            acc[7] += w * -0.4082482836f * inp1[1] * in2[8];
            acc[8] += w * -0.8164965671f * inp1[2] * in2[4];
            acc[7] += w * -0.4082482836f * inp1[2] * in2[5];
            acc[5] += w * 0.4082482836f * inp1[2] * in2[7];
            acc[4] += w * 0.8164965671f * inp1[2] * in2[8];
            acc[7] += w * 0.4082482836f * inp1[3] * in2[4];
            acc[6] += w * 0.7071067764f * inp1[3] * in2[5];
            acc[8] += w * 0.4082482836f * inp1[3] * in2[5];
            acc[5] += w * -0.7071067764f * inp1[3] * in2[6];
            acc[4] += w * -0.4082482836f * inp1[3] * in2[7];
            acc[5] += w * -0.4082482836f * inp1[3] * in2[8];
        }
        // Path 10: (1,2)->3
        {
            const float w = weights[10 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[13] += w * -0.1825741828f * inp1[1] * in2[4];
            acc[15] += w * -0.7071067679f * inp1[1] * in2[4];
            acc[12] += w * -0.4472135802f * inp1[1] * in2[5];
            acc[14] += w * -0.5773502803f * inp1[1] * in2[5];
            acc[11] += w * 0.6324555384f * inp1[1] * in2[6];
            acc[10] += w * 0.5773502803f * inp1[1] * in2[7];
            acc[9] += w * 0.7071067679f * inp1[1] * in2[8];
            acc[11] += w * 0.1825741828f * inp1[1] * in2[8];
            acc[10] += w * 0.5773502803f * inp1[2] * in2[4];
            acc[11] += w * 0.7302967312f * inp1[2] * in2[5];
            acc[12] += w * 0.7745966857f * inp1[2] * in2[6];
            acc[13] += w * 0.7302967312f * inp1[2] * in2[7];
            acc[14] += w * 0.5773502803f * inp1[2] * in2[8];
            acc[9] += w * 0.7071067679f * inp1[3] * in2[4];
            acc[11] += w * -0.1825741828f * inp1[3] * in2[4];
            acc[10] += w * 0.5773502803f * inp1[3] * in2[5];
            acc[13] += w * 0.6324555384f * inp1[3] * in2[6];
            acc[12] += w * -0.4472135802f * inp1[3] * in2[7];
            acc[14] += w * 0.5773502803f * inp1[3] * in2[7];
            acc[13] += w * -0.1825741828f * inp1[3] * in2[8];
            acc[15] += w * 0.7071067679f * inp1[3] * in2[8];
        }
        // Path 11: (1,3)->2
        {
            const float w = weights[11 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[8] += w * 0.5976142935f * inp1[1] * in2[9];
            acc[7] += w * 0.4879500459f * inp1[1] * in2[10];
            acc[6] += w * 0.5345224892f * inp1[1] * in2[11];
            acc[8] += w * 0.1543033474f * inp1[1] * in2[11];
            acc[5] += w * -0.3779644601f * inp1[1] * in2[12];
            acc[4] += w * -0.1543033474f * inp1[1] * in2[13];
            acc[5] += w * -0.4879500459f * inp1[1] * in2[14];
            acc[4] += w * -0.5976142935f * inp1[1] * in2[15];
            acc[4] += w * 0.4879500459f * inp1[2] * in2[10];
            acc[5] += w * 0.6172133895f * inp1[2] * in2[11];
            acc[6] += w * 0.6546536846f * inp1[2] * in2[12];
            acc[7] += w * 0.6172133895f * inp1[2] * in2[13];
            acc[8] += w * 0.4879500459f * inp1[2] * in2[14];
            acc[4] += w * 0.5976142935f * inp1[3] * in2[9];
            acc[5] += w * 0.4879500459f * inp1[3] * in2[10];
            acc[4] += w * -0.1543033474f * inp1[3] * in2[11];
            acc[7] += w * -0.3779644601f * inp1[3] * in2[12];
            acc[6] += w * 0.5345224892f * inp1[3] * in2[13];
            acc[8] += w * -0.1543033474f * inp1[3] * in2[13];
            acc[7] += w * 0.4879500459f * inp1[3] * in2[14];
            acc[8] += w * 0.5976142935f * inp1[3] * in2[15];
        }
        // Path 12: (1,3)->3
        {
            const float w = weights[12 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[10] += w * -0.3535533840f * inp1[1] * in2[9];
            acc[9] += w * 0.3535533840f * inp1[1] * in2[10];
            acc[11] += w * -0.4564354668f * inp1[1] * in2[10];
            acc[10] += w * 0.4564354668f * inp1[1] * in2[11];
            acc[13] += w * 0.7071067679f * inp1[1] * in2[12];
            acc[12] += w * -0.7071067679f * inp1[1] * in2[13];
            acc[14] += w * 0.4564354668f * inp1[1] * in2[13];
            acc[13] += w * -0.4564354668f * inp1[1] * in2[14];
            acc[15] += w * 0.3535533840f * inp1[1] * in2[14];
            acc[14] += w * -0.3535533840f * inp1[1] * in2[15];
            acc[15] += w * -0.8660254007f * inp1[2] * in2[9];
            acc[14] += w * -0.5773502803f * inp1[2] * in2[10];
            acc[13] += w * -0.2886751401f * inp1[2] * in2[11];
            acc[11] += w * 0.2886751401f * inp1[2] * in2[13];
            acc[10] += w * 0.5773502803f * inp1[2] * in2[14];
            acc[9] += w * 0.8660254007f * inp1[2] * in2[15];
            acc[14] += w * 0.3535533840f * inp1[3] * in2[9];
            acc[13] += w * 0.4564354668f * inp1[3] * in2[10];
            acc[15] += w * 0.3535533840f * inp1[3] * in2[10];
            acc[12] += w * 0.7071067679f * inp1[3] * in2[11];
            acc[14] += w * 0.4564354668f * inp1[3] * in2[11];
            acc[11] += w * -0.7071067679f * inp1[3] * in2[12];
            acc[10] += w * -0.4564354668f * inp1[3] * in2[13];
            acc[9] += w * -0.3535533840f * inp1[3] * in2[14];
            acc[11] += w * -0.4564354668f * inp1[3] * in2[14];
            acc[10] += w * -0.3535533840f * inp1[3] * in2[15];
        }
        // Path 13: (2,0)->2
        {
            const float w = weights[13 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[4] += w * 0.9999999880f * inp1[4] * in2[0];
            acc[5] += w * 0.9999999880f * inp1[5] * in2[0];
            acc[6] += w * 0.9999999880f * inp1[6] * in2[0];
            acc[7] += w * 0.9999999880f * inp1[7] * in2[0];
            acc[8] += w * 0.9999999880f * inp1[8] * in2[0];
        }
        // Path 14: (2,1)->1
        {
            const float w = weights[14 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[3] += w * 0.5477225538f * inp1[4] * in2[1];
            acc[1] += w * 0.5477225538f * inp1[4] * in2[3];
            acc[2] += w * 0.5477225538f * inp1[5] * in2[1];
            acc[1] += w * 0.5477225538f * inp1[5] * in2[2];
            acc[1] += w * -0.3162277607f * inp1[6] * in2[1];
            acc[2] += w * 0.6324555213f * inp1[6] * in2[2];
            acc[3] += w * -0.3162277607f * inp1[6] * in2[3];
            acc[3] += w * 0.5477225538f * inp1[7] * in2[2];
            acc[2] += w * 0.5477225538f * inp1[7] * in2[3];
            acc[1] += w * -0.5477225538f * inp1[8] * in2[1];
            acc[3] += w * 0.5477225538f * inp1[8] * in2[3];
        }
        // Path 15: (2,1)->2
        {
            const float w = weights[15 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[5] += w * 0.4082482836f * inp1[4] * in2[1];
            acc[8] += w * 0.8164965671f * inp1[4] * in2[2];
            acc[7] += w * -0.4082482836f * inp1[4] * in2[3];
            acc[4] += w * -0.4082482836f * inp1[5] * in2[1];
            acc[7] += w * 0.4082482836f * inp1[5] * in2[2];
            acc[6] += w * -0.7071067764f * inp1[5] * in2[3];
            acc[8] += w * -0.4082482836f * inp1[5] * in2[3];
            acc[7] += w * -0.7071067764f * inp1[6] * in2[1];
            acc[5] += w * 0.7071067764f * inp1[6] * in2[3];
            acc[6] += w * 0.7071067764f * inp1[7] * in2[1];
            acc[8] += w * -0.4082482836f * inp1[7] * in2[1];
            acc[5] += w * -0.4082482836f * inp1[7] * in2[2];
            acc[4] += w * 0.4082482836f * inp1[7] * in2[3];
            acc[7] += w * 0.4082482836f * inp1[8] * in2[1];
            acc[4] += w * -0.8164965671f * inp1[8] * in2[2];
            acc[5] += w * 0.4082482836f * inp1[8] * in2[3];
        }
        // Path 16: (2,1)->3
        {
            const float w = weights[16 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[13] += w * -0.1825741828f * inp1[4] * in2[1];
            acc[15] += w * -0.7071067679f * inp1[4] * in2[1];
            acc[10] += w * 0.5773502803f * inp1[4] * in2[2];
            acc[9] += w * 0.7071067679f * inp1[4] * in2[3];
            acc[11] += w * -0.1825741828f * inp1[4] * in2[3];
            acc[12] += w * -0.4472135802f * inp1[5] * in2[1];
            acc[14] += w * -0.5773502803f * inp1[5] * in2[1];
            acc[11] += w * 0.7302967312f * inp1[5] * in2[2];
            acc[10] += w * 0.5773502803f * inp1[5] * in2[3];
            acc[11] += w * 0.6324555384f * inp1[6] * in2[1];
            acc[12] += w * 0.7745966857f * inp1[6] * in2[2];
            acc[13] += w * 0.6324555384f * inp1[6] * in2[3];
            acc[10] += w * 0.5773502803f * inp1[7] * in2[1];
            acc[13] += w * 0.7302967312f * inp1[7] * in2[2];
            acc[12] += w * -0.4472135802f * inp1[7] * in2[3];
            acc[14] += w * 0.5773502803f * inp1[7] * in2[3];
            acc[9] += w * 0.7071067679f * inp1[8] * in2[1];
            acc[11] += w * 0.1825741828f * inp1[8] * in2[1];
            acc[14] += w * 0.5773502803f * inp1[8] * in2[2];
            acc[13] += w * -0.1825741828f * inp1[8] * in2[3];
            acc[15] += w * 0.7071067679f * inp1[8] * in2[3];
        }
        // Path 17: (2,2)->0
        {
            const float w = weights[17 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[0] += w * 0.4472135901f * inp1[4] * in2[4];
            acc[0] += w * 0.4472135901f * inp1[5] * in2[5];
            acc[0] += w * 0.4472135901f * inp1[6] * in2[6];
            acc[0] += w * 0.4472135901f * inp1[7] * in2[7];
            acc[0] += w * 0.4472135901f * inp1[8] * in2[8];
        }
        // Path 18: (2,2)->1
        {
            const float w = weights[18 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[1] += w * -0.3162277607f * inp1[4] * in2[5];
            acc[3] += w * 0.3162277607f * inp1[4] * in2[7];
            acc[2] += w * -0.6324555213f * inp1[4] * in2[8];
            acc[1] += w * 0.3162277607f * inp1[5] * in2[4];
            acc[3] += w * 0.5477225538f * inp1[5] * in2[6];
            acc[2] += w * -0.3162277607f * inp1[5] * in2[7];
            acc[3] += w * 0.3162277607f * inp1[5] * in2[8];
            acc[3] += w * -0.5477225538f * inp1[6] * in2[5];
            acc[1] += w * 0.5477225538f * inp1[6] * in2[7];
            acc[3] += w * -0.3162277607f * inp1[7] * in2[4];
            acc[2] += w * 0.3162277607f * inp1[7] * in2[5];
            acc[1] += w * -0.5477225538f * inp1[7] * in2[6];
            acc[1] += w * 0.3162277607f * inp1[7] * in2[8];
            acc[2] += w * 0.6324555213f * inp1[8] * in2[4];
            acc[3] += w * -0.3162277607f * inp1[8] * in2[5];
            acc[1] += w * -0.3162277607f * inp1[8] * in2[7];
        }
        // Path 19: (2,2)->2
        {
            const float w = weights[19 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[6] += w * -0.5345224892f * inp1[4] * in2[4];
            acc[7] += w * 0.4629100588f * inp1[4] * in2[5];
            acc[4] += w * -0.5345224892f * inp1[4] * in2[6];
            acc[5] += w * 0.4629100588f * inp1[4] * in2[7];
            acc[7] += w * 0.4629100588f * inp1[5] * in2[4];
            acc[6] += w * 0.2672612446f * inp1[5] * in2[5];
            acc[8] += w * -0.4629100588f * inp1[5] * in2[5];
            acc[5] += w * 0.2672612446f * inp1[5] * in2[6];
            acc[4] += w * 0.4629100588f * inp1[5] * in2[7];
            acc[5] += w * -0.4629100588f * inp1[5] * in2[8];
            acc[4] += w * -0.5345224892f * inp1[6] * in2[4];
            acc[5] += w * 0.2672612446f * inp1[6] * in2[5];
            acc[6] += w * 0.5345224892f * inp1[6] * in2[6];
            acc[7] += w * 0.2672612446f * inp1[6] * in2[7];
            acc[8] += w * -0.5345224892f * inp1[6] * in2[8];
            acc[5] += w * 0.4629100588f * inp1[7] * in2[4];
            acc[4] += w * 0.4629100588f * inp1[7] * in2[5];
            acc[7] += w * 0.2672612446f * inp1[7] * in2[6];
            acc[6] += w * 0.2672612446f * inp1[7] * in2[7];
            acc[8] += w * 0.4629100588f * inp1[7] * in2[7];
            acc[7] += w * 0.4629100588f * inp1[7] * in2[8];
            acc[5] += w * -0.4629100588f * inp1[8] * in2[5];
            acc[8] += w * -0.5345224892f * inp1[8] * in2[6];
            acc[7] += w * 0.4629100588f * inp1[8] * in2[7];
            acc[6] += w * -0.5345224892f * inp1[8] * in2[8];
        }
        // Path 20: (2,2)->3
        {
            const float w = weights[20 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[9] += w * 0.4999999918f * inp1[4] * in2[5];
            acc[11] += w * 0.3872983429f * inp1[4] * in2[5];
            acc[14] += w * 0.7071067679f * inp1[4] * in2[6];
            acc[13] += w * -0.3872983429f * inp1[4] * in2[7];
            acc[15] += w * 0.4999999918f * inp1[4] * in2[7];
            acc[12] += w * 0.3162277692f * inp1[4] * in2[8];
            acc[9] += w * -0.4999999918f * inp1[5] * in2[4];
            acc[11] += w * -0.3872983429f * inp1[5] * in2[4];
            acc[13] += w * 0.4472135802f * inp1[5] * in2[6];
            acc[12] += w * -0.6324555384f * inp1[5] * in2[7];
            acc[13] += w * -0.3872983429f * inp1[5] * in2[8];
            acc[15] += w * -0.4999999918f * inp1[5] * in2[8];
            acc[14] += w * -0.7071067679f * inp1[6] * in2[4];
            acc[13] += w * -0.4472135802f * inp1[6] * in2[5];
            acc[11] += w * 0.4472135802f * inp1[6] * in2[7];
            acc[10] += w * 0.7071067679f * inp1[6] * in2[8];
            acc[13] += w * 0.3872983429f * inp1[7] * in2[4];
            acc[15] += w * -0.4999999918f * inp1[7] * in2[4];
            acc[12] += w * 0.6324555384f * inp1[7] * in2[5];
            acc[11] += w * -0.4472135802f * inp1[7] * in2[6];
            acc[9] += w * 0.4999999918f * inp1[7] * in2[8];
            acc[11] += w * -0.3872983429f * inp1[7] * in2[8];
            acc[12] += w * -0.3162277692f * inp1[8] * in2[4];
            acc[13] += w * 0.3872983429f * inp1[8] * in2[5];
            acc[15] += w * 0.4999999918f * inp1[8] * in2[5];
            acc[10] += w * -0.7071067679f * inp1[8] * in2[6];
            acc[9] += w * -0.4999999918f * inp1[8] * in2[7];
            acc[11] += w * 0.3872983429f * inp1[8] * in2[7];
        }
        // Path 21: (2,3)->1
        {
            const float w = weights[21 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[3] += w * 0.4629100412f * inp1[4] * in2[9];
            acc[2] += w * 0.3779644803f * inp1[4] * in2[10];
            acc[3] += w * -0.1195228589f * inp1[4] * in2[11];
            acc[1] += w * -0.1195228589f * inp1[4] * in2[13];
            acc[1] += w * -0.4629100412f * inp1[4] * in2[15];
            acc[3] += w * 0.3779644803f * inp1[5] * in2[10];
            acc[2] += w * 0.4780914358f * inp1[5] * in2[11];
            acc[1] += w * -0.2927700119f * inp1[5] * in2[12];
            acc[1] += w * -0.3779644803f * inp1[5] * in2[14];
            acc[1] += w * 0.4140393398f * inp1[6] * in2[11];
            acc[2] += w * 0.5070925636f * inp1[6] * in2[12];
            acc[3] += w * 0.4140393398f * inp1[6] * in2[13];
            acc[1] += w * 0.3779644803f * inp1[7] * in2[10];
            acc[3] += w * -0.2927700119f * inp1[7] * in2[12];
            acc[2] += w * 0.4780914358f * inp1[7] * in2[13];
            acc[3] += w * 0.3779644803f * inp1[7] * in2[14];
            acc[1] += w * 0.4629100412f * inp1[8] * in2[9];
            acc[1] += w * 0.1195228589f * inp1[8] * in2[11];
            acc[3] += w * -0.1195228589f * inp1[8] * in2[13];
            acc[2] += w * 0.3779644803f * inp1[8] * in2[14];
            acc[3] += w * 0.4629100412f * inp1[8] * in2[15];
        }
        // Path 22: (2,3)->2
        {
            const float w = weights[22 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[5] += w * -0.4225771204f * inp1[4] * in2[9];
            acc[5] += w * -0.3273268423f * inp1[4] * in2[11];
            acc[8] += w * -0.2672612446f * inp1[4] * in2[12];
            acc[7] += w * 0.3273268423f * inp1[4] * in2[13];
            acc[6] += w * -0.5976142935f * inp1[4] * in2[14];
            acc[7] += w * -0.4225771204f * inp1[4] * in2[15];
            acc[4] += w * 0.4225771204f * inp1[5] * in2[9];
            acc[4] += w * 0.3273268423f * inp1[5] * in2[11];
            acc[7] += w * 0.5345224892f * inp1[5] * in2[12];
            acc[6] += w * -0.3779644601f * inp1[5] * in2[13];
            acc[8] += w * 0.3273268423f * inp1[5] * in2[13];
            acc[8] += w * 0.4225771204f * inp1[5] * in2[15];
            acc[8] += w * -0.5976142935f * inp1[6] * in2[10];
            acc[7] += w * -0.3779644601f * inp1[6] * in2[11];
            acc[5] += w * 0.3779644601f * inp1[6] * in2[13];
            acc[4] += w * 0.5976142935f * inp1[6] * in2[14];
            acc[8] += w * -0.4225771204f * inp1[7] * in2[9];
            acc[6] += w * 0.3779644601f * inp1[7] * in2[11];
            acc[8] += w * 0.3273268423f * inp1[7] * in2[11];
            acc[5] += w * -0.5345224892f * inp1[7] * in2[12];
            acc[4] += w * -0.3273268423f * inp1[7] * in2[13];
            acc[4] += w * 0.4225771204f * inp1[7] * in2[15];
            acc[7] += w * 0.4225771204f * inp1[8] * in2[9];
            acc[6] += w * 0.5976142935f * inp1[8] * in2[10];
            acc[7] += w * -0.3273268423f * inp1[8] * in2[11];
            acc[4] += w * 0.2672612446f * inp1[8] * in2[12];
            acc[5] += w * -0.3273268423f * inp1[8] * in2[13];
            acc[5] += w * -0.4225771204f * inp1[8] * in2[15];
        }
        // Path 23: (2,3)->3
        {
            const float w = weights[23 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[13] += w * -0.2886751401f * inp1[4] * in2[9];
            acc[12] += w * -0.5773502803f * inp1[4] * in2[10];
            acc[13] += w * 0.4472135802f * inp1[4] * in2[11];
            acc[15] += w * 0.2886751401f * inp1[4] * in2[11];
            acc[10] += w * -0.5773502803f * inp1[4] * in2[12];
            acc[9] += w * -0.2886751401f * inp1[4] * in2[13];
            acc[11] += w * 0.4472135802f * inp1[4] * in2[13];
            acc[11] += w * 0.2886751401f * inp1[4] * in2[15];
            acc[14] += w * 0.4564354668f * inp1[5] * in2[9];
            acc[13] += w * 0.3535533840f * inp1[5] * in2[10];
            acc[15] += w * -0.4564354668f * inp1[5] * in2[10];
            acc[12] += w * 0.1825741828f * inp1[5] * in2[11];
            acc[14] += w * -0.3535533840f * inp1[5] * in2[11];
            acc[11] += w * 0.1825741828f * inp1[5] * in2[12];
            acc[10] += w * 0.3535533840f * inp1[5] * in2[13];
            acc[9] += w * 0.4564354668f * inp1[5] * in2[14];
            acc[11] += w * -0.3535533840f * inp1[5] * in2[14];
            acc[10] += w * -0.4564354668f * inp1[5] * in2[15];
            acc[9] += w * -0.6454972118f * inp1[6] * in2[9];
            acc[11] += w * 0.3872983429f * inp1[6] * in2[11];
            acc[12] += w * 0.5163977773f * inp1[6] * in2[12];
            acc[13] += w * 0.3872983429f * inp1[6] * in2[13];
            acc[15] += w * -0.6454972118f * inp1[6] * in2[15];
            acc[10] += w * 0.4564354668f * inp1[7] * in2[9];
            acc[9] += w * 0.4564354668f * inp1[7] * in2[10];
            acc[11] += w * 0.3535533840f * inp1[7] * in2[10];
            acc[10] += w * 0.3535533840f * inp1[7] * in2[11];
            acc[13] += w * 0.1825741828f * inp1[7] * in2[12];
            acc[12] += w * 0.1825741828f * inp1[7] * in2[13];
            acc[14] += w * 0.3535533840f * inp1[7] * in2[13];
            acc[13] += w * 0.3535533840f * inp1[7] * in2[14];
            acc[15] += w * 0.4564354668f * inp1[7] * in2[14];
            acc[14] += w * 0.4564354668f * inp1[7] * in2[15];
            acc[11] += w * -0.2886751401f * inp1[8] * in2[9];
            acc[9] += w * -0.2886751401f * inp1[8] * in2[11];
            acc[11] += w * -0.4472135802f * inp1[8] * in2[11];
            acc[14] += w * -0.5773502803f * inp1[8] * in2[12];
            acc[13] += w * 0.4472135802f * inp1[8] * in2[13];
            acc[15] += w * -0.2886751401f * inp1[8] * in2[13];
            acc[12] += w * -0.5773502803f * inp1[8] * in2[14];
            acc[13] += w * -0.2886751401f * inp1[8] * in2[15];
        }
        // Path 24: (3,0)->3
        {
            const float w = weights[24 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[9] += w * 0.9999999836f * inp1[9] * in2[0];
            acc[10] += w * 0.9999999836f * inp1[10] * in2[0];
            acc[11] += w * 0.9999999836f * inp1[11] * in2[0];
            acc[12] += w * 0.9999999836f * inp1[12] * in2[0];
            acc[13] += w * 0.9999999836f * inp1[13] * in2[0];
            acc[14] += w * 0.9999999836f * inp1[14] * in2[0];
            acc[15] += w * 0.9999999836f * inp1[15] * in2[0];
        }
        // Path 25: (3,1)->2
        {
            const float w = weights[25 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[8] += w * 0.5976142935f * inp1[9] * in2[1];
            acc[4] += w * 0.5976142935f * inp1[9] * in2[3];
            acc[7] += w * 0.4879500459f * inp1[10] * in2[1];
            acc[4] += w * 0.4879500459f * inp1[10] * in2[2];
            acc[5] += w * 0.4879500459f * inp1[10] * in2[3];
            acc[6] += w * 0.5345224892f * inp1[11] * in2[1];
            acc[8] += w * 0.1543033474f * inp1[11] * in2[1];
            acc[5] += w * 0.6172133895f * inp1[11] * in2[2];
            acc[4] += w * -0.1543033474f * inp1[11] * in2[3];
            acc[5] += w * -0.3779644601f * inp1[12] * in2[1];
            acc[6] += w * 0.6546536846f * inp1[12] * in2[2];
            acc[7] += w * -0.3779644601f * inp1[12] * in2[3];
            acc[4] += w * -0.1543033474f * inp1[13] * in2[1];
            acc[7] += w * 0.6172133895f * inp1[13] * in2[2];
            acc[6] += w * 0.5345224892f * inp1[13] * in2[3];
            acc[8] += w * -0.1543033474f * inp1[13] * in2[3];
            acc[5] += w * -0.4879500459f * inp1[14] * in2[1];
            acc[8] += w * 0.4879500459f * inp1[14] * in2[2];
            acc[7] += w * 0.4879500459f * inp1[14] * in2[3];
            acc[4] += w * -0.5976142935f * inp1[15] * in2[1];
            acc[8] += w * 0.5976142935f * inp1[15] * in2[3];
        }
        // Path 26: (3,1)->3
        {
            const float w = weights[26 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[10] += w * 0.3535533840f * inp1[9] * in2[1];
            acc[15] += w * 0.8660254007f * inp1[9] * in2[2];
            acc[14] += w * -0.3535533840f * inp1[9] * in2[3];
            acc[9] += w * -0.3535533840f * inp1[10] * in2[1];
            acc[11] += w * 0.4564354668f * inp1[10] * in2[1];
            acc[14] += w * 0.5773502803f * inp1[10] * in2[2];
            acc[13] += w * -0.4564354668f * inp1[10] * in2[3];
            acc[15] += w * -0.3535533840f * inp1[10] * in2[3];
            acc[10] += w * -0.4564354668f * inp1[11] * in2[1];
            acc[13] += w * 0.2886751401f * inp1[11] * in2[2];
            acc[12] += w * -0.7071067679f * inp1[11] * in2[3];
            acc[14] += w * -0.4564354668f * inp1[11] * in2[3];
            acc[13] += w * -0.7071067679f * inp1[12] * in2[1];
            acc[11] += w * 0.7071067679f * inp1[12] * in2[3];
            acc[12] += w * 0.7071067679f * inp1[13] * in2[1];
            acc[14] += w * -0.4564354668f * inp1[13] * in2[1];
            acc[11] += w * -0.2886751401f * inp1[13] * in2[2];
            acc[10] += w * 0.4564354668f * inp1[13] * in2[3];
            acc[13] += w * 0.4564354668f * inp1[14] * in2[1];
            acc[15] += w * -0.3535533840f * inp1[14] * in2[1];
            acc[10] += w * -0.5773502803f * inp1[14] * in2[2];
            acc[9] += w * 0.3535533840f * inp1[14] * in2[3];
            acc[11] += w * 0.4564354668f * inp1[14] * in2[3];
            acc[14] += w * 0.3535533840f * inp1[15] * in2[1];
            acc[9] += w * -0.8660254007f * inp1[15] * in2[2];
            acc[10] += w * 0.3535533840f * inp1[15] * in2[3];
        }
        // Path 27: (3,2)->1
        {
            const float w = weights[27 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[3] += w * 0.4629100412f * inp1[9] * in2[4];
            acc[1] += w * 0.4629100412f * inp1[9] * in2[8];
            acc[2] += w * 0.3779644803f * inp1[10] * in2[4];
            acc[3] += w * 0.3779644803f * inp1[10] * in2[5];
            acc[1] += w * 0.3779644803f * inp1[10] * in2[7];
            acc[3] += w * -0.1195228589f * inp1[11] * in2[4];
            acc[2] += w * 0.4780914358f * inp1[11] * in2[5];
            acc[1] += w * 0.4140393398f * inp1[11] * in2[6];
            acc[1] += w * 0.1195228589f * inp1[11] * in2[8];
            acc[1] += w * -0.2927700119f * inp1[12] * in2[5];
            acc[2] += w * 0.5070925636f * inp1[12] * in2[6];
            acc[3] += w * -0.2927700119f * inp1[12] * in2[7];
            acc[1] += w * -0.1195228589f * inp1[13] * in2[4];
            acc[3] += w * 0.4140393398f * inp1[13] * in2[6];
            acc[2] += w * 0.4780914358f * inp1[13] * in2[7];
            acc[3] += w * -0.1195228589f * inp1[13] * in2[8];
            acc[1] += w * -0.3779644803f * inp1[14] * in2[5];
            acc[3] += w * 0.3779644803f * inp1[14] * in2[7];
            acc[2] += w * 0.3779644803f * inp1[14] * in2[8];
            acc[1] += w * -0.4629100412f * inp1[15] * in2[4];
            acc[3] += w * 0.4629100412f * inp1[15] * in2[8];
        }
        // Path 28: (3,2)->2
        {
            const float w = weights[28 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[5] += w * 0.4225771204f * inp1[9] * in2[4];
            acc[4] += w * -0.4225771204f * inp1[9] * in2[5];
            acc[8] += w * 0.4225771204f * inp1[9] * in2[7];
            acc[7] += w * -0.4225771204f * inp1[9] * in2[8];
            acc[8] += w * 0.5976142935f * inp1[10] * in2[6];
            acc[6] += w * -0.5976142935f * inp1[10] * in2[8];
            acc[5] += w * 0.3273268423f * inp1[11] * in2[4];
            acc[4] += w * -0.3273268423f * inp1[11] * in2[5];
            acc[7] += w * 0.3779644601f * inp1[11] * in2[6];
            acc[6] += w * -0.3779644601f * inp1[11] * in2[7];
            acc[8] += w * -0.3273268423f * inp1[11] * in2[7];
            acc[7] += w * 0.3273268423f * inp1[11] * in2[8];
            acc[8] += w * 0.2672612446f * inp1[12] * in2[4];
            acc[7] += w * -0.5345224892f * inp1[12] * in2[5];
            acc[5] += w * 0.5345224892f * inp1[12] * in2[7];
            acc[4] += w * -0.2672612446f * inp1[12] * in2[8];
            acc[7] += w * -0.3273268423f * inp1[13] * in2[4];
            acc[6] += w * 0.3779644601f * inp1[13] * in2[5];
            acc[8] += w * -0.3273268423f * inp1[13] * in2[5];
            acc[5] += w * -0.3779644601f * inp1[13] * in2[6];
            acc[4] += w * 0.3273268423f * inp1[13] * in2[7];
            acc[5] += w * 0.3273268423f * inp1[13] * in2[8];
            acc[6] += w * 0.5976142935f * inp1[14] * in2[4];
            acc[4] += w * -0.5976142935f * inp1[14] * in2[6];
            acc[7] += w * 0.4225771204f * inp1[15] * in2[4];
            acc[8] += w * -0.4225771204f * inp1[15] * in2[5];
            acc[4] += w * -0.4225771204f * inp1[15] * in2[7];
            acc[5] += w * 0.4225771204f * inp1[15] * in2[8];
        }
        // Path 29: (3,2)->3
        {
            const float w = weights[29 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[13] += w * -0.2886751401f * inp1[9] * in2[4];
            acc[14] += w * 0.4564354668f * inp1[9] * in2[5];
            acc[9] += w * -0.6454972118f * inp1[9] * in2[6];
            acc[10] += w * 0.4564354668f * inp1[9] * in2[7];
            acc[11] += w * -0.2886751401f * inp1[9] * in2[8];
            acc[12] += w * -0.5773502803f * inp1[10] * in2[4];
            acc[13] += w * 0.3535533840f * inp1[10] * in2[5];
            acc[15] += w * -0.4564354668f * inp1[10] * in2[5];
            acc[9] += w * 0.4564354668f * inp1[10] * in2[7];
            acc[11] += w * 0.3535533840f * inp1[10] * in2[7];
            acc[13] += w * 0.4472135802f * inp1[11] * in2[4];
            acc[15] += w * 0.2886751401f * inp1[11] * in2[4];
            acc[12] += w * 0.1825741828f * inp1[11] * in2[5];
            acc[14] += w * -0.3535533840f * inp1[11] * in2[5];
            acc[11] += w * 0.3872983429f * inp1[11] * in2[6];
            acc[10] += w * 0.3535533840f * inp1[11] * in2[7];
            acc[9] += w * -0.2886751401f * inp1[11] * in2[8];
            acc[11] += w * -0.4472135802f * inp1[11] * in2[8];
            acc[10] += w * -0.5773502803f * inp1[12] * in2[4];
            acc[11] += w * 0.1825741828f * inp1[12] * in2[5];
            acc[12] += w * 0.5163977773f * inp1[12] * in2[6];
            acc[13] += w * 0.1825741828f * inp1[12] * in2[7];
            acc[14] += w * -0.5773502803f * inp1[12] * in2[8];
            acc[9] += w * -0.2886751401f * inp1[13] * in2[4];
            acc[11] += w * 0.4472135802f * inp1[13] * in2[4];
            acc[10] += w * 0.3535533840f * inp1[13] * in2[5];
            acc[13] += w * 0.3872983429f * inp1[13] * in2[6];
            acc[12] += w * 0.1825741828f * inp1[13] * in2[7];
            acc[14] += w * 0.3535533840f * inp1[13] * in2[7];
            acc[13] += w * 0.4472135802f * inp1[13] * in2[8];
            acc[15] += w * -0.2886751401f * inp1[13] * in2[8];
            acc[9] += w * 0.4564354668f * inp1[14] * in2[5];
            acc[11] += w * -0.3535533840f * inp1[14] * in2[5];
            acc[13] += w * 0.3535533840f * inp1[14] * in2[7];
            acc[15] += w * 0.4564354668f * inp1[14] * in2[7];
            acc[12] += w * -0.5773502803f * inp1[14] * in2[8];
            acc[11] += w * 0.2886751401f * inp1[15] * in2[4];
            acc[10] += w * -0.4564354668f * inp1[15] * in2[5];
            acc[15] += w * -0.6454972118f * inp1[15] * in2[6];
            acc[14] += w * 0.4564354668f * inp1[15] * in2[7];
            acc[13] += w * -0.2886751401f * inp1[15] * in2[8];
        }
        // Path 30: (3,3)->0
        {
            const float w = weights[30 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[0] += w * 0.3779644668f * inp1[9] * in2[9];
            acc[0] += w * 0.3779644668f * inp1[10] * in2[10];
            acc[0] += w * 0.3779644668f * inp1[11] * in2[11];
            acc[0] += w * 0.3779644668f * inp1[12] * in2[12];
            acc[0] += w * 0.3779644668f * inp1[13] * in2[13];
            acc[0] += w * 0.3779644668f * inp1[14] * in2[14];
            acc[0] += w * 0.3779644668f * inp1[15] * in2[15];
        }
        // Path 31: (3,3)->1
        {
            const float w = weights[31 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[1] += w * -0.2314550206f * inp1[9] * in2[10];
            acc[3] += w * 0.2314550206f * inp1[9] * in2[14];
            acc[2] += w * -0.5669467075f * inp1[9] * in2[15];
            acc[1] += w * 0.2314550206f * inp1[10] * in2[9];
            acc[1] += w * -0.2988071538f * inp1[10] * in2[11];
            acc[3] += w * 0.2988071538f * inp1[10] * in2[13];
            acc[2] += w * -0.3779644803f * inp1[10] * in2[14];
            acc[3] += w * 0.2314550206f * inp1[10] * in2[15];
            acc[1] += w * 0.2988071538f * inp1[11] * in2[10];
            acc[3] += w * 0.4629100412f * inp1[11] * in2[12];
            acc[2] += w * -0.1889822401f * inp1[11] * in2[13];
            acc[3] += w * 0.2988071538f * inp1[11] * in2[14];
            acc[3] += w * -0.4629100412f * inp1[12] * in2[11];
            acc[1] += w * 0.4629100412f * inp1[12] * in2[13];
            acc[3] += w * -0.2988071538f * inp1[13] * in2[10];
            acc[2] += w * 0.1889822401f * inp1[13] * in2[11];
            acc[1] += w * -0.4629100412f * inp1[13] * in2[12];
            acc[1] += w * 0.2988071538f * inp1[13] * in2[14];
            acc[3] += w * -0.2314550206f * inp1[14] * in2[9];
            acc[2] += w * 0.3779644803f * inp1[14] * in2[10];
            acc[3] += w * -0.2988071538f * inp1[14] * in2[11];
            acc[1] += w * -0.2988071538f * inp1[14] * in2[13];
            acc[1] += w * 0.2314550206f * inp1[14] * in2[15];
            acc[2] += w * 0.5669467075f * inp1[15] * in2[9];
            acc[3] += w * -0.2314550206f * inp1[15] * in2[10];
            acc[1] += w * -0.2314550206f * inp1[15] * in2[14];
        }
        // Path 32: (3,3)->2
        {
            const float w = weights[32 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[6] += w * -0.5455447150f * inp1[9] * in2[9];
            acc[7] += w * 0.3857583768f * inp1[9] * in2[10];
            acc[8] += w * -0.2439750229f * inp1[9] * in2[11];
            acc[4] += w * -0.2439750229f * inp1[9] * in2[13];
            acc[5] += w * 0.3857583768f * inp1[9] * in2[14];
            acc[7] += w * 0.3857583768f * inp1[10] * in2[9];
            acc[7] += w * 0.2988071467f * inp1[10] * in2[11];
            acc[4] += w * -0.4879500459f * inp1[10] * in2[12];
            acc[5] += w * 0.2988071467f * inp1[10] * in2[13];
            acc[5] += w * -0.3857583768f * inp1[10] * in2[15];
            acc[8] += w * -0.2439750229f * inp1[11] * in2[9];
            acc[7] += w * 0.2988071467f * inp1[11] * in2[10];
            acc[6] += w * 0.3273268423f * inp1[11] * in2[11];
            acc[8] += w * -0.3779644601f * inp1[11] * in2[11];
            acc[5] += w * 0.1543033474f * inp1[11] * in2[12];
            acc[4] += w * 0.3779644601f * inp1[11] * in2[13];
            acc[5] += w * -0.2988071467f * inp1[11] * in2[14];
            acc[4] += w * 0.2439750229f * inp1[11] * in2[15];
            acc[4] += w * -0.4879500459f * inp1[12] * in2[10];
            acc[5] += w * 0.1543033474f * inp1[12] * in2[11];
            acc[6] += w * 0.4364357787f * inp1[12] * in2[12];
            acc[7] += w * 0.1543033474f * inp1[12] * in2[13];
            acc[8] += w * -0.4879500459f * inp1[12] * in2[14];
            acc[4] += w * -0.2439750229f * inp1[13] * in2[9];
            acc[5] += w * 0.2988071467f * inp1[13] * in2[10];
            acc[4] += w * 0.3779644601f * inp1[13] * in2[11];
            acc[7] += w * 0.1543033474f * inp1[13] * in2[12];
            acc[6] += w * 0.3273268423f * inp1[13] * in2[13];
            acc[8] += w * 0.3779644601f * inp1[13] * in2[13];
            acc[7] += w * 0.2988071467f * inp1[13] * in2[14];
            acc[8] += w * -0.2439750229f * inp1[13] * in2[15];
            acc[5] += w * 0.3857583768f * inp1[14] * in2[9];
            acc[5] += w * -0.2988071467f * inp1[14] * in2[11];
            acc[8] += w * -0.4879500459f * inp1[14] * in2[12];
            acc[7] += w * 0.2988071467f * inp1[14] * in2[13];
            acc[7] += w * 0.3857583768f * inp1[14] * in2[15];
            acc[5] += w * -0.3857583768f * inp1[15] * in2[10];
            acc[4] += w * 0.2439750229f * inp1[15] * in2[11];
            acc[8] += w * -0.2439750229f * inp1[15] * in2[13];
            acc[7] += w * 0.3857583768f * inp1[15] * in2[14];
            acc[6] += w * -0.5455447150f * inp1[15] * in2[15];
        }
        // Path 33: (3,3)->3
        {
            const float w = weights[33 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[11] += w * 0.4082483091f * inp1[9] * in2[10];
            acc[10] += w * -0.4082483091f * inp1[9] * in2[11];
            acc[15] += w * -0.4082483091f * inp1[9] * in2[12];
            acc[14] += w * 0.4082483091f * inp1[9] * in2[13];
            acc[13] += w * -0.4082483091f * inp1[9] * in2[14];
            acc[12] += w * 0.4082483091f * inp1[9] * in2[15];
            acc[11] += w * -0.4082483091f * inp1[10] * in2[9];
            acc[9] += w * 0.4082483091f * inp1[10] * in2[11];
            acc[14] += w * 0.4082483091f * inp1[10] * in2[12];
            acc[15] += w * 0.4082483091f * inp1[10] * in2[13];
            acc[12] += w * -0.4082483091f * inp1[10] * in2[14];
            acc[13] += w * -0.4082483091f * inp1[10] * in2[15];
            acc[10] += w * 0.4082483091f * inp1[11] * in2[9];
            acc[9] += w * -0.4082483091f * inp1[11] * in2[10];
            acc[13] += w * 0.4082483091f * inp1[11] * in2[12];
            acc[12] += w * -0.4082483091f * inp1[11] * in2[13];
            acc[15] += w * -0.4082483091f * inp1[11] * in2[14];
            acc[14] += w * 0.4082483091f * inp1[11] * in2[15];
            acc[15] += w * 0.4082483091f * inp1[12] * in2[9];
            acc[14] += w * -0.4082483091f * inp1[12] * in2[10];
            acc[13] += w * -0.4082483091f * inp1[12] * in2[11];
            acc[11] += w * 0.4082483091f * inp1[12] * in2[13];
            acc[10] += w * 0.4082483091f * inp1[12] * in2[14];
            acc[9] += w * -0.4082483091f * inp1[12] * in2[15];
            acc[14] += w * -0.4082483091f * inp1[13] * in2[9];
            acc[15] += w * -0.4082483091f * inp1[13] * in2[10];
            acc[12] += w * 0.4082483091f * inp1[13] * in2[11];
            acc[11] += w * -0.4082483091f * inp1[13] * in2[12];
            acc[9] += w * 0.4082483091f * inp1[13] * in2[14];
            acc[10] += w * 0.4082483091f * inp1[13] * in2[15];
            acc[13] += w * 0.4082483091f * inp1[14] * in2[9];
            acc[12] += w * 0.4082483091f * inp1[14] * in2[10];
            acc[15] += w * 0.4082483091f * inp1[14] * in2[11];
            acc[10] += w * -0.4082483091f * inp1[14] * in2[12];
            acc[9] += w * -0.4082483091f * inp1[14] * in2[13];
            acc[11] += w * -0.4082483091f * inp1[14] * in2[15];
            acc[12] += w * -0.4082483091f * inp1[15] * in2[9];
            acc[13] += w * 0.4082483091f * inp1[15] * in2[10];
            acc[14] += w * -0.4082483091f * inp1[15] * in2[11];
            acc[9] += w * 0.4082483091f * inp1[15] * in2[12];
            acc[10] += w * -0.4082483091f * inp1[15] * in2[13];
            acc[11] += w * 0.4082483091f * inp1[15] * in2[14];
        }
    }

    #pragma unroll
    for (int i = 0; i < 16; i++) {
        out[i] = acc[i];
    }
}

// =========================================================================
// BACKWARD PASS - Fused implementations
// =========================================================================

// Simple tensor product backward: computes grad_in1 and grad_in2
// For forward: out[m_out] += cg * in1[m1] * in2[m2]
// Backward: grad_in1[m1] += cg * grad_out[m_out] * in2[m2]
//           grad_in2[m2] += cg * grad_out[m_out] * in1[m1]
__device__ __forceinline__ void tensor_product_simple_backward_unrolled(
    const float* __restrict__ in1,
    const float* __restrict__ in2,
    const float* __restrict__ grad_out,
    float* __restrict__ grad_in1,
    float* __restrict__ grad_in2
) {
    // Path 0: (0,0)->0, 1 entries
    grad_in1[0] += 1.0000000000f * grad_out[0] * in2[0];
    grad_in2[0] += 1.0000000000f * grad_out[0] * in1[0];

    // Path 1: (0,1)->1, 3 entries
    grad_in1[0] += 0.9999999821f * grad_out[1] * in2[1];
    grad_in2[1] += 0.9999999821f * grad_out[1] * in1[0];
    grad_in1[0] += 0.9999999821f * grad_out[2] * in2[2];
    grad_in2[2] += 0.9999999821f * grad_out[2] * in1[0];
    grad_in1[0] += 0.9999999821f * grad_out[3] * in2[3];
    grad_in2[3] += 0.9999999821f * grad_out[3] * in1[0];

    // Path 2: (0,2)->2, 5 entries
    grad_in1[0] += 0.9999999880f * grad_out[4] * in2[4];
    grad_in2[4] += 0.9999999880f * grad_out[4] * in1[0];
    grad_in1[0] += 0.9999999880f * grad_out[5] * in2[5];
    grad_in2[5] += 0.9999999880f * grad_out[5] * in1[0];
    grad_in1[0] += 0.9999999880f * grad_out[6] * in2[6];
    grad_in2[6] += 0.9999999880f * grad_out[6] * in1[0];
    grad_in1[0] += 0.9999999880f * grad_out[7] * in2[7];
    grad_in2[7] += 0.9999999880f * grad_out[7] * in1[0];
    grad_in1[0] += 0.9999999880f * grad_out[8] * in2[8];
    grad_in2[8] += 0.9999999880f * grad_out[8] * in1[0];

    // Path 3: (0,3)->3, 7 entries
    grad_in1[0] += 0.9999999836f * grad_out[9] * in2[9];
    grad_in2[9] += 0.9999999836f * grad_out[9] * in1[0];
    grad_in1[0] += 0.9999999836f * grad_out[10] * in2[10];
    grad_in2[10] += 0.9999999836f * grad_out[10] * in1[0];
    grad_in1[0] += 0.9999999836f * grad_out[11] * in2[11];
    grad_in2[11] += 0.9999999836f * grad_out[11] * in1[0];
    grad_in1[0] += 0.9999999836f * grad_out[12] * in2[12];
    grad_in2[12] += 0.9999999836f * grad_out[12] * in1[0];
    grad_in1[0] += 0.9999999836f * grad_out[13] * in2[13];
    grad_in2[13] += 0.9999999836f * grad_out[13] * in1[0];
    grad_in1[0] += 0.9999999836f * grad_out[14] * in2[14];
    grad_in2[14] += 0.9999999836f * grad_out[14] * in1[0];
    grad_in1[0] += 0.9999999836f * grad_out[15] * in2[15];
    grad_in2[15] += 0.9999999836f * grad_out[15] * in1[0];

    // Path 4: (1,0)->1, 3 entries
    grad_in1[1] += 0.9999999821f * grad_out[1] * in2[0];
    grad_in2[0] += 0.9999999821f * grad_out[1] * in1[1];
    grad_in1[2] += 0.9999999821f * grad_out[2] * in2[0];
    grad_in2[0] += 0.9999999821f * grad_out[2] * in1[2];
    grad_in1[3] += 0.9999999821f * grad_out[3] * in2[0];
    grad_in2[0] += 0.9999999821f * grad_out[3] * in1[3];

    // Path 5: (1,1)->0, 3 entries
    grad_in1[1] += 0.5773502588f * grad_out[0] * in2[1];
    grad_in2[1] += 0.5773502588f * grad_out[0] * in1[1];
    grad_in1[2] += 0.5773502588f * grad_out[0] * in2[2];
    grad_in2[2] += 0.5773502588f * grad_out[0] * in1[2];
    grad_in1[3] += 0.5773502588f * grad_out[0] * in2[3];
    grad_in2[3] += 0.5773502588f * grad_out[0] * in1[3];

    // Path 6: (1,1)->1, 6 entries
    grad_in1[1] += 0.7071068069f * grad_out[3] * in2[2];
    grad_in2[2] += 0.7071068069f * grad_out[3] * in1[1];
    grad_in1[1] += -0.7071068069f * grad_out[2] * in2[3];
    grad_in2[3] += -0.7071068069f * grad_out[2] * in1[1];
    grad_in1[2] += -0.7071068069f * grad_out[3] * in2[1];
    grad_in2[1] += -0.7071068069f * grad_out[3] * in1[2];
    grad_in1[2] += 0.7071068069f * grad_out[1] * in2[3];
    grad_in2[3] += 0.7071068069f * grad_out[1] * in1[2];
    grad_in1[3] += 0.7071068069f * grad_out[2] * in2[1];
    grad_in2[1] += 0.7071068069f * grad_out[2] * in1[3];
    grad_in1[3] += -0.7071068069f * grad_out[1] * in2[2];
    grad_in2[2] += -0.7071068069f * grad_out[1] * in1[3];

    // Path 7: (1,1)->2, 11 entries
    grad_in1[1] += -0.4082482836f * grad_out[6] * in2[1];
    grad_in2[1] += -0.4082482836f * grad_out[6] * in1[1];
    grad_in1[1] += -0.7071067764f * grad_out[8] * in2[1];
    grad_in2[1] += -0.7071067764f * grad_out[8] * in1[1];
    grad_in1[1] += 0.7071067764f * grad_out[5] * in2[2];
    grad_in2[2] += 0.7071067764f * grad_out[5] * in1[1];
    grad_in1[1] += 0.7071067764f * grad_out[4] * in2[3];
    grad_in2[3] += 0.7071067764f * grad_out[4] * in1[1];
    grad_in1[2] += 0.7071067764f * grad_out[5] * in2[1];
    grad_in2[1] += 0.7071067764f * grad_out[5] * in1[2];
    grad_in1[2] += 0.8164965671f * grad_out[6] * in2[2];
    grad_in2[2] += 0.8164965671f * grad_out[6] * in1[2];
    grad_in1[2] += 0.7071067764f * grad_out[7] * in2[3];
    grad_in2[3] += 0.7071067764f * grad_out[7] * in1[2];
    grad_in1[3] += 0.7071067764f * grad_out[4] * in2[1];
    grad_in2[1] += 0.7071067764f * grad_out[4] * in1[3];
    grad_in1[3] += 0.7071067764f * grad_out[7] * in2[2];
    grad_in2[2] += 0.7071067764f * grad_out[7] * in1[3];
    grad_in1[3] += -0.4082482836f * grad_out[6] * in2[3];
    grad_in2[3] += -0.4082482836f * grad_out[6] * in1[3];
    grad_in1[3] += 0.7071067764f * grad_out[8] * in2[3];
    grad_in2[3] += 0.7071067764f * grad_out[8] * in1[3];

    // Path 8: (1,2)->1, 11 entries
    grad_in1[1] += 0.5477225538f * grad_out[3] * in2[4];
    grad_in2[4] += 0.5477225538f * grad_out[3] * in1[1];
    grad_in1[1] += 0.5477225538f * grad_out[2] * in2[5];
    grad_in2[5] += 0.5477225538f * grad_out[2] * in1[1];
    grad_in1[1] += -0.3162277607f * grad_out[1] * in2[6];
    grad_in2[6] += -0.3162277607f * grad_out[1] * in1[1];
    grad_in1[1] += -0.5477225538f * grad_out[1] * in2[8];
    grad_in2[8] += -0.5477225538f * grad_out[1] * in1[1];
    grad_in1[2] += 0.5477225538f * grad_out[1] * in2[5];
    grad_in2[5] += 0.5477225538f * grad_out[1] * in1[2];
    grad_in1[2] += 0.6324555213f * grad_out[2] * in2[6];
    grad_in2[6] += 0.6324555213f * grad_out[2] * in1[2];
    grad_in1[2] += 0.5477225538f * grad_out[3] * in2[7];
    grad_in2[7] += 0.5477225538f * grad_out[3] * in1[2];
    grad_in1[3] += 0.5477225538f * grad_out[1] * in2[4];
    grad_in2[4] += 0.5477225538f * grad_out[1] * in1[3];
    grad_in1[3] += -0.3162277607f * grad_out[3] * in2[6];
    grad_in2[6] += -0.3162277607f * grad_out[3] * in1[3];
    grad_in1[3] += 0.5477225538f * grad_out[2] * in2[7];
    grad_in2[7] += 0.5477225538f * grad_out[2] * in1[3];
    grad_in1[3] += 0.5477225538f * grad_out[3] * in2[8];
    grad_in2[8] += 0.5477225538f * grad_out[3] * in1[3];

    // Path 9: (1,2)->2, 16 entries
    grad_in1[1] += -0.4082482836f * grad_out[5] * in2[4];
    grad_in2[4] += -0.4082482836f * grad_out[5] * in1[1];
    grad_in1[1] += 0.4082482836f * grad_out[4] * in2[5];
    grad_in2[5] += 0.4082482836f * grad_out[4] * in1[1];
    grad_in1[1] += 0.7071067764f * grad_out[7] * in2[6];
    grad_in2[6] += 0.7071067764f * grad_out[7] * in1[1];
    grad_in1[1] += -0.7071067764f * grad_out[6] * in2[7];
    grad_in2[7] += -0.7071067764f * grad_out[6] * in1[1];
    grad_in1[1] += 0.4082482836f * grad_out[8] * in2[7];
    grad_in2[7] += 0.4082482836f * grad_out[8] * in1[1];
    grad_in1[1] += -0.4082482836f * grad_out[7] * in2[8];
    grad_in2[8] += -0.4082482836f * grad_out[7] * in1[1];
    grad_in1[2] += -0.8164965671f * grad_out[8] * in2[4];
    grad_in2[4] += -0.8164965671f * grad_out[8] * in1[2];
    grad_in1[2] += -0.4082482836f * grad_out[7] * in2[5];
    grad_in2[5] += -0.4082482836f * grad_out[7] * in1[2];
    grad_in1[2] += 0.4082482836f * grad_out[5] * in2[7];
    grad_in2[7] += 0.4082482836f * grad_out[5] * in1[2];
    grad_in1[2] += 0.8164965671f * grad_out[4] * in2[8];
    grad_in2[8] += 0.8164965671f * grad_out[4] * in1[2];
    grad_in1[3] += 0.4082482836f * grad_out[7] * in2[4];
    grad_in2[4] += 0.4082482836f * grad_out[7] * in1[3];
    grad_in1[3] += 0.7071067764f * grad_out[6] * in2[5];
    grad_in2[5] += 0.7071067764f * grad_out[6] * in1[3];
    grad_in1[3] += 0.4082482836f * grad_out[8] * in2[5];
    grad_in2[5] += 0.4082482836f * grad_out[8] * in1[3];
    grad_in1[3] += -0.7071067764f * grad_out[5] * in2[6];
    grad_in2[6] += -0.7071067764f * grad_out[5] * in1[3];
    grad_in1[3] += -0.4082482836f * grad_out[4] * in2[7];
    grad_in2[7] += -0.4082482836f * grad_out[4] * in1[3];
    grad_in1[3] += -0.4082482836f * grad_out[5] * in2[8];
    grad_in2[8] += -0.4082482836f * grad_out[5] * in1[3];

    // Path 10: (1,2)->3, 21 entries
    grad_in1[1] += -0.1825741828f * grad_out[13] * in2[4];
    grad_in2[4] += -0.1825741828f * grad_out[13] * in1[1];
    grad_in1[1] += -0.7071067679f * grad_out[15] * in2[4];
    grad_in2[4] += -0.7071067679f * grad_out[15] * in1[1];
    grad_in1[1] += -0.4472135802f * grad_out[12] * in2[5];
    grad_in2[5] += -0.4472135802f * grad_out[12] * in1[1];
    grad_in1[1] += -0.5773502803f * grad_out[14] * in2[5];
    grad_in2[5] += -0.5773502803f * grad_out[14] * in1[1];
    grad_in1[1] += 0.6324555384f * grad_out[11] * in2[6];
    grad_in2[6] += 0.6324555384f * grad_out[11] * in1[1];
    grad_in1[1] += 0.5773502803f * grad_out[10] * in2[7];
    grad_in2[7] += 0.5773502803f * grad_out[10] * in1[1];
    grad_in1[1] += 0.7071067679f * grad_out[9] * in2[8];
    grad_in2[8] += 0.7071067679f * grad_out[9] * in1[1];
    grad_in1[1] += 0.1825741828f * grad_out[11] * in2[8];
    grad_in2[8] += 0.1825741828f * grad_out[11] * in1[1];
    grad_in1[2] += 0.5773502803f * grad_out[10] * in2[4];
    grad_in2[4] += 0.5773502803f * grad_out[10] * in1[2];
    grad_in1[2] += 0.7302967312f * grad_out[11] * in2[5];
    grad_in2[5] += 0.7302967312f * grad_out[11] * in1[2];
    grad_in1[2] += 0.7745966857f * grad_out[12] * in2[6];
    grad_in2[6] += 0.7745966857f * grad_out[12] * in1[2];
    grad_in1[2] += 0.7302967312f * grad_out[13] * in2[7];
    grad_in2[7] += 0.7302967312f * grad_out[13] * in1[2];
    grad_in1[2] += 0.5773502803f * grad_out[14] * in2[8];
    grad_in2[8] += 0.5773502803f * grad_out[14] * in1[2];
    grad_in1[3] += 0.7071067679f * grad_out[9] * in2[4];
    grad_in2[4] += 0.7071067679f * grad_out[9] * in1[3];
    grad_in1[3] += -0.1825741828f * grad_out[11] * in2[4];
    grad_in2[4] += -0.1825741828f * grad_out[11] * in1[3];
    grad_in1[3] += 0.5773502803f * grad_out[10] * in2[5];
    grad_in2[5] += 0.5773502803f * grad_out[10] * in1[3];
    grad_in1[3] += 0.6324555384f * grad_out[13] * in2[6];
    grad_in2[6] += 0.6324555384f * grad_out[13] * in1[3];
    grad_in1[3] += -0.4472135802f * grad_out[12] * in2[7];
    grad_in2[7] += -0.4472135802f * grad_out[12] * in1[3];
    grad_in1[3] += 0.5773502803f * grad_out[14] * in2[7];
    grad_in2[7] += 0.5773502803f * grad_out[14] * in1[3];
    grad_in1[3] += -0.1825741828f * grad_out[13] * in2[8];
    grad_in2[8] += -0.1825741828f * grad_out[13] * in1[3];
    grad_in1[3] += 0.7071067679f * grad_out[15] * in2[8];
    grad_in2[8] += 0.7071067679f * grad_out[15] * in1[3];

    // Path 11: (1,3)->2, 21 entries
    grad_in1[1] += 0.5976142935f * grad_out[8] * in2[9];
    grad_in2[9] += 0.5976142935f * grad_out[8] * in1[1];
    grad_in1[1] += 0.4879500459f * grad_out[7] * in2[10];
    grad_in2[10] += 0.4879500459f * grad_out[7] * in1[1];
    grad_in1[1] += 0.5345224892f * grad_out[6] * in2[11];
    grad_in2[11] += 0.5345224892f * grad_out[6] * in1[1];
    grad_in1[1] += 0.1543033474f * grad_out[8] * in2[11];
    grad_in2[11] += 0.1543033474f * grad_out[8] * in1[1];
    grad_in1[1] += -0.3779644601f * grad_out[5] * in2[12];
    grad_in2[12] += -0.3779644601f * grad_out[5] * in1[1];
    grad_in1[1] += -0.1543033474f * grad_out[4] * in2[13];
    grad_in2[13] += -0.1543033474f * grad_out[4] * in1[1];
    grad_in1[1] += -0.4879500459f * grad_out[5] * in2[14];
    grad_in2[14] += -0.4879500459f * grad_out[5] * in1[1];
    grad_in1[1] += -0.5976142935f * grad_out[4] * in2[15];
    grad_in2[15] += -0.5976142935f * grad_out[4] * in1[1];
    grad_in1[2] += 0.4879500459f * grad_out[4] * in2[10];
    grad_in2[10] += 0.4879500459f * grad_out[4] * in1[2];
    grad_in1[2] += 0.6172133895f * grad_out[5] * in2[11];
    grad_in2[11] += 0.6172133895f * grad_out[5] * in1[2];
    grad_in1[2] += 0.6546536846f * grad_out[6] * in2[12];
    grad_in2[12] += 0.6546536846f * grad_out[6] * in1[2];
    grad_in1[2] += 0.6172133895f * grad_out[7] * in2[13];
    grad_in2[13] += 0.6172133895f * grad_out[7] * in1[2];
    grad_in1[2] += 0.4879500459f * grad_out[8] * in2[14];
    grad_in2[14] += 0.4879500459f * grad_out[8] * in1[2];
    grad_in1[3] += 0.5976142935f * grad_out[4] * in2[9];
    grad_in2[9] += 0.5976142935f * grad_out[4] * in1[3];
    grad_in1[3] += 0.4879500459f * grad_out[5] * in2[10];
    grad_in2[10] += 0.4879500459f * grad_out[5] * in1[3];
    grad_in1[3] += -0.1543033474f * grad_out[4] * in2[11];
    grad_in2[11] += -0.1543033474f * grad_out[4] * in1[3];
    grad_in1[3] += -0.3779644601f * grad_out[7] * in2[12];
    grad_in2[12] += -0.3779644601f * grad_out[7] * in1[3];
    grad_in1[3] += 0.5345224892f * grad_out[6] * in2[13];
    grad_in2[13] += 0.5345224892f * grad_out[6] * in1[3];
    grad_in1[3] += -0.1543033474f * grad_out[8] * in2[13];
    grad_in2[13] += -0.1543033474f * grad_out[8] * in1[3];
    grad_in1[3] += 0.4879500459f * grad_out[7] * in2[14];
    grad_in2[14] += 0.4879500459f * grad_out[7] * in1[3];
    grad_in1[3] += 0.5976142935f * grad_out[8] * in2[15];
    grad_in2[15] += 0.5976142935f * grad_out[8] * in1[3];

    // Path 12: (1,3)->3, 26 entries
    grad_in1[1] += -0.3535533840f * grad_out[10] * in2[9];
    grad_in2[9] += -0.3535533840f * grad_out[10] * in1[1];
    grad_in1[1] += 0.3535533840f * grad_out[9] * in2[10];
    grad_in2[10] += 0.3535533840f * grad_out[9] * in1[1];
    grad_in1[1] += -0.4564354668f * grad_out[11] * in2[10];
    grad_in2[10] += -0.4564354668f * grad_out[11] * in1[1];
    grad_in1[1] += 0.4564354668f * grad_out[10] * in2[11];
    grad_in2[11] += 0.4564354668f * grad_out[10] * in1[1];
    grad_in1[1] += 0.7071067679f * grad_out[13] * in2[12];
    grad_in2[12] += 0.7071067679f * grad_out[13] * in1[1];
    grad_in1[1] += -0.7071067679f * grad_out[12] * in2[13];
    grad_in2[13] += -0.7071067679f * grad_out[12] * in1[1];
    grad_in1[1] += 0.4564354668f * grad_out[14] * in2[13];
    grad_in2[13] += 0.4564354668f * grad_out[14] * in1[1];
    grad_in1[1] += -0.4564354668f * grad_out[13] * in2[14];
    grad_in2[14] += -0.4564354668f * grad_out[13] * in1[1];
    grad_in1[1] += 0.3535533840f * grad_out[15] * in2[14];
    grad_in2[14] += 0.3535533840f * grad_out[15] * in1[1];
    grad_in1[1] += -0.3535533840f * grad_out[14] * in2[15];
    grad_in2[15] += -0.3535533840f * grad_out[14] * in1[1];
    grad_in1[2] += -0.8660254007f * grad_out[15] * in2[9];
    grad_in2[9] += -0.8660254007f * grad_out[15] * in1[2];
    grad_in1[2] += -0.5773502803f * grad_out[14] * in2[10];
    grad_in2[10] += -0.5773502803f * grad_out[14] * in1[2];
    grad_in1[2] += -0.2886751401f * grad_out[13] * in2[11];
    grad_in2[11] += -0.2886751401f * grad_out[13] * in1[2];
    grad_in1[2] += 0.2886751401f * grad_out[11] * in2[13];
    grad_in2[13] += 0.2886751401f * grad_out[11] * in1[2];
    grad_in1[2] += 0.5773502803f * grad_out[10] * in2[14];
    grad_in2[14] += 0.5773502803f * grad_out[10] * in1[2];
    grad_in1[2] += 0.8660254007f * grad_out[9] * in2[15];
    grad_in2[15] += 0.8660254007f * grad_out[9] * in1[2];
    grad_in1[3] += 0.3535533840f * grad_out[14] * in2[9];
    grad_in2[9] += 0.3535533840f * grad_out[14] * in1[3];
    grad_in1[3] += 0.4564354668f * grad_out[13] * in2[10];
    grad_in2[10] += 0.4564354668f * grad_out[13] * in1[3];
    grad_in1[3] += 0.3535533840f * grad_out[15] * in2[10];
    grad_in2[10] += 0.3535533840f * grad_out[15] * in1[3];
    grad_in1[3] += 0.7071067679f * grad_out[12] * in2[11];
    grad_in2[11] += 0.7071067679f * grad_out[12] * in1[3];
    grad_in1[3] += 0.4564354668f * grad_out[14] * in2[11];
    grad_in2[11] += 0.4564354668f * grad_out[14] * in1[3];
    grad_in1[3] += -0.7071067679f * grad_out[11] * in2[12];
    grad_in2[12] += -0.7071067679f * grad_out[11] * in1[3];
    grad_in1[3] += -0.4564354668f * grad_out[10] * in2[13];
    grad_in2[13] += -0.4564354668f * grad_out[10] * in1[3];
    grad_in1[3] += -0.3535533840f * grad_out[9] * in2[14];
    grad_in2[14] += -0.3535533840f * grad_out[9] * in1[3];
    grad_in1[3] += -0.4564354668f * grad_out[11] * in2[14];
    grad_in2[14] += -0.4564354668f * grad_out[11] * in1[3];
    grad_in1[3] += -0.3535533840f * grad_out[10] * in2[15];
    grad_in2[15] += -0.3535533840f * grad_out[10] * in1[3];

    // Path 13: (2,0)->2, 5 entries
    grad_in1[4] += 0.9999999880f * grad_out[4] * in2[0];
    grad_in2[0] += 0.9999999880f * grad_out[4] * in1[4];
    grad_in1[5] += 0.9999999880f * grad_out[5] * in2[0];
    grad_in2[0] += 0.9999999880f * grad_out[5] * in1[5];
    grad_in1[6] += 0.9999999880f * grad_out[6] * in2[0];
    grad_in2[0] += 0.9999999880f * grad_out[6] * in1[6];
    grad_in1[7] += 0.9999999880f * grad_out[7] * in2[0];
    grad_in2[0] += 0.9999999880f * grad_out[7] * in1[7];
    grad_in1[8] += 0.9999999880f * grad_out[8] * in2[0];
    grad_in2[0] += 0.9999999880f * grad_out[8] * in1[8];

    // Path 14: (2,1)->1, 11 entries
    grad_in1[4] += 0.5477225538f * grad_out[3] * in2[1];
    grad_in2[1] += 0.5477225538f * grad_out[3] * in1[4];
    grad_in1[4] += 0.5477225538f * grad_out[1] * in2[3];
    grad_in2[3] += 0.5477225538f * grad_out[1] * in1[4];
    grad_in1[5] += 0.5477225538f * grad_out[2] * in2[1];
    grad_in2[1] += 0.5477225538f * grad_out[2] * in1[5];
    grad_in1[5] += 0.5477225538f * grad_out[1] * in2[2];
    grad_in2[2] += 0.5477225538f * grad_out[1] * in1[5];
    grad_in1[6] += -0.3162277607f * grad_out[1] * in2[1];
    grad_in2[1] += -0.3162277607f * grad_out[1] * in1[6];
    grad_in1[6] += 0.6324555213f * grad_out[2] * in2[2];
    grad_in2[2] += 0.6324555213f * grad_out[2] * in1[6];
    grad_in1[6] += -0.3162277607f * grad_out[3] * in2[3];
    grad_in2[3] += -0.3162277607f * grad_out[3] * in1[6];
    grad_in1[7] += 0.5477225538f * grad_out[3] * in2[2];
    grad_in2[2] += 0.5477225538f * grad_out[3] * in1[7];
    grad_in1[7] += 0.5477225538f * grad_out[2] * in2[3];
    grad_in2[3] += 0.5477225538f * grad_out[2] * in1[7];
    grad_in1[8] += -0.5477225538f * grad_out[1] * in2[1];
    grad_in2[1] += -0.5477225538f * grad_out[1] * in1[8];
    grad_in1[8] += 0.5477225538f * grad_out[3] * in2[3];
    grad_in2[3] += 0.5477225538f * grad_out[3] * in1[8];

    // Path 15: (2,1)->2, 16 entries
    grad_in1[4] += 0.4082482836f * grad_out[5] * in2[1];
    grad_in2[1] += 0.4082482836f * grad_out[5] * in1[4];
    grad_in1[4] += 0.8164965671f * grad_out[8] * in2[2];
    grad_in2[2] += 0.8164965671f * grad_out[8] * in1[4];
    grad_in1[4] += -0.4082482836f * grad_out[7] * in2[3];
    grad_in2[3] += -0.4082482836f * grad_out[7] * in1[4];
    grad_in1[5] += -0.4082482836f * grad_out[4] * in2[1];
    grad_in2[1] += -0.4082482836f * grad_out[4] * in1[5];
    grad_in1[5] += 0.4082482836f * grad_out[7] * in2[2];
    grad_in2[2] += 0.4082482836f * grad_out[7] * in1[5];
    grad_in1[5] += -0.7071067764f * grad_out[6] * in2[3];
    grad_in2[3] += -0.7071067764f * grad_out[6] * in1[5];
    grad_in1[5] += -0.4082482836f * grad_out[8] * in2[3];
    grad_in2[3] += -0.4082482836f * grad_out[8] * in1[5];
    grad_in1[6] += -0.7071067764f * grad_out[7] * in2[1];
    grad_in2[1] += -0.7071067764f * grad_out[7] * in1[6];
    grad_in1[6] += 0.7071067764f * grad_out[5] * in2[3];
    grad_in2[3] += 0.7071067764f * grad_out[5] * in1[6];
    grad_in1[7] += 0.7071067764f * grad_out[6] * in2[1];
    grad_in2[1] += 0.7071067764f * grad_out[6] * in1[7];
    grad_in1[7] += -0.4082482836f * grad_out[8] * in2[1];
    grad_in2[1] += -0.4082482836f * grad_out[8] * in1[7];
    grad_in1[7] += -0.4082482836f * grad_out[5] * in2[2];
    grad_in2[2] += -0.4082482836f * grad_out[5] * in1[7];
    grad_in1[7] += 0.4082482836f * grad_out[4] * in2[3];
    grad_in2[3] += 0.4082482836f * grad_out[4] * in1[7];
    grad_in1[8] += 0.4082482836f * grad_out[7] * in2[1];
    grad_in2[1] += 0.4082482836f * grad_out[7] * in1[8];
    grad_in1[8] += -0.8164965671f * grad_out[4] * in2[2];
    grad_in2[2] += -0.8164965671f * grad_out[4] * in1[8];
    grad_in1[8] += 0.4082482836f * grad_out[5] * in2[3];
    grad_in2[3] += 0.4082482836f * grad_out[5] * in1[8];

    // Path 16: (2,1)->3, 21 entries
    grad_in1[4] += -0.1825741828f * grad_out[13] * in2[1];
    grad_in2[1] += -0.1825741828f * grad_out[13] * in1[4];
    grad_in1[4] += -0.7071067679f * grad_out[15] * in2[1];
    grad_in2[1] += -0.7071067679f * grad_out[15] * in1[4];
    grad_in1[4] += 0.5773502803f * grad_out[10] * in2[2];
    grad_in2[2] += 0.5773502803f * grad_out[10] * in1[4];
    grad_in1[4] += 0.7071067679f * grad_out[9] * in2[3];
    grad_in2[3] += 0.7071067679f * grad_out[9] * in1[4];
    grad_in1[4] += -0.1825741828f * grad_out[11] * in2[3];
    grad_in2[3] += -0.1825741828f * grad_out[11] * in1[4];
    grad_in1[5] += -0.4472135802f * grad_out[12] * in2[1];
    grad_in2[1] += -0.4472135802f * grad_out[12] * in1[5];
    grad_in1[5] += -0.5773502803f * grad_out[14] * in2[1];
    grad_in2[1] += -0.5773502803f * grad_out[14] * in1[5];
    grad_in1[5] += 0.7302967312f * grad_out[11] * in2[2];
    grad_in2[2] += 0.7302967312f * grad_out[11] * in1[5];
    grad_in1[5] += 0.5773502803f * grad_out[10] * in2[3];
    grad_in2[3] += 0.5773502803f * grad_out[10] * in1[5];
    grad_in1[6] += 0.6324555384f * grad_out[11] * in2[1];
    grad_in2[1] += 0.6324555384f * grad_out[11] * in1[6];
    grad_in1[6] += 0.7745966857f * grad_out[12] * in2[2];
    grad_in2[2] += 0.7745966857f * grad_out[12] * in1[6];
    grad_in1[6] += 0.6324555384f * grad_out[13] * in2[3];
    grad_in2[3] += 0.6324555384f * grad_out[13] * in1[6];
    grad_in1[7] += 0.5773502803f * grad_out[10] * in2[1];
    grad_in2[1] += 0.5773502803f * grad_out[10] * in1[7];
    grad_in1[7] += 0.7302967312f * grad_out[13] * in2[2];
    grad_in2[2] += 0.7302967312f * grad_out[13] * in1[7];
    grad_in1[7] += -0.4472135802f * grad_out[12] * in2[3];
    grad_in2[3] += -0.4472135802f * grad_out[12] * in1[7];
    grad_in1[7] += 0.5773502803f * grad_out[14] * in2[3];
    grad_in2[3] += 0.5773502803f * grad_out[14] * in1[7];
    grad_in1[8] += 0.7071067679f * grad_out[9] * in2[1];
    grad_in2[1] += 0.7071067679f * grad_out[9] * in1[8];
    grad_in1[8] += 0.1825741828f * grad_out[11] * in2[1];
    grad_in2[1] += 0.1825741828f * grad_out[11] * in1[8];
    grad_in1[8] += 0.5773502803f * grad_out[14] * in2[2];
    grad_in2[2] += 0.5773502803f * grad_out[14] * in1[8];
    grad_in1[8] += -0.1825741828f * grad_out[13] * in2[3];
    grad_in2[3] += -0.1825741828f * grad_out[13] * in1[8];
    grad_in1[8] += 0.7071067679f * grad_out[15] * in2[3];
    grad_in2[3] += 0.7071067679f * grad_out[15] * in1[8];

    // Path 17: (2,2)->0, 5 entries
    grad_in1[4] += 0.4472135901f * grad_out[0] * in2[4];
    grad_in2[4] += 0.4472135901f * grad_out[0] * in1[4];
    grad_in1[5] += 0.4472135901f * grad_out[0] * in2[5];
    grad_in2[5] += 0.4472135901f * grad_out[0] * in1[5];
    grad_in1[6] += 0.4472135901f * grad_out[0] * in2[6];
    grad_in2[6] += 0.4472135901f * grad_out[0] * in1[6];
    grad_in1[7] += 0.4472135901f * grad_out[0] * in2[7];
    grad_in2[7] += 0.4472135901f * grad_out[0] * in1[7];
    grad_in1[8] += 0.4472135901f * grad_out[0] * in2[8];
    grad_in2[8] += 0.4472135901f * grad_out[0] * in1[8];

    // Path 18: (2,2)->1, 16 entries
    grad_in1[4] += -0.3162277607f * grad_out[1] * in2[5];
    grad_in2[5] += -0.3162277607f * grad_out[1] * in1[4];
    grad_in1[4] += 0.3162277607f * grad_out[3] * in2[7];
    grad_in2[7] += 0.3162277607f * grad_out[3] * in1[4];
    grad_in1[4] += -0.6324555213f * grad_out[2] * in2[8];
    grad_in2[8] += -0.6324555213f * grad_out[2] * in1[4];
    grad_in1[5] += 0.3162277607f * grad_out[1] * in2[4];
    grad_in2[4] += 0.3162277607f * grad_out[1] * in1[5];
    grad_in1[5] += 0.5477225538f * grad_out[3] * in2[6];
    grad_in2[6] += 0.5477225538f * grad_out[3] * in1[5];
    grad_in1[5] += -0.3162277607f * grad_out[2] * in2[7];
    grad_in2[7] += -0.3162277607f * grad_out[2] * in1[5];
    grad_in1[5] += 0.3162277607f * grad_out[3] * in2[8];
    grad_in2[8] += 0.3162277607f * grad_out[3] * in1[5];
    grad_in1[6] += -0.5477225538f * grad_out[3] * in2[5];
    grad_in2[5] += -0.5477225538f * grad_out[3] * in1[6];
    grad_in1[6] += 0.5477225538f * grad_out[1] * in2[7];
    grad_in2[7] += 0.5477225538f * grad_out[1] * in1[6];
    grad_in1[7] += -0.3162277607f * grad_out[3] * in2[4];
    grad_in2[4] += -0.3162277607f * grad_out[3] * in1[7];
    grad_in1[7] += 0.3162277607f * grad_out[2] * in2[5];
    grad_in2[5] += 0.3162277607f * grad_out[2] * in1[7];
    grad_in1[7] += -0.5477225538f * grad_out[1] * in2[6];
    grad_in2[6] += -0.5477225538f * grad_out[1] * in1[7];
    grad_in1[7] += 0.3162277607f * grad_out[1] * in2[8];
    grad_in2[8] += 0.3162277607f * grad_out[1] * in1[7];
    grad_in1[8] += 0.6324555213f * grad_out[2] * in2[4];
    grad_in2[4] += 0.6324555213f * grad_out[2] * in1[8];
    grad_in1[8] += -0.3162277607f * grad_out[3] * in2[5];
    grad_in2[5] += -0.3162277607f * grad_out[3] * in1[8];
    grad_in1[8] += -0.3162277607f * grad_out[1] * in2[7];
    grad_in2[7] += -0.3162277607f * grad_out[1] * in1[8];

    // Path 19: (2,2)->2, 25 entries
    grad_in1[4] += -0.5345224892f * grad_out[6] * in2[4];
    grad_in2[4] += -0.5345224892f * grad_out[6] * in1[4];
    grad_in1[4] += 0.4629100588f * grad_out[7] * in2[5];
    grad_in2[5] += 0.4629100588f * grad_out[7] * in1[4];
    grad_in1[4] += -0.5345224892f * grad_out[4] * in2[6];
    grad_in2[6] += -0.5345224892f * grad_out[4] * in1[4];
    grad_in1[4] += 0.4629100588f * grad_out[5] * in2[7];
    grad_in2[7] += 0.4629100588f * grad_out[5] * in1[4];
    grad_in1[5] += 0.4629100588f * grad_out[7] * in2[4];
    grad_in2[4] += 0.4629100588f * grad_out[7] * in1[5];
    grad_in1[5] += 0.2672612446f * grad_out[6] * in2[5];
    grad_in2[5] += 0.2672612446f * grad_out[6] * in1[5];
    grad_in1[5] += -0.4629100588f * grad_out[8] * in2[5];
    grad_in2[5] += -0.4629100588f * grad_out[8] * in1[5];
    grad_in1[5] += 0.2672612446f * grad_out[5] * in2[6];
    grad_in2[6] += 0.2672612446f * grad_out[5] * in1[5];
    grad_in1[5] += 0.4629100588f * grad_out[4] * in2[7];
    grad_in2[7] += 0.4629100588f * grad_out[4] * in1[5];
    grad_in1[5] += -0.4629100588f * grad_out[5] * in2[8];
    grad_in2[8] += -0.4629100588f * grad_out[5] * in1[5];
    grad_in1[6] += -0.5345224892f * grad_out[4] * in2[4];
    grad_in2[4] += -0.5345224892f * grad_out[4] * in1[6];
    grad_in1[6] += 0.2672612446f * grad_out[5] * in2[5];
    grad_in2[5] += 0.2672612446f * grad_out[5] * in1[6];
    grad_in1[6] += 0.5345224892f * grad_out[6] * in2[6];
    grad_in2[6] += 0.5345224892f * grad_out[6] * in1[6];
    grad_in1[6] += 0.2672612446f * grad_out[7] * in2[7];
    grad_in2[7] += 0.2672612446f * grad_out[7] * in1[6];
    grad_in1[6] += -0.5345224892f * grad_out[8] * in2[8];
    grad_in2[8] += -0.5345224892f * grad_out[8] * in1[6];
    grad_in1[7] += 0.4629100588f * grad_out[5] * in2[4];
    grad_in2[4] += 0.4629100588f * grad_out[5] * in1[7];
    grad_in1[7] += 0.4629100588f * grad_out[4] * in2[5];
    grad_in2[5] += 0.4629100588f * grad_out[4] * in1[7];
    grad_in1[7] += 0.2672612446f * grad_out[7] * in2[6];
    grad_in2[6] += 0.2672612446f * grad_out[7] * in1[7];
    grad_in1[7] += 0.2672612446f * grad_out[6] * in2[7];
    grad_in2[7] += 0.2672612446f * grad_out[6] * in1[7];
    grad_in1[7] += 0.4629100588f * grad_out[8] * in2[7];
    grad_in2[7] += 0.4629100588f * grad_out[8] * in1[7];
    grad_in1[7] += 0.4629100588f * grad_out[7] * in2[8];
    grad_in2[8] += 0.4629100588f * grad_out[7] * in1[7];
    grad_in1[8] += -0.4629100588f * grad_out[5] * in2[5];
    grad_in2[5] += -0.4629100588f * grad_out[5] * in1[8];
    grad_in1[8] += -0.5345224892f * grad_out[8] * in2[6];
    grad_in2[6] += -0.5345224892f * grad_out[8] * in1[8];
    grad_in1[8] += 0.4629100588f * grad_out[7] * in2[7];
    grad_in2[7] += 0.4629100588f * grad_out[7] * in1[8];
    grad_in1[8] += -0.5345224892f * grad_out[6] * in2[8];
    grad_in2[8] += -0.5345224892f * grad_out[6] * in1[8];

    // Path 20: (2,2)->3, 28 entries
    grad_in1[4] += 0.4999999918f * grad_out[9] * in2[5];
    grad_in2[5] += 0.4999999918f * grad_out[9] * in1[4];
    grad_in1[4] += 0.3872983429f * grad_out[11] * in2[5];
    grad_in2[5] += 0.3872983429f * grad_out[11] * in1[4];
    grad_in1[4] += 0.7071067679f * grad_out[14] * in2[6];
    grad_in2[6] += 0.7071067679f * grad_out[14] * in1[4];
    grad_in1[4] += -0.3872983429f * grad_out[13] * in2[7];
    grad_in2[7] += -0.3872983429f * grad_out[13] * in1[4];
    grad_in1[4] += 0.4999999918f * grad_out[15] * in2[7];
    grad_in2[7] += 0.4999999918f * grad_out[15] * in1[4];
    grad_in1[4] += 0.3162277692f * grad_out[12] * in2[8];
    grad_in2[8] += 0.3162277692f * grad_out[12] * in1[4];
    grad_in1[5] += -0.4999999918f * grad_out[9] * in2[4];
    grad_in2[4] += -0.4999999918f * grad_out[9] * in1[5];
    grad_in1[5] += -0.3872983429f * grad_out[11] * in2[4];
    grad_in2[4] += -0.3872983429f * grad_out[11] * in1[5];
    grad_in1[5] += 0.4472135802f * grad_out[13] * in2[6];
    grad_in2[6] += 0.4472135802f * grad_out[13] * in1[5];
    grad_in1[5] += -0.6324555384f * grad_out[12] * in2[7];
    grad_in2[7] += -0.6324555384f * grad_out[12] * in1[5];
    grad_in1[5] += -0.3872983429f * grad_out[13] * in2[8];
    grad_in2[8] += -0.3872983429f * grad_out[13] * in1[5];
    grad_in1[5] += -0.4999999918f * grad_out[15] * in2[8];
    grad_in2[8] += -0.4999999918f * grad_out[15] * in1[5];
    grad_in1[6] += -0.7071067679f * grad_out[14] * in2[4];
    grad_in2[4] += -0.7071067679f * grad_out[14] * in1[6];
    grad_in1[6] += -0.4472135802f * grad_out[13] * in2[5];
    grad_in2[5] += -0.4472135802f * grad_out[13] * in1[6];
    grad_in1[6] += 0.4472135802f * grad_out[11] * in2[7];
    grad_in2[7] += 0.4472135802f * grad_out[11] * in1[6];
    grad_in1[6] += 0.7071067679f * grad_out[10] * in2[8];
    grad_in2[8] += 0.7071067679f * grad_out[10] * in1[6];
    grad_in1[7] += 0.3872983429f * grad_out[13] * in2[4];
    grad_in2[4] += 0.3872983429f * grad_out[13] * in1[7];
    grad_in1[7] += -0.4999999918f * grad_out[15] * in2[4];
    grad_in2[4] += -0.4999999918f * grad_out[15] * in1[7];
    grad_in1[7] += 0.6324555384f * grad_out[12] * in2[5];
    grad_in2[5] += 0.6324555384f * grad_out[12] * in1[7];
    grad_in1[7] += -0.4472135802f * grad_out[11] * in2[6];
    grad_in2[6] += -0.4472135802f * grad_out[11] * in1[7];
    grad_in1[7] += 0.4999999918f * grad_out[9] * in2[8];
    grad_in2[8] += 0.4999999918f * grad_out[9] * in1[7];
    grad_in1[7] += -0.3872983429f * grad_out[11] * in2[8];
    grad_in2[8] += -0.3872983429f * grad_out[11] * in1[7];
    grad_in1[8] += -0.3162277692f * grad_out[12] * in2[4];
    grad_in2[4] += -0.3162277692f * grad_out[12] * in1[8];
    grad_in1[8] += 0.3872983429f * grad_out[13] * in2[5];
    grad_in2[5] += 0.3872983429f * grad_out[13] * in1[8];
    grad_in1[8] += 0.4999999918f * grad_out[15] * in2[5];
    grad_in2[5] += 0.4999999918f * grad_out[15] * in1[8];
    grad_in1[8] += -0.7071067679f * grad_out[10] * in2[6];
    grad_in2[6] += -0.7071067679f * grad_out[10] * in1[8];
    grad_in1[8] += -0.4999999918f * grad_out[9] * in2[7];
    grad_in2[7] += -0.4999999918f * grad_out[9] * in1[8];
    grad_in1[8] += 0.3872983429f * grad_out[11] * in2[7];
    grad_in2[7] += 0.3872983429f * grad_out[11] * in1[8];

    // Path 21: (2,3)->1, 21 entries
    grad_in1[4] += 0.4629100412f * grad_out[3] * in2[9];
    grad_in2[9] += 0.4629100412f * grad_out[3] * in1[4];
    grad_in1[4] += 0.3779644803f * grad_out[2] * in2[10];
    grad_in2[10] += 0.3779644803f * grad_out[2] * in1[4];
    grad_in1[4] += -0.1195228589f * grad_out[3] * in2[11];
    grad_in2[11] += -0.1195228589f * grad_out[3] * in1[4];
    grad_in1[4] += -0.1195228589f * grad_out[1] * in2[13];
    grad_in2[13] += -0.1195228589f * grad_out[1] * in1[4];
    grad_in1[4] += -0.4629100412f * grad_out[1] * in2[15];
    grad_in2[15] += -0.4629100412f * grad_out[1] * in1[4];
    grad_in1[5] += 0.3779644803f * grad_out[3] * in2[10];
    grad_in2[10] += 0.3779644803f * grad_out[3] * in1[5];
    grad_in1[5] += 0.4780914358f * grad_out[2] * in2[11];
    grad_in2[11] += 0.4780914358f * grad_out[2] * in1[5];
    grad_in1[5] += -0.2927700119f * grad_out[1] * in2[12];
    grad_in2[12] += -0.2927700119f * grad_out[1] * in1[5];
    grad_in1[5] += -0.3779644803f * grad_out[1] * in2[14];
    grad_in2[14] += -0.3779644803f * grad_out[1] * in1[5];
    grad_in1[6] += 0.4140393398f * grad_out[1] * in2[11];
    grad_in2[11] += 0.4140393398f * grad_out[1] * in1[6];
    grad_in1[6] += 0.5070925636f * grad_out[2] * in2[12];
    grad_in2[12] += 0.5070925636f * grad_out[2] * in1[6];
    grad_in1[6] += 0.4140393398f * grad_out[3] * in2[13];
    grad_in2[13] += 0.4140393398f * grad_out[3] * in1[6];
    grad_in1[7] += 0.3779644803f * grad_out[1] * in2[10];
    grad_in2[10] += 0.3779644803f * grad_out[1] * in1[7];
    grad_in1[7] += -0.2927700119f * grad_out[3] * in2[12];
    grad_in2[12] += -0.2927700119f * grad_out[3] * in1[7];
    grad_in1[7] += 0.4780914358f * grad_out[2] * in2[13];
    grad_in2[13] += 0.4780914358f * grad_out[2] * in1[7];
    grad_in1[7] += 0.3779644803f * grad_out[3] * in2[14];
    grad_in2[14] += 0.3779644803f * grad_out[3] * in1[7];
    grad_in1[8] += 0.4629100412f * grad_out[1] * in2[9];
    grad_in2[9] += 0.4629100412f * grad_out[1] * in1[8];
    grad_in1[8] += 0.1195228589f * grad_out[1] * in2[11];
    grad_in2[11] += 0.1195228589f * grad_out[1] * in1[8];
    grad_in1[8] += -0.1195228589f * grad_out[3] * in2[13];
    grad_in2[13] += -0.1195228589f * grad_out[3] * in1[8];
    grad_in1[8] += 0.3779644803f * grad_out[2] * in2[14];
    grad_in2[14] += 0.3779644803f * grad_out[2] * in1[8];
    grad_in1[8] += 0.4629100412f * grad_out[3] * in2[15];
    grad_in2[15] += 0.4629100412f * grad_out[3] * in1[8];

    // Path 22: (2,3)->2, 28 entries
    grad_in1[4] += -0.4225771204f * grad_out[5] * in2[9];
    grad_in2[9] += -0.4225771204f * grad_out[5] * in1[4];
    grad_in1[4] += -0.3273268423f * grad_out[5] * in2[11];
    grad_in2[11] += -0.3273268423f * grad_out[5] * in1[4];
    grad_in1[4] += -0.2672612446f * grad_out[8] * in2[12];
    grad_in2[12] += -0.2672612446f * grad_out[8] * in1[4];
    grad_in1[4] += 0.3273268423f * grad_out[7] * in2[13];
    grad_in2[13] += 0.3273268423f * grad_out[7] * in1[4];
    grad_in1[4] += -0.5976142935f * grad_out[6] * in2[14];
    grad_in2[14] += -0.5976142935f * grad_out[6] * in1[4];
    grad_in1[4] += -0.4225771204f * grad_out[7] * in2[15];
    grad_in2[15] += -0.4225771204f * grad_out[7] * in1[4];
    grad_in1[5] += 0.4225771204f * grad_out[4] * in2[9];
    grad_in2[9] += 0.4225771204f * grad_out[4] * in1[5];
    grad_in1[5] += 0.3273268423f * grad_out[4] * in2[11];
    grad_in2[11] += 0.3273268423f * grad_out[4] * in1[5];
    grad_in1[5] += 0.5345224892f * grad_out[7] * in2[12];
    grad_in2[12] += 0.5345224892f * grad_out[7] * in1[5];
    grad_in1[5] += -0.3779644601f * grad_out[6] * in2[13];
    grad_in2[13] += -0.3779644601f * grad_out[6] * in1[5];
    grad_in1[5] += 0.3273268423f * grad_out[8] * in2[13];
    grad_in2[13] += 0.3273268423f * grad_out[8] * in1[5];
    grad_in1[5] += 0.4225771204f * grad_out[8] * in2[15];
    grad_in2[15] += 0.4225771204f * grad_out[8] * in1[5];
    grad_in1[6] += -0.5976142935f * grad_out[8] * in2[10];
    grad_in2[10] += -0.5976142935f * grad_out[8] * in1[6];
    grad_in1[6] += -0.3779644601f * grad_out[7] * in2[11];
    grad_in2[11] += -0.3779644601f * grad_out[7] * in1[6];
    grad_in1[6] += 0.3779644601f * grad_out[5] * in2[13];
    grad_in2[13] += 0.3779644601f * grad_out[5] * in1[6];
    grad_in1[6] += 0.5976142935f * grad_out[4] * in2[14];
    grad_in2[14] += 0.5976142935f * grad_out[4] * in1[6];
    grad_in1[7] += -0.4225771204f * grad_out[8] * in2[9];
    grad_in2[9] += -0.4225771204f * grad_out[8] * in1[7];
    grad_in1[7] += 0.3779644601f * grad_out[6] * in2[11];
    grad_in2[11] += 0.3779644601f * grad_out[6] * in1[7];
    grad_in1[7] += 0.3273268423f * grad_out[8] * in2[11];
    grad_in2[11] += 0.3273268423f * grad_out[8] * in1[7];
    grad_in1[7] += -0.5345224892f * grad_out[5] * in2[12];
    grad_in2[12] += -0.5345224892f * grad_out[5] * in1[7];
    grad_in1[7] += -0.3273268423f * grad_out[4] * in2[13];
    grad_in2[13] += -0.3273268423f * grad_out[4] * in1[7];
    grad_in1[7] += 0.4225771204f * grad_out[4] * in2[15];
    grad_in2[15] += 0.4225771204f * grad_out[4] * in1[7];
    grad_in1[8] += 0.4225771204f * grad_out[7] * in2[9];
    grad_in2[9] += 0.4225771204f * grad_out[7] * in1[8];
    grad_in1[8] += 0.5976142935f * grad_out[6] * in2[10];
    grad_in2[10] += 0.5976142935f * grad_out[6] * in1[8];
    grad_in1[8] += -0.3273268423f * grad_out[7] * in2[11];
    grad_in2[11] += -0.3273268423f * grad_out[7] * in1[8];
    grad_in1[8] += 0.2672612446f * grad_out[4] * in2[12];
    grad_in2[12] += 0.2672612446f * grad_out[4] * in1[8];
    grad_in1[8] += -0.3273268423f * grad_out[5] * in2[13];
    grad_in2[13] += -0.3273268423f * grad_out[5] * in1[8];
    grad_in1[8] += -0.4225771204f * grad_out[5] * in2[15];
    grad_in2[15] += -0.4225771204f * grad_out[5] * in1[8];

    // Path 23: (2,3)->3, 41 entries
    grad_in1[4] += -0.2886751401f * grad_out[13] * in2[9];
    grad_in2[9] += -0.2886751401f * grad_out[13] * in1[4];
    grad_in1[4] += -0.5773502803f * grad_out[12] * in2[10];
    grad_in2[10] += -0.5773502803f * grad_out[12] * in1[4];
    grad_in1[4] += 0.4472135802f * grad_out[13] * in2[11];
    grad_in2[11] += 0.4472135802f * grad_out[13] * in1[4];
    grad_in1[4] += 0.2886751401f * grad_out[15] * in2[11];
    grad_in2[11] += 0.2886751401f * grad_out[15] * in1[4];
    grad_in1[4] += -0.5773502803f * grad_out[10] * in2[12];
    grad_in2[12] += -0.5773502803f * grad_out[10] * in1[4];
    grad_in1[4] += -0.2886751401f * grad_out[9] * in2[13];
    grad_in2[13] += -0.2886751401f * grad_out[9] * in1[4];
    grad_in1[4] += 0.4472135802f * grad_out[11] * in2[13];
    grad_in2[13] += 0.4472135802f * grad_out[11] * in1[4];
    grad_in1[4] += 0.2886751401f * grad_out[11] * in2[15];
    grad_in2[15] += 0.2886751401f * grad_out[11] * in1[4];
    grad_in1[5] += 0.4564354668f * grad_out[14] * in2[9];
    grad_in2[9] += 0.4564354668f * grad_out[14] * in1[5];
    grad_in1[5] += 0.3535533840f * grad_out[13] * in2[10];
    grad_in2[10] += 0.3535533840f * grad_out[13] * in1[5];
    grad_in1[5] += -0.4564354668f * grad_out[15] * in2[10];
    grad_in2[10] += -0.4564354668f * grad_out[15] * in1[5];
    grad_in1[5] += 0.1825741828f * grad_out[12] * in2[11];
    grad_in2[11] += 0.1825741828f * grad_out[12] * in1[5];
    grad_in1[5] += -0.3535533840f * grad_out[14] * in2[11];
    grad_in2[11] += -0.3535533840f * grad_out[14] * in1[5];
    grad_in1[5] += 0.1825741828f * grad_out[11] * in2[12];
    grad_in2[12] += 0.1825741828f * grad_out[11] * in1[5];
    grad_in1[5] += 0.3535533840f * grad_out[10] * in2[13];
    grad_in2[13] += 0.3535533840f * grad_out[10] * in1[5];
    grad_in1[5] += 0.4564354668f * grad_out[9] * in2[14];
    grad_in2[14] += 0.4564354668f * grad_out[9] * in1[5];
    grad_in1[5] += -0.3535533840f * grad_out[11] * in2[14];
    grad_in2[14] += -0.3535533840f * grad_out[11] * in1[5];
    grad_in1[5] += -0.4564354668f * grad_out[10] * in2[15];
    grad_in2[15] += -0.4564354668f * grad_out[10] * in1[5];
    grad_in1[6] += -0.6454972118f * grad_out[9] * in2[9];
    grad_in2[9] += -0.6454972118f * grad_out[9] * in1[6];
    grad_in1[6] += 0.3872983429f * grad_out[11] * in2[11];
    grad_in2[11] += 0.3872983429f * grad_out[11] * in1[6];
    grad_in1[6] += 0.5163977773f * grad_out[12] * in2[12];
    grad_in2[12] += 0.5163977773f * grad_out[12] * in1[6];
    grad_in1[6] += 0.3872983429f * grad_out[13] * in2[13];
    grad_in2[13] += 0.3872983429f * grad_out[13] * in1[6];
    grad_in1[6] += -0.6454972118f * grad_out[15] * in2[15];
    grad_in2[15] += -0.6454972118f * grad_out[15] * in1[6];
    grad_in1[7] += 0.4564354668f * grad_out[10] * in2[9];
    grad_in2[9] += 0.4564354668f * grad_out[10] * in1[7];
    grad_in1[7] += 0.4564354668f * grad_out[9] * in2[10];
    grad_in2[10] += 0.4564354668f * grad_out[9] * in1[7];
    grad_in1[7] += 0.3535533840f * grad_out[11] * in2[10];
    grad_in2[10] += 0.3535533840f * grad_out[11] * in1[7];
    grad_in1[7] += 0.3535533840f * grad_out[10] * in2[11];
    grad_in2[11] += 0.3535533840f * grad_out[10] * in1[7];
    grad_in1[7] += 0.1825741828f * grad_out[13] * in2[12];
    grad_in2[12] += 0.1825741828f * grad_out[13] * in1[7];
    grad_in1[7] += 0.1825741828f * grad_out[12] * in2[13];
    grad_in2[13] += 0.1825741828f * grad_out[12] * in1[7];
    grad_in1[7] += 0.3535533840f * grad_out[14] * in2[13];
    grad_in2[13] += 0.3535533840f * grad_out[14] * in1[7];
    grad_in1[7] += 0.3535533840f * grad_out[13] * in2[14];
    grad_in2[14] += 0.3535533840f * grad_out[13] * in1[7];
    grad_in1[7] += 0.4564354668f * grad_out[15] * in2[14];
    grad_in2[14] += 0.4564354668f * grad_out[15] * in1[7];
    grad_in1[7] += 0.4564354668f * grad_out[14] * in2[15];
    grad_in2[15] += 0.4564354668f * grad_out[14] * in1[7];
    grad_in1[8] += -0.2886751401f * grad_out[11] * in2[9];
    grad_in2[9] += -0.2886751401f * grad_out[11] * in1[8];
    grad_in1[8] += -0.2886751401f * grad_out[9] * in2[11];
    grad_in2[11] += -0.2886751401f * grad_out[9] * in1[8];
    grad_in1[8] += -0.4472135802f * grad_out[11] * in2[11];
    grad_in2[11] += -0.4472135802f * grad_out[11] * in1[8];
    grad_in1[8] += -0.5773502803f * grad_out[14] * in2[12];
    grad_in2[12] += -0.5773502803f * grad_out[14] * in1[8];
    grad_in1[8] += 0.4472135802f * grad_out[13] * in2[13];
    grad_in2[13] += 0.4472135802f * grad_out[13] * in1[8];
    grad_in1[8] += -0.2886751401f * grad_out[15] * in2[13];
    grad_in2[13] += -0.2886751401f * grad_out[15] * in1[8];
    grad_in1[8] += -0.5773502803f * grad_out[12] * in2[14];
    grad_in2[14] += -0.5773502803f * grad_out[12] * in1[8];
    grad_in1[8] += -0.2886751401f * grad_out[13] * in2[15];
    grad_in2[15] += -0.2886751401f * grad_out[13] * in1[8];

    // Path 24: (3,0)->3, 7 entries
    grad_in1[9] += 0.9999999836f * grad_out[9] * in2[0];
    grad_in2[0] += 0.9999999836f * grad_out[9] * in1[9];
    grad_in1[10] += 0.9999999836f * grad_out[10] * in2[0];
    grad_in2[0] += 0.9999999836f * grad_out[10] * in1[10];
    grad_in1[11] += 0.9999999836f * grad_out[11] * in2[0];
    grad_in2[0] += 0.9999999836f * grad_out[11] * in1[11];
    grad_in1[12] += 0.9999999836f * grad_out[12] * in2[0];
    grad_in2[0] += 0.9999999836f * grad_out[12] * in1[12];
    grad_in1[13] += 0.9999999836f * grad_out[13] * in2[0];
    grad_in2[0] += 0.9999999836f * grad_out[13] * in1[13];
    grad_in1[14] += 0.9999999836f * grad_out[14] * in2[0];
    grad_in2[0] += 0.9999999836f * grad_out[14] * in1[14];
    grad_in1[15] += 0.9999999836f * grad_out[15] * in2[0];
    grad_in2[0] += 0.9999999836f * grad_out[15] * in1[15];

    // Path 25: (3,1)->2, 21 entries
    grad_in1[9] += 0.5976142935f * grad_out[8] * in2[1];
    grad_in2[1] += 0.5976142935f * grad_out[8] * in1[9];
    grad_in1[9] += 0.5976142935f * grad_out[4] * in2[3];
    grad_in2[3] += 0.5976142935f * grad_out[4] * in1[9];
    grad_in1[10] += 0.4879500459f * grad_out[7] * in2[1];
    grad_in2[1] += 0.4879500459f * grad_out[7] * in1[10];
    grad_in1[10] += 0.4879500459f * grad_out[4] * in2[2];
    grad_in2[2] += 0.4879500459f * grad_out[4] * in1[10];
    grad_in1[10] += 0.4879500459f * grad_out[5] * in2[3];
    grad_in2[3] += 0.4879500459f * grad_out[5] * in1[10];
    grad_in1[11] += 0.5345224892f * grad_out[6] * in2[1];
    grad_in2[1] += 0.5345224892f * grad_out[6] * in1[11];
    grad_in1[11] += 0.1543033474f * grad_out[8] * in2[1];
    grad_in2[1] += 0.1543033474f * grad_out[8] * in1[11];
    grad_in1[11] += 0.6172133895f * grad_out[5] * in2[2];
    grad_in2[2] += 0.6172133895f * grad_out[5] * in1[11];
    grad_in1[11] += -0.1543033474f * grad_out[4] * in2[3];
    grad_in2[3] += -0.1543033474f * grad_out[4] * in1[11];
    grad_in1[12] += -0.3779644601f * grad_out[5] * in2[1];
    grad_in2[1] += -0.3779644601f * grad_out[5] * in1[12];
    grad_in1[12] += 0.6546536846f * grad_out[6] * in2[2];
    grad_in2[2] += 0.6546536846f * grad_out[6] * in1[12];
    grad_in1[12] += -0.3779644601f * grad_out[7] * in2[3];
    grad_in2[3] += -0.3779644601f * grad_out[7] * in1[12];
    grad_in1[13] += -0.1543033474f * grad_out[4] * in2[1];
    grad_in2[1] += -0.1543033474f * grad_out[4] * in1[13];
    grad_in1[13] += 0.6172133895f * grad_out[7] * in2[2];
    grad_in2[2] += 0.6172133895f * grad_out[7] * in1[13];
    grad_in1[13] += 0.5345224892f * grad_out[6] * in2[3];
    grad_in2[3] += 0.5345224892f * grad_out[6] * in1[13];
    grad_in1[13] += -0.1543033474f * grad_out[8] * in2[3];
    grad_in2[3] += -0.1543033474f * grad_out[8] * in1[13];
    grad_in1[14] += -0.4879500459f * grad_out[5] * in2[1];
    grad_in2[1] += -0.4879500459f * grad_out[5] * in1[14];
    grad_in1[14] += 0.4879500459f * grad_out[8] * in2[2];
    grad_in2[2] += 0.4879500459f * grad_out[8] * in1[14];
    grad_in1[14] += 0.4879500459f * grad_out[7] * in2[3];
    grad_in2[3] += 0.4879500459f * grad_out[7] * in1[14];
    grad_in1[15] += -0.5976142935f * grad_out[4] * in2[1];
    grad_in2[1] += -0.5976142935f * grad_out[4] * in1[15];
    grad_in1[15] += 0.5976142935f * grad_out[8] * in2[3];
    grad_in2[3] += 0.5976142935f * grad_out[8] * in1[15];

    // Path 26: (3,1)->3, 26 entries
    grad_in1[9] += 0.3535533840f * grad_out[10] * in2[1];
    grad_in2[1] += 0.3535533840f * grad_out[10] * in1[9];
    grad_in1[9] += 0.8660254007f * grad_out[15] * in2[2];
    grad_in2[2] += 0.8660254007f * grad_out[15] * in1[9];
    grad_in1[9] += -0.3535533840f * grad_out[14] * in2[3];
    grad_in2[3] += -0.3535533840f * grad_out[14] * in1[9];
    grad_in1[10] += -0.3535533840f * grad_out[9] * in2[1];
    grad_in2[1] += -0.3535533840f * grad_out[9] * in1[10];
    grad_in1[10] += 0.4564354668f * grad_out[11] * in2[1];
    grad_in2[1] += 0.4564354668f * grad_out[11] * in1[10];
    grad_in1[10] += 0.5773502803f * grad_out[14] * in2[2];
    grad_in2[2] += 0.5773502803f * grad_out[14] * in1[10];
    grad_in1[10] += -0.4564354668f * grad_out[13] * in2[3];
    grad_in2[3] += -0.4564354668f * grad_out[13] * in1[10];
    grad_in1[10] += -0.3535533840f * grad_out[15] * in2[3];
    grad_in2[3] += -0.3535533840f * grad_out[15] * in1[10];
    grad_in1[11] += -0.4564354668f * grad_out[10] * in2[1];
    grad_in2[1] += -0.4564354668f * grad_out[10] * in1[11];
    grad_in1[11] += 0.2886751401f * grad_out[13] * in2[2];
    grad_in2[2] += 0.2886751401f * grad_out[13] * in1[11];
    grad_in1[11] += -0.7071067679f * grad_out[12] * in2[3];
    grad_in2[3] += -0.7071067679f * grad_out[12] * in1[11];
    grad_in1[11] += -0.4564354668f * grad_out[14] * in2[3];
    grad_in2[3] += -0.4564354668f * grad_out[14] * in1[11];
    grad_in1[12] += -0.7071067679f * grad_out[13] * in2[1];
    grad_in2[1] += -0.7071067679f * grad_out[13] * in1[12];
    grad_in1[12] += 0.7071067679f * grad_out[11] * in2[3];
    grad_in2[3] += 0.7071067679f * grad_out[11] * in1[12];
    grad_in1[13] += 0.7071067679f * grad_out[12] * in2[1];
    grad_in2[1] += 0.7071067679f * grad_out[12] * in1[13];
    grad_in1[13] += -0.4564354668f * grad_out[14] * in2[1];
    grad_in2[1] += -0.4564354668f * grad_out[14] * in1[13];
    grad_in1[13] += -0.2886751401f * grad_out[11] * in2[2];
    grad_in2[2] += -0.2886751401f * grad_out[11] * in1[13];
    grad_in1[13] += 0.4564354668f * grad_out[10] * in2[3];
    grad_in2[3] += 0.4564354668f * grad_out[10] * in1[13];
    grad_in1[14] += 0.4564354668f * grad_out[13] * in2[1];
    grad_in2[1] += 0.4564354668f * grad_out[13] * in1[14];
    grad_in1[14] += -0.3535533840f * grad_out[15] * in2[1];
    grad_in2[1] += -0.3535533840f * grad_out[15] * in1[14];
    grad_in1[14] += -0.5773502803f * grad_out[10] * in2[2];
    grad_in2[2] += -0.5773502803f * grad_out[10] * in1[14];
    grad_in1[14] += 0.3535533840f * grad_out[9] * in2[3];
    grad_in2[3] += 0.3535533840f * grad_out[9] * in1[14];
    grad_in1[14] += 0.4564354668f * grad_out[11] * in2[3];
    grad_in2[3] += 0.4564354668f * grad_out[11] * in1[14];
    grad_in1[15] += 0.3535533840f * grad_out[14] * in2[1];
    grad_in2[1] += 0.3535533840f * grad_out[14] * in1[15];
    grad_in1[15] += -0.8660254007f * grad_out[9] * in2[2];
    grad_in2[2] += -0.8660254007f * grad_out[9] * in1[15];
    grad_in1[15] += 0.3535533840f * grad_out[10] * in2[3];
    grad_in2[3] += 0.3535533840f * grad_out[10] * in1[15];

    // Path 27: (3,2)->1, 21 entries
    grad_in1[9] += 0.4629100412f * grad_out[3] * in2[4];
    grad_in2[4] += 0.4629100412f * grad_out[3] * in1[9];
    grad_in1[9] += 0.4629100412f * grad_out[1] * in2[8];
    grad_in2[8] += 0.4629100412f * grad_out[1] * in1[9];
    grad_in1[10] += 0.3779644803f * grad_out[2] * in2[4];
    grad_in2[4] += 0.3779644803f * grad_out[2] * in1[10];
    grad_in1[10] += 0.3779644803f * grad_out[3] * in2[5];
    grad_in2[5] += 0.3779644803f * grad_out[3] * in1[10];
    grad_in1[10] += 0.3779644803f * grad_out[1] * in2[7];
    grad_in2[7] += 0.3779644803f * grad_out[1] * in1[10];
    grad_in1[11] += -0.1195228589f * grad_out[3] * in2[4];
    grad_in2[4] += -0.1195228589f * grad_out[3] * in1[11];
    grad_in1[11] += 0.4780914358f * grad_out[2] * in2[5];
    grad_in2[5] += 0.4780914358f * grad_out[2] * in1[11];
    grad_in1[11] += 0.4140393398f * grad_out[1] * in2[6];
    grad_in2[6] += 0.4140393398f * grad_out[1] * in1[11];
    grad_in1[11] += 0.1195228589f * grad_out[1] * in2[8];
    grad_in2[8] += 0.1195228589f * grad_out[1] * in1[11];
    grad_in1[12] += -0.2927700119f * grad_out[1] * in2[5];
    grad_in2[5] += -0.2927700119f * grad_out[1] * in1[12];
    grad_in1[12] += 0.5070925636f * grad_out[2] * in2[6];
    grad_in2[6] += 0.5070925636f * grad_out[2] * in1[12];
    grad_in1[12] += -0.2927700119f * grad_out[3] * in2[7];
    grad_in2[7] += -0.2927700119f * grad_out[3] * in1[12];
    grad_in1[13] += -0.1195228589f * grad_out[1] * in2[4];
    grad_in2[4] += -0.1195228589f * grad_out[1] * in1[13];
    grad_in1[13] += 0.4140393398f * grad_out[3] * in2[6];
    grad_in2[6] += 0.4140393398f * grad_out[3] * in1[13];
    grad_in1[13] += 0.4780914358f * grad_out[2] * in2[7];
    grad_in2[7] += 0.4780914358f * grad_out[2] * in1[13];
    grad_in1[13] += -0.1195228589f * grad_out[3] * in2[8];
    grad_in2[8] += -0.1195228589f * grad_out[3] * in1[13];
    grad_in1[14] += -0.3779644803f * grad_out[1] * in2[5];
    grad_in2[5] += -0.3779644803f * grad_out[1] * in1[14];
    grad_in1[14] += 0.3779644803f * grad_out[3] * in2[7];
    grad_in2[7] += 0.3779644803f * grad_out[3] * in1[14];
    grad_in1[14] += 0.3779644803f * grad_out[2] * in2[8];
    grad_in2[8] += 0.3779644803f * grad_out[2] * in1[14];
    grad_in1[15] += -0.4629100412f * grad_out[1] * in2[4];
    grad_in2[4] += -0.4629100412f * grad_out[1] * in1[15];
    grad_in1[15] += 0.4629100412f * grad_out[3] * in2[8];
    grad_in2[8] += 0.4629100412f * grad_out[3] * in1[15];

    // Path 28: (3,2)->2, 28 entries
    grad_in1[9] += 0.4225771204f * grad_out[5] * in2[4];
    grad_in2[4] += 0.4225771204f * grad_out[5] * in1[9];
    grad_in1[9] += -0.4225771204f * grad_out[4] * in2[5];
    grad_in2[5] += -0.4225771204f * grad_out[4] * in1[9];
    grad_in1[9] += 0.4225771204f * grad_out[8] * in2[7];
    grad_in2[7] += 0.4225771204f * grad_out[8] * in1[9];
    grad_in1[9] += -0.4225771204f * grad_out[7] * in2[8];
    grad_in2[8] += -0.4225771204f * grad_out[7] * in1[9];
    grad_in1[10] += 0.5976142935f * grad_out[8] * in2[6];
    grad_in2[6] += 0.5976142935f * grad_out[8] * in1[10];
    grad_in1[10] += -0.5976142935f * grad_out[6] * in2[8];
    grad_in2[8] += -0.5976142935f * grad_out[6] * in1[10];
    grad_in1[11] += 0.3273268423f * grad_out[5] * in2[4];
    grad_in2[4] += 0.3273268423f * grad_out[5] * in1[11];
    grad_in1[11] += -0.3273268423f * grad_out[4] * in2[5];
    grad_in2[5] += -0.3273268423f * grad_out[4] * in1[11];
    grad_in1[11] += 0.3779644601f * grad_out[7] * in2[6];
    grad_in2[6] += 0.3779644601f * grad_out[7] * in1[11];
    grad_in1[11] += -0.3779644601f * grad_out[6] * in2[7];
    grad_in2[7] += -0.3779644601f * grad_out[6] * in1[11];
    grad_in1[11] += -0.3273268423f * grad_out[8] * in2[7];
    grad_in2[7] += -0.3273268423f * grad_out[8] * in1[11];
    grad_in1[11] += 0.3273268423f * grad_out[7] * in2[8];
    grad_in2[8] += 0.3273268423f * grad_out[7] * in1[11];
    grad_in1[12] += 0.2672612446f * grad_out[8] * in2[4];
    grad_in2[4] += 0.2672612446f * grad_out[8] * in1[12];
    grad_in1[12] += -0.5345224892f * grad_out[7] * in2[5];
    grad_in2[5] += -0.5345224892f * grad_out[7] * in1[12];
    grad_in1[12] += 0.5345224892f * grad_out[5] * in2[7];
    grad_in2[7] += 0.5345224892f * grad_out[5] * in1[12];
    grad_in1[12] += -0.2672612446f * grad_out[4] * in2[8];
    grad_in2[8] += -0.2672612446f * grad_out[4] * in1[12];
    grad_in1[13] += -0.3273268423f * grad_out[7] * in2[4];
    grad_in2[4] += -0.3273268423f * grad_out[7] * in1[13];
    grad_in1[13] += 0.3779644601f * grad_out[6] * in2[5];
    grad_in2[5] += 0.3779644601f * grad_out[6] * in1[13];
    grad_in1[13] += -0.3273268423f * grad_out[8] * in2[5];
    grad_in2[5] += -0.3273268423f * grad_out[8] * in1[13];
    grad_in1[13] += -0.3779644601f * grad_out[5] * in2[6];
    grad_in2[6] += -0.3779644601f * grad_out[5] * in1[13];
    grad_in1[13] += 0.3273268423f * grad_out[4] * in2[7];
    grad_in2[7] += 0.3273268423f * grad_out[4] * in1[13];
    grad_in1[13] += 0.3273268423f * grad_out[5] * in2[8];
    grad_in2[8] += 0.3273268423f * grad_out[5] * in1[13];
    grad_in1[14] += 0.5976142935f * grad_out[6] * in2[4];
    grad_in2[4] += 0.5976142935f * grad_out[6] * in1[14];
    grad_in1[14] += -0.5976142935f * grad_out[4] * in2[6];
    grad_in2[6] += -0.5976142935f * grad_out[4] * in1[14];
    grad_in1[15] += 0.4225771204f * grad_out[7] * in2[4];
    grad_in2[4] += 0.4225771204f * grad_out[7] * in1[15];
    grad_in1[15] += -0.4225771204f * grad_out[8] * in2[5];
    grad_in2[5] += -0.4225771204f * grad_out[8] * in1[15];
    grad_in1[15] += -0.4225771204f * grad_out[4] * in2[7];
    grad_in2[7] += -0.4225771204f * grad_out[4] * in1[15];
    grad_in1[15] += 0.4225771204f * grad_out[5] * in2[8];
    grad_in2[8] += 0.4225771204f * grad_out[5] * in1[15];

    // Path 29: (3,2)->3, 41 entries
    grad_in1[9] += -0.2886751401f * grad_out[13] * in2[4];
    grad_in2[4] += -0.2886751401f * grad_out[13] * in1[9];
    grad_in1[9] += 0.4564354668f * grad_out[14] * in2[5];
    grad_in2[5] += 0.4564354668f * grad_out[14] * in1[9];
    grad_in1[9] += -0.6454972118f * grad_out[9] * in2[6];
    grad_in2[6] += -0.6454972118f * grad_out[9] * in1[9];
    grad_in1[9] += 0.4564354668f * grad_out[10] * in2[7];
    grad_in2[7] += 0.4564354668f * grad_out[10] * in1[9];
    grad_in1[9] += -0.2886751401f * grad_out[11] * in2[8];
    grad_in2[8] += -0.2886751401f * grad_out[11] * in1[9];
    grad_in1[10] += -0.5773502803f * grad_out[12] * in2[4];
    grad_in2[4] += -0.5773502803f * grad_out[12] * in1[10];
    grad_in1[10] += 0.3535533840f * grad_out[13] * in2[5];
    grad_in2[5] += 0.3535533840f * grad_out[13] * in1[10];
    grad_in1[10] += -0.4564354668f * grad_out[15] * in2[5];
    grad_in2[5] += -0.4564354668f * grad_out[15] * in1[10];
    grad_in1[10] += 0.4564354668f * grad_out[9] * in2[7];
    grad_in2[7] += 0.4564354668f * grad_out[9] * in1[10];
    grad_in1[10] += 0.3535533840f * grad_out[11] * in2[7];
    grad_in2[7] += 0.3535533840f * grad_out[11] * in1[10];
    grad_in1[11] += 0.4472135802f * grad_out[13] * in2[4];
    grad_in2[4] += 0.4472135802f * grad_out[13] * in1[11];
    grad_in1[11] += 0.2886751401f * grad_out[15] * in2[4];
    grad_in2[4] += 0.2886751401f * grad_out[15] * in1[11];
    grad_in1[11] += 0.1825741828f * grad_out[12] * in2[5];
    grad_in2[5] += 0.1825741828f * grad_out[12] * in1[11];
    grad_in1[11] += -0.3535533840f * grad_out[14] * in2[5];
    grad_in2[5] += -0.3535533840f * grad_out[14] * in1[11];
    grad_in1[11] += 0.3872983429f * grad_out[11] * in2[6];
    grad_in2[6] += 0.3872983429f * grad_out[11] * in1[11];
    grad_in1[11] += 0.3535533840f * grad_out[10] * in2[7];
    grad_in2[7] += 0.3535533840f * grad_out[10] * in1[11];
    grad_in1[11] += -0.2886751401f * grad_out[9] * in2[8];
    grad_in2[8] += -0.2886751401f * grad_out[9] * in1[11];
    grad_in1[11] += -0.4472135802f * grad_out[11] * in2[8];
    grad_in2[8] += -0.4472135802f * grad_out[11] * in1[11];
    grad_in1[12] += -0.5773502803f * grad_out[10] * in2[4];
    grad_in2[4] += -0.5773502803f * grad_out[10] * in1[12];
    grad_in1[12] += 0.1825741828f * grad_out[11] * in2[5];
    grad_in2[5] += 0.1825741828f * grad_out[11] * in1[12];
    grad_in1[12] += 0.5163977773f * grad_out[12] * in2[6];
    grad_in2[6] += 0.5163977773f * grad_out[12] * in1[12];
    grad_in1[12] += 0.1825741828f * grad_out[13] * in2[7];
    grad_in2[7] += 0.1825741828f * grad_out[13] * in1[12];
    grad_in1[12] += -0.5773502803f * grad_out[14] * in2[8];
    grad_in2[8] += -0.5773502803f * grad_out[14] * in1[12];
    grad_in1[13] += -0.2886751401f * grad_out[9] * in2[4];
    grad_in2[4] += -0.2886751401f * grad_out[9] * in1[13];
    grad_in1[13] += 0.4472135802f * grad_out[11] * in2[4];
    grad_in2[4] += 0.4472135802f * grad_out[11] * in1[13];
    grad_in1[13] += 0.3535533840f * grad_out[10] * in2[5];
    grad_in2[5] += 0.3535533840f * grad_out[10] * in1[13];
    grad_in1[13] += 0.3872983429f * grad_out[13] * in2[6];
    grad_in2[6] += 0.3872983429f * grad_out[13] * in1[13];
    grad_in1[13] += 0.1825741828f * grad_out[12] * in2[7];
    grad_in2[7] += 0.1825741828f * grad_out[12] * in1[13];
    grad_in1[13] += 0.3535533840f * grad_out[14] * in2[7];
    grad_in2[7] += 0.3535533840f * grad_out[14] * in1[13];
    grad_in1[13] += 0.4472135802f * grad_out[13] * in2[8];
    grad_in2[8] += 0.4472135802f * grad_out[13] * in1[13];
    grad_in1[13] += -0.2886751401f * grad_out[15] * in2[8];
    grad_in2[8] += -0.2886751401f * grad_out[15] * in1[13];
    grad_in1[14] += 0.4564354668f * grad_out[9] * in2[5];
    grad_in2[5] += 0.4564354668f * grad_out[9] * in1[14];
    grad_in1[14] += -0.3535533840f * grad_out[11] * in2[5];
    grad_in2[5] += -0.3535533840f * grad_out[11] * in1[14];
    grad_in1[14] += 0.3535533840f * grad_out[13] * in2[7];
    grad_in2[7] += 0.3535533840f * grad_out[13] * in1[14];
    grad_in1[14] += 0.4564354668f * grad_out[15] * in2[7];
    grad_in2[7] += 0.4564354668f * grad_out[15] * in1[14];
    grad_in1[14] += -0.5773502803f * grad_out[12] * in2[8];
    grad_in2[8] += -0.5773502803f * grad_out[12] * in1[14];
    grad_in1[15] += 0.2886751401f * grad_out[11] * in2[4];
    grad_in2[4] += 0.2886751401f * grad_out[11] * in1[15];
    grad_in1[15] += -0.4564354668f * grad_out[10] * in2[5];
    grad_in2[5] += -0.4564354668f * grad_out[10] * in1[15];
    grad_in1[15] += -0.6454972118f * grad_out[15] * in2[6];
    grad_in2[6] += -0.6454972118f * grad_out[15] * in1[15];
    grad_in1[15] += 0.4564354668f * grad_out[14] * in2[7];
    grad_in2[7] += 0.4564354668f * grad_out[14] * in1[15];
    grad_in1[15] += -0.2886751401f * grad_out[13] * in2[8];
    grad_in2[8] += -0.2886751401f * grad_out[13] * in1[15];

    // Path 30: (3,3)->0, 7 entries
    grad_in1[9] += 0.3779644668f * grad_out[0] * in2[9];
    grad_in2[9] += 0.3779644668f * grad_out[0] * in1[9];
    grad_in1[10] += 0.3779644668f * grad_out[0] * in2[10];
    grad_in2[10] += 0.3779644668f * grad_out[0] * in1[10];
    grad_in1[11] += 0.3779644668f * grad_out[0] * in2[11];
    grad_in2[11] += 0.3779644668f * grad_out[0] * in1[11];
    grad_in1[12] += 0.3779644668f * grad_out[0] * in2[12];
    grad_in2[12] += 0.3779644668f * grad_out[0] * in1[12];
    grad_in1[13] += 0.3779644668f * grad_out[0] * in2[13];
    grad_in2[13] += 0.3779644668f * grad_out[0] * in1[13];
    grad_in1[14] += 0.3779644668f * grad_out[0] * in2[14];
    grad_in2[14] += 0.3779644668f * grad_out[0] * in1[14];
    grad_in1[15] += 0.3779644668f * grad_out[0] * in2[15];
    grad_in2[15] += 0.3779644668f * grad_out[0] * in1[15];

    // Path 31: (3,3)->1, 26 entries
    grad_in1[9] += -0.2314550206f * grad_out[1] * in2[10];
    grad_in2[10] += -0.2314550206f * grad_out[1] * in1[9];
    grad_in1[9] += 0.2314550206f * grad_out[3] * in2[14];
    grad_in2[14] += 0.2314550206f * grad_out[3] * in1[9];
    grad_in1[9] += -0.5669467075f * grad_out[2] * in2[15];
    grad_in2[15] += -0.5669467075f * grad_out[2] * in1[9];
    grad_in1[10] += 0.2314550206f * grad_out[1] * in2[9];
    grad_in2[9] += 0.2314550206f * grad_out[1] * in1[10];
    grad_in1[10] += -0.2988071538f * grad_out[1] * in2[11];
    grad_in2[11] += -0.2988071538f * grad_out[1] * in1[10];
    grad_in1[10] += 0.2988071538f * grad_out[3] * in2[13];
    grad_in2[13] += 0.2988071538f * grad_out[3] * in1[10];
    grad_in1[10] += -0.3779644803f * grad_out[2] * in2[14];
    grad_in2[14] += -0.3779644803f * grad_out[2] * in1[10];
    grad_in1[10] += 0.2314550206f * grad_out[3] * in2[15];
    grad_in2[15] += 0.2314550206f * grad_out[3] * in1[10];
    grad_in1[11] += 0.2988071538f * grad_out[1] * in2[10];
    grad_in2[10] += 0.2988071538f * grad_out[1] * in1[11];
    grad_in1[11] += 0.4629100412f * grad_out[3] * in2[12];
    grad_in2[12] += 0.4629100412f * grad_out[3] * in1[11];
    grad_in1[11] += -0.1889822401f * grad_out[2] * in2[13];
    grad_in2[13] += -0.1889822401f * grad_out[2] * in1[11];
    grad_in1[11] += 0.2988071538f * grad_out[3] * in2[14];
    grad_in2[14] += 0.2988071538f * grad_out[3] * in1[11];
    grad_in1[12] += -0.4629100412f * grad_out[3] * in2[11];
    grad_in2[11] += -0.4629100412f * grad_out[3] * in1[12];
    grad_in1[12] += 0.4629100412f * grad_out[1] * in2[13];
    grad_in2[13] += 0.4629100412f * grad_out[1] * in1[12];
    grad_in1[13] += -0.2988071538f * grad_out[3] * in2[10];
    grad_in2[10] += -0.2988071538f * grad_out[3] * in1[13];
    grad_in1[13] += 0.1889822401f * grad_out[2] * in2[11];
    grad_in2[11] += 0.1889822401f * grad_out[2] * in1[13];
    grad_in1[13] += -0.4629100412f * grad_out[1] * in2[12];
    grad_in2[12] += -0.4629100412f * grad_out[1] * in1[13];
    grad_in1[13] += 0.2988071538f * grad_out[1] * in2[14];
    grad_in2[14] += 0.2988071538f * grad_out[1] * in1[13];
    grad_in1[14] += -0.2314550206f * grad_out[3] * in2[9];
    grad_in2[9] += -0.2314550206f * grad_out[3] * in1[14];
    grad_in1[14] += 0.3779644803f * grad_out[2] * in2[10];
    grad_in2[10] += 0.3779644803f * grad_out[2] * in1[14];
    grad_in1[14] += -0.2988071538f * grad_out[3] * in2[11];
    grad_in2[11] += -0.2988071538f * grad_out[3] * in1[14];
    grad_in1[14] += -0.2988071538f * grad_out[1] * in2[13];
    grad_in2[13] += -0.2988071538f * grad_out[1] * in1[14];
    grad_in1[14] += 0.2314550206f * grad_out[1] * in2[15];
    grad_in2[15] += 0.2314550206f * grad_out[1] * in1[14];
    grad_in1[15] += 0.5669467075f * grad_out[2] * in2[9];
    grad_in2[9] += 0.5669467075f * grad_out[2] * in1[15];
    grad_in1[15] += -0.2314550206f * grad_out[3] * in2[10];
    grad_in2[10] += -0.2314550206f * grad_out[3] * in1[15];
    grad_in1[15] += -0.2314550206f * grad_out[1] * in2[14];
    grad_in2[14] += -0.2314550206f * grad_out[1] * in1[15];

    // Path 32: (3,3)->2, 41 entries
    grad_in1[9] += -0.5455447150f * grad_out[6] * in2[9];
    grad_in2[9] += -0.5455447150f * grad_out[6] * in1[9];
    grad_in1[9] += 0.3857583768f * grad_out[7] * in2[10];
    grad_in2[10] += 0.3857583768f * grad_out[7] * in1[9];
    grad_in1[9] += -0.2439750229f * grad_out[8] * in2[11];
    grad_in2[11] += -0.2439750229f * grad_out[8] * in1[9];
    grad_in1[9] += -0.2439750229f * grad_out[4] * in2[13];
    grad_in2[13] += -0.2439750229f * grad_out[4] * in1[9];
    grad_in1[9] += 0.3857583768f * grad_out[5] * in2[14];
    grad_in2[14] += 0.3857583768f * grad_out[5] * in1[9];
    grad_in1[10] += 0.3857583768f * grad_out[7] * in2[9];
    grad_in2[9] += 0.3857583768f * grad_out[7] * in1[10];
    grad_in1[10] += 0.2988071467f * grad_out[7] * in2[11];
    grad_in2[11] += 0.2988071467f * grad_out[7] * in1[10];
    grad_in1[10] += -0.4879500459f * grad_out[4] * in2[12];
    grad_in2[12] += -0.4879500459f * grad_out[4] * in1[10];
    grad_in1[10] += 0.2988071467f * grad_out[5] * in2[13];
    grad_in2[13] += 0.2988071467f * grad_out[5] * in1[10];
    grad_in1[10] += -0.3857583768f * grad_out[5] * in2[15];
    grad_in2[15] += -0.3857583768f * grad_out[5] * in1[10];
    grad_in1[11] += -0.2439750229f * grad_out[8] * in2[9];
    grad_in2[9] += -0.2439750229f * grad_out[8] * in1[11];
    grad_in1[11] += 0.2988071467f * grad_out[7] * in2[10];
    grad_in2[10] += 0.2988071467f * grad_out[7] * in1[11];
    grad_in1[11] += 0.3273268423f * grad_out[6] * in2[11];
    grad_in2[11] += 0.3273268423f * grad_out[6] * in1[11];
    grad_in1[11] += -0.3779644601f * grad_out[8] * in2[11];
    grad_in2[11] += -0.3779644601f * grad_out[8] * in1[11];
    grad_in1[11] += 0.1543033474f * grad_out[5] * in2[12];
    grad_in2[12] += 0.1543033474f * grad_out[5] * in1[11];
    grad_in1[11] += 0.3779644601f * grad_out[4] * in2[13];
    grad_in2[13] += 0.3779644601f * grad_out[4] * in1[11];
    grad_in1[11] += -0.2988071467f * grad_out[5] * in2[14];
    grad_in2[14] += -0.2988071467f * grad_out[5] * in1[11];
    grad_in1[11] += 0.2439750229f * grad_out[4] * in2[15];
    grad_in2[15] += 0.2439750229f * grad_out[4] * in1[11];
    grad_in1[12] += -0.4879500459f * grad_out[4] * in2[10];
    grad_in2[10] += -0.4879500459f * grad_out[4] * in1[12];
    grad_in1[12] += 0.1543033474f * grad_out[5] * in2[11];
    grad_in2[11] += 0.1543033474f * grad_out[5] * in1[12];
    grad_in1[12] += 0.4364357787f * grad_out[6] * in2[12];
    grad_in2[12] += 0.4364357787f * grad_out[6] * in1[12];
    grad_in1[12] += 0.1543033474f * grad_out[7] * in2[13];
    grad_in2[13] += 0.1543033474f * grad_out[7] * in1[12];
    grad_in1[12] += -0.4879500459f * grad_out[8] * in2[14];
    grad_in2[14] += -0.4879500459f * grad_out[8] * in1[12];
    grad_in1[13] += -0.2439750229f * grad_out[4] * in2[9];
    grad_in2[9] += -0.2439750229f * grad_out[4] * in1[13];
    grad_in1[13] += 0.2988071467f * grad_out[5] * in2[10];
    grad_in2[10] += 0.2988071467f * grad_out[5] * in1[13];
    grad_in1[13] += 0.3779644601f * grad_out[4] * in2[11];
    grad_in2[11] += 0.3779644601f * grad_out[4] * in1[13];
    grad_in1[13] += 0.1543033474f * grad_out[7] * in2[12];
    grad_in2[12] += 0.1543033474f * grad_out[7] * in1[13];
    grad_in1[13] += 0.3273268423f * grad_out[6] * in2[13];
    grad_in2[13] += 0.3273268423f * grad_out[6] * in1[13];
    grad_in1[13] += 0.3779644601f * grad_out[8] * in2[13];
    grad_in2[13] += 0.3779644601f * grad_out[8] * in1[13];
    grad_in1[13] += 0.2988071467f * grad_out[7] * in2[14];
    grad_in2[14] += 0.2988071467f * grad_out[7] * in1[13];
    grad_in1[13] += -0.2439750229f * grad_out[8] * in2[15];
    grad_in2[15] += -0.2439750229f * grad_out[8] * in1[13];
    grad_in1[14] += 0.3857583768f * grad_out[5] * in2[9];
    grad_in2[9] += 0.3857583768f * grad_out[5] * in1[14];
    grad_in1[14] += -0.2988071467f * grad_out[5] * in2[11];
    grad_in2[11] += -0.2988071467f * grad_out[5] * in1[14];
    grad_in1[14] += -0.4879500459f * grad_out[8] * in2[12];
    grad_in2[12] += -0.4879500459f * grad_out[8] * in1[14];
    grad_in1[14] += 0.2988071467f * grad_out[7] * in2[13];
    grad_in2[13] += 0.2988071467f * grad_out[7] * in1[14];
    grad_in1[14] += 0.3857583768f * grad_out[7] * in2[15];
    grad_in2[15] += 0.3857583768f * grad_out[7] * in1[14];
    grad_in1[15] += -0.3857583768f * grad_out[5] * in2[10];
    grad_in2[10] += -0.3857583768f * grad_out[5] * in1[15];
    grad_in1[15] += 0.2439750229f * grad_out[4] * in2[11];
    grad_in2[11] += 0.2439750229f * grad_out[4] * in1[15];
    grad_in1[15] += -0.2439750229f * grad_out[8] * in2[13];
    grad_in2[13] += -0.2439750229f * grad_out[8] * in1[15];
    grad_in1[15] += 0.3857583768f * grad_out[7] * in2[14];
    grad_in2[14] += 0.3857583768f * grad_out[7] * in1[15];
    grad_in1[15] += -0.5455447150f * grad_out[6] * in2[15];
    grad_in2[15] += -0.5455447150f * grad_out[6] * in1[15];

    // Path 33: (3,3)->3, 42 entries
    grad_in1[9] += 0.4082483091f * grad_out[11] * in2[10];
    grad_in2[10] += 0.4082483091f * grad_out[11] * in1[9];
    grad_in1[9] += -0.4082483091f * grad_out[10] * in2[11];
    grad_in2[11] += -0.4082483091f * grad_out[10] * in1[9];
    grad_in1[9] += -0.4082483091f * grad_out[15] * in2[12];
    grad_in2[12] += -0.4082483091f * grad_out[15] * in1[9];
    grad_in1[9] += 0.4082483091f * grad_out[14] * in2[13];
    grad_in2[13] += 0.4082483091f * grad_out[14] * in1[9];
    grad_in1[9] += -0.4082483091f * grad_out[13] * in2[14];
    grad_in2[14] += -0.4082483091f * grad_out[13] * in1[9];
    grad_in1[9] += 0.4082483091f * grad_out[12] * in2[15];
    grad_in2[15] += 0.4082483091f * grad_out[12] * in1[9];
    grad_in1[10] += -0.4082483091f * grad_out[11] * in2[9];
    grad_in2[9] += -0.4082483091f * grad_out[11] * in1[10];
    grad_in1[10] += 0.4082483091f * grad_out[9] * in2[11];
    grad_in2[11] += 0.4082483091f * grad_out[9] * in1[10];
    grad_in1[10] += 0.4082483091f * grad_out[14] * in2[12];
    grad_in2[12] += 0.4082483091f * grad_out[14] * in1[10];
    grad_in1[10] += 0.4082483091f * grad_out[15] * in2[13];
    grad_in2[13] += 0.4082483091f * grad_out[15] * in1[10];
    grad_in1[10] += -0.4082483091f * grad_out[12] * in2[14];
    grad_in2[14] += -0.4082483091f * grad_out[12] * in1[10];
    grad_in1[10] += -0.4082483091f * grad_out[13] * in2[15];
    grad_in2[15] += -0.4082483091f * grad_out[13] * in1[10];
    grad_in1[11] += 0.4082483091f * grad_out[10] * in2[9];
    grad_in2[9] += 0.4082483091f * grad_out[10] * in1[11];
    grad_in1[11] += -0.4082483091f * grad_out[9] * in2[10];
    grad_in2[10] += -0.4082483091f * grad_out[9] * in1[11];
    grad_in1[11] += 0.4082483091f * grad_out[13] * in2[12];
    grad_in2[12] += 0.4082483091f * grad_out[13] * in1[11];
    grad_in1[11] += -0.4082483091f * grad_out[12] * in2[13];
    grad_in2[13] += -0.4082483091f * grad_out[12] * in1[11];
    grad_in1[11] += -0.4082483091f * grad_out[15] * in2[14];
    grad_in2[14] += -0.4082483091f * grad_out[15] * in1[11];
    grad_in1[11] += 0.4082483091f * grad_out[14] * in2[15];
    grad_in2[15] += 0.4082483091f * grad_out[14] * in1[11];
    grad_in1[12] += 0.4082483091f * grad_out[15] * in2[9];
    grad_in2[9] += 0.4082483091f * grad_out[15] * in1[12];
    grad_in1[12] += -0.4082483091f * grad_out[14] * in2[10];
    grad_in2[10] += -0.4082483091f * grad_out[14] * in1[12];
    grad_in1[12] += -0.4082483091f * grad_out[13] * in2[11];
    grad_in2[11] += -0.4082483091f * grad_out[13] * in1[12];
    grad_in1[12] += 0.4082483091f * grad_out[11] * in2[13];
    grad_in2[13] += 0.4082483091f * grad_out[11] * in1[12];
    grad_in1[12] += 0.4082483091f * grad_out[10] * in2[14];
    grad_in2[14] += 0.4082483091f * grad_out[10] * in1[12];
    grad_in1[12] += -0.4082483091f * grad_out[9] * in2[15];
    grad_in2[15] += -0.4082483091f * grad_out[9] * in1[12];
    grad_in1[13] += -0.4082483091f * grad_out[14] * in2[9];
    grad_in2[9] += -0.4082483091f * grad_out[14] * in1[13];
    grad_in1[13] += -0.4082483091f * grad_out[15] * in2[10];
    grad_in2[10] += -0.4082483091f * grad_out[15] * in1[13];
    grad_in1[13] += 0.4082483091f * grad_out[12] * in2[11];
    grad_in2[11] += 0.4082483091f * grad_out[12] * in1[13];
    grad_in1[13] += -0.4082483091f * grad_out[11] * in2[12];
    grad_in2[12] += -0.4082483091f * grad_out[11] * in1[13];
    grad_in1[13] += 0.4082483091f * grad_out[9] * in2[14];
    grad_in2[14] += 0.4082483091f * grad_out[9] * in1[13];
    grad_in1[13] += 0.4082483091f * grad_out[10] * in2[15];
    grad_in2[15] += 0.4082483091f * grad_out[10] * in1[13];
    grad_in1[14] += 0.4082483091f * grad_out[13] * in2[9];
    grad_in2[9] += 0.4082483091f * grad_out[13] * in1[14];
    grad_in1[14] += 0.4082483091f * grad_out[12] * in2[10];
    grad_in2[10] += 0.4082483091f * grad_out[12] * in1[14];
    grad_in1[14] += 0.4082483091f * grad_out[15] * in2[11];
    grad_in2[11] += 0.4082483091f * grad_out[15] * in1[14];
    grad_in1[14] += -0.4082483091f * grad_out[10] * in2[12];
    grad_in2[12] += -0.4082483091f * grad_out[10] * in1[14];
    grad_in1[14] += -0.4082483091f * grad_out[9] * in2[13];
    grad_in2[13] += -0.4082483091f * grad_out[9] * in1[14];
    grad_in1[14] += -0.4082483091f * grad_out[11] * in2[15];
    grad_in2[15] += -0.4082483091f * grad_out[11] * in1[14];
    grad_in1[15] += -0.4082483091f * grad_out[12] * in2[9];
    grad_in2[9] += -0.4082483091f * grad_out[12] * in1[15];
    grad_in1[15] += 0.4082483091f * grad_out[13] * in2[10];
    grad_in2[10] += 0.4082483091f * grad_out[13] * in1[15];
    grad_in1[15] += -0.4082483091f * grad_out[14] * in2[11];
    grad_in2[11] += -0.4082483091f * grad_out[14] * in1[15];
    grad_in1[15] += 0.4082483091f * grad_out[9] * in2[12];
    grad_in2[12] += 0.4082483091f * grad_out[9] * in1[15];
    grad_in1[15] += -0.4082483091f * grad_out[10] * in2[13];
    grad_in2[13] += -0.4082483091f * grad_out[10] * in1[15];
    grad_in1[15] += 0.4082483091f * grad_out[11] * in2[14];
    grad_in2[14] += 0.4082483091f * grad_out[11] * in1[15];

}

// Full tensor product backward for grad_input1
// Each call computes grad_in1[c_in, :] for one (sample, c_in) pair
// grad_in1[c_in, m1] = sum_{c_out, paths} w[path,c_in,c_out] * cg * grad_out[c_out,m_out] * in2[m2]
__device__ __forceinline__ void tensor_product_backward_input1_unrolled(
    const float* __restrict__ in2,           // [16] for this sample
    const float* __restrict__ weights,       // [NUM_PATHS, C_in, C_out]
    const float* __restrict__ grad_out,      // [C_out, 16] for this sample
    float* __restrict__ grad_in1,            // [16] output for this (sample, c_in)
    int c_in,
    int c_in_count,
    int c_out_count
) {
    float acc[16] = {0};

    for (int c_out = 0; c_out < c_out_count; c_out++) {
        const float* go = grad_out + c_out * 16;

        // Path 0: (0,0)->0
        {
            const float w = weights[0 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[0] += w * 1.0000000000f * go[0] * in2[0];
        }
        // Path 1: (0,1)->1
        {
            const float w = weights[1 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[0] += w * 0.9999999821f * go[1] * in2[1];
            acc[0] += w * 0.9999999821f * go[2] * in2[2];
            acc[0] += w * 0.9999999821f * go[3] * in2[3];
        }
        // Path 2: (0,2)->2
        {
            const float w = weights[2 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[0] += w * 0.9999999880f * go[4] * in2[4];
            acc[0] += w * 0.9999999880f * go[5] * in2[5];
            acc[0] += w * 0.9999999880f * go[6] * in2[6];
            acc[0] += w * 0.9999999880f * go[7] * in2[7];
            acc[0] += w * 0.9999999880f * go[8] * in2[8];
        }
        // Path 3: (0,3)->3
        {
            const float w = weights[3 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[0] += w * 0.9999999836f * go[9] * in2[9];
            acc[0] += w * 0.9999999836f * go[10] * in2[10];
            acc[0] += w * 0.9999999836f * go[11] * in2[11];
            acc[0] += w * 0.9999999836f * go[12] * in2[12];
            acc[0] += w * 0.9999999836f * go[13] * in2[13];
            acc[0] += w * 0.9999999836f * go[14] * in2[14];
            acc[0] += w * 0.9999999836f * go[15] * in2[15];
        }
        // Path 4: (1,0)->1
        {
            const float w = weights[4 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[1] += w * 0.9999999821f * go[1] * in2[0];
            acc[2] += w * 0.9999999821f * go[2] * in2[0];
            acc[3] += w * 0.9999999821f * go[3] * in2[0];
        }
        // Path 5: (1,1)->0
        {
            const float w = weights[5 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[1] += w * 0.5773502588f * go[0] * in2[1];
            acc[2] += w * 0.5773502588f * go[0] * in2[2];
            acc[3] += w * 0.5773502588f * go[0] * in2[3];
        }
        // Path 6: (1,1)->1
        {
            const float w = weights[6 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[1] += w * 0.7071068069f * go[3] * in2[2];
            acc[1] += w * -0.7071068069f * go[2] * in2[3];
            acc[2] += w * -0.7071068069f * go[3] * in2[1];
            acc[2] += w * 0.7071068069f * go[1] * in2[3];
            acc[3] += w * 0.7071068069f * go[2] * in2[1];
            acc[3] += w * -0.7071068069f * go[1] * in2[2];
        }
        // Path 7: (1,1)->2
        {
            const float w = weights[7 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[1] += w * -0.4082482836f * go[6] * in2[1];
            acc[1] += w * -0.7071067764f * go[8] * in2[1];
            acc[1] += w * 0.7071067764f * go[5] * in2[2];
            acc[1] += w * 0.7071067764f * go[4] * in2[3];
            acc[2] += w * 0.7071067764f * go[5] * in2[1];
            acc[2] += w * 0.8164965671f * go[6] * in2[2];
            acc[2] += w * 0.7071067764f * go[7] * in2[3];
            acc[3] += w * 0.7071067764f * go[4] * in2[1];
            acc[3] += w * 0.7071067764f * go[7] * in2[2];
            acc[3] += w * -0.4082482836f * go[6] * in2[3];
            acc[3] += w * 0.7071067764f * go[8] * in2[3];
        }
        // Path 8: (1,2)->1
        {
            const float w = weights[8 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[1] += w * 0.5477225538f * go[3] * in2[4];
            acc[1] += w * 0.5477225538f * go[2] * in2[5];
            acc[1] += w * -0.3162277607f * go[1] * in2[6];
            acc[1] += w * -0.5477225538f * go[1] * in2[8];
            acc[2] += w * 0.5477225538f * go[1] * in2[5];
            acc[2] += w * 0.6324555213f * go[2] * in2[6];
            acc[2] += w * 0.5477225538f * go[3] * in2[7];
            acc[3] += w * 0.5477225538f * go[1] * in2[4];
            acc[3] += w * -0.3162277607f * go[3] * in2[6];
            acc[3] += w * 0.5477225538f * go[2] * in2[7];
            acc[3] += w * 0.5477225538f * go[3] * in2[8];
        }
        // Path 9: (1,2)->2
        {
            const float w = weights[9 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[1] += w * -0.4082482836f * go[5] * in2[4];
            acc[1] += w * 0.4082482836f * go[4] * in2[5];
            acc[1] += w * 0.7071067764f * go[7] * in2[6];
            acc[1] += w * -0.7071067764f * go[6] * in2[7];
            acc[1] += w * 0.4082482836f * go[8] * in2[7];
            acc[1] += w * -0.4082482836f * go[7] * in2[8];
            acc[2] += w * -0.8164965671f * go[8] * in2[4];
            acc[2] += w * -0.4082482836f * go[7] * in2[5];
            acc[2] += w * 0.4082482836f * go[5] * in2[7];
            acc[2] += w * 0.8164965671f * go[4] * in2[8];
            acc[3] += w * 0.4082482836f * go[7] * in2[4];
            acc[3] += w * 0.7071067764f * go[6] * in2[5];
            acc[3] += w * 0.4082482836f * go[8] * in2[5];
            acc[3] += w * -0.7071067764f * go[5] * in2[6];
            acc[3] += w * -0.4082482836f * go[4] * in2[7];
            acc[3] += w * -0.4082482836f * go[5] * in2[8];
        }
        // Path 10: (1,2)->3
        {
            const float w = weights[10 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[1] += w * -0.1825741828f * go[13] * in2[4];
            acc[1] += w * -0.7071067679f * go[15] * in2[4];
            acc[1] += w * -0.4472135802f * go[12] * in2[5];
            acc[1] += w * -0.5773502803f * go[14] * in2[5];
            acc[1] += w * 0.6324555384f * go[11] * in2[6];
            acc[1] += w * 0.5773502803f * go[10] * in2[7];
            acc[1] += w * 0.7071067679f * go[9] * in2[8];
            acc[1] += w * 0.1825741828f * go[11] * in2[8];
            acc[2] += w * 0.5773502803f * go[10] * in2[4];
            acc[2] += w * 0.7302967312f * go[11] * in2[5];
            acc[2] += w * 0.7745966857f * go[12] * in2[6];
            acc[2] += w * 0.7302967312f * go[13] * in2[7];
            acc[2] += w * 0.5773502803f * go[14] * in2[8];
            acc[3] += w * 0.7071067679f * go[9] * in2[4];
            acc[3] += w * -0.1825741828f * go[11] * in2[4];
            acc[3] += w * 0.5773502803f * go[10] * in2[5];
            acc[3] += w * 0.6324555384f * go[13] * in2[6];
            acc[3] += w * -0.4472135802f * go[12] * in2[7];
            acc[3] += w * 0.5773502803f * go[14] * in2[7];
            acc[3] += w * -0.1825741828f * go[13] * in2[8];
            acc[3] += w * 0.7071067679f * go[15] * in2[8];
        }
        // Path 11: (1,3)->2
        {
            const float w = weights[11 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[1] += w * 0.5976142935f * go[8] * in2[9];
            acc[1] += w * 0.4879500459f * go[7] * in2[10];
            acc[1] += w * 0.5345224892f * go[6] * in2[11];
            acc[1] += w * 0.1543033474f * go[8] * in2[11];
            acc[1] += w * -0.3779644601f * go[5] * in2[12];
            acc[1] += w * -0.1543033474f * go[4] * in2[13];
            acc[1] += w * -0.4879500459f * go[5] * in2[14];
            acc[1] += w * -0.5976142935f * go[4] * in2[15];
            acc[2] += w * 0.4879500459f * go[4] * in2[10];
            acc[2] += w * 0.6172133895f * go[5] * in2[11];
            acc[2] += w * 0.6546536846f * go[6] * in2[12];
            acc[2] += w * 0.6172133895f * go[7] * in2[13];
            acc[2] += w * 0.4879500459f * go[8] * in2[14];
            acc[3] += w * 0.5976142935f * go[4] * in2[9];
            acc[3] += w * 0.4879500459f * go[5] * in2[10];
            acc[3] += w * -0.1543033474f * go[4] * in2[11];
            acc[3] += w * -0.3779644601f * go[7] * in2[12];
            acc[3] += w * 0.5345224892f * go[6] * in2[13];
            acc[3] += w * -0.1543033474f * go[8] * in2[13];
            acc[3] += w * 0.4879500459f * go[7] * in2[14];
            acc[3] += w * 0.5976142935f * go[8] * in2[15];
        }
        // Path 12: (1,3)->3
        {
            const float w = weights[12 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[1] += w * -0.3535533840f * go[10] * in2[9];
            acc[1] += w * 0.3535533840f * go[9] * in2[10];
            acc[1] += w * -0.4564354668f * go[11] * in2[10];
            acc[1] += w * 0.4564354668f * go[10] * in2[11];
            acc[1] += w * 0.7071067679f * go[13] * in2[12];
            acc[1] += w * -0.7071067679f * go[12] * in2[13];
            acc[1] += w * 0.4564354668f * go[14] * in2[13];
            acc[1] += w * -0.4564354668f * go[13] * in2[14];
            acc[1] += w * 0.3535533840f * go[15] * in2[14];
            acc[1] += w * -0.3535533840f * go[14] * in2[15];
            acc[2] += w * -0.8660254007f * go[15] * in2[9];
            acc[2] += w * -0.5773502803f * go[14] * in2[10];
            acc[2] += w * -0.2886751401f * go[13] * in2[11];
            acc[2] += w * 0.2886751401f * go[11] * in2[13];
            acc[2] += w * 0.5773502803f * go[10] * in2[14];
            acc[2] += w * 0.8660254007f * go[9] * in2[15];
            acc[3] += w * 0.3535533840f * go[14] * in2[9];
            acc[3] += w * 0.4564354668f * go[13] * in2[10];
            acc[3] += w * 0.3535533840f * go[15] * in2[10];
            acc[3] += w * 0.7071067679f * go[12] * in2[11];
            acc[3] += w * 0.4564354668f * go[14] * in2[11];
            acc[3] += w * -0.7071067679f * go[11] * in2[12];
            acc[3] += w * -0.4564354668f * go[10] * in2[13];
            acc[3] += w * -0.3535533840f * go[9] * in2[14];
            acc[3] += w * -0.4564354668f * go[11] * in2[14];
            acc[3] += w * -0.3535533840f * go[10] * in2[15];
        }
        // Path 13: (2,0)->2
        {
            const float w = weights[13 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[4] += w * 0.9999999880f * go[4] * in2[0];
            acc[5] += w * 0.9999999880f * go[5] * in2[0];
            acc[6] += w * 0.9999999880f * go[6] * in2[0];
            acc[7] += w * 0.9999999880f * go[7] * in2[0];
            acc[8] += w * 0.9999999880f * go[8] * in2[0];
        }
        // Path 14: (2,1)->1
        {
            const float w = weights[14 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[4] += w * 0.5477225538f * go[3] * in2[1];
            acc[4] += w * 0.5477225538f * go[1] * in2[3];
            acc[5] += w * 0.5477225538f * go[2] * in2[1];
            acc[5] += w * 0.5477225538f * go[1] * in2[2];
            acc[6] += w * -0.3162277607f * go[1] * in2[1];
            acc[6] += w * 0.6324555213f * go[2] * in2[2];
            acc[6] += w * -0.3162277607f * go[3] * in2[3];
            acc[7] += w * 0.5477225538f * go[3] * in2[2];
            acc[7] += w * 0.5477225538f * go[2] * in2[3];
            acc[8] += w * -0.5477225538f * go[1] * in2[1];
            acc[8] += w * 0.5477225538f * go[3] * in2[3];
        }
        // Path 15: (2,1)->2
        {
            const float w = weights[15 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[4] += w * 0.4082482836f * go[5] * in2[1];
            acc[4] += w * 0.8164965671f * go[8] * in2[2];
            acc[4] += w * -0.4082482836f * go[7] * in2[3];
            acc[5] += w * -0.4082482836f * go[4] * in2[1];
            acc[5] += w * 0.4082482836f * go[7] * in2[2];
            acc[5] += w * -0.7071067764f * go[6] * in2[3];
            acc[5] += w * -0.4082482836f * go[8] * in2[3];
            acc[6] += w * -0.7071067764f * go[7] * in2[1];
            acc[6] += w * 0.7071067764f * go[5] * in2[3];
            acc[7] += w * 0.7071067764f * go[6] * in2[1];
            acc[7] += w * -0.4082482836f * go[8] * in2[1];
            acc[7] += w * -0.4082482836f * go[5] * in2[2];
            acc[7] += w * 0.4082482836f * go[4] * in2[3];
            acc[8] += w * 0.4082482836f * go[7] * in2[1];
            acc[8] += w * -0.8164965671f * go[4] * in2[2];
            acc[8] += w * 0.4082482836f * go[5] * in2[3];
        }
        // Path 16: (2,1)->3
        {
            const float w = weights[16 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[4] += w * -0.1825741828f * go[13] * in2[1];
            acc[4] += w * -0.7071067679f * go[15] * in2[1];
            acc[4] += w * 0.5773502803f * go[10] * in2[2];
            acc[4] += w * 0.7071067679f * go[9] * in2[3];
            acc[4] += w * -0.1825741828f * go[11] * in2[3];
            acc[5] += w * -0.4472135802f * go[12] * in2[1];
            acc[5] += w * -0.5773502803f * go[14] * in2[1];
            acc[5] += w * 0.7302967312f * go[11] * in2[2];
            acc[5] += w * 0.5773502803f * go[10] * in2[3];
            acc[6] += w * 0.6324555384f * go[11] * in2[1];
            acc[6] += w * 0.7745966857f * go[12] * in2[2];
            acc[6] += w * 0.6324555384f * go[13] * in2[3];
            acc[7] += w * 0.5773502803f * go[10] * in2[1];
            acc[7] += w * 0.7302967312f * go[13] * in2[2];
            acc[7] += w * -0.4472135802f * go[12] * in2[3];
            acc[7] += w * 0.5773502803f * go[14] * in2[3];
            acc[8] += w * 0.7071067679f * go[9] * in2[1];
            acc[8] += w * 0.1825741828f * go[11] * in2[1];
            acc[8] += w * 0.5773502803f * go[14] * in2[2];
            acc[8] += w * -0.1825741828f * go[13] * in2[3];
            acc[8] += w * 0.7071067679f * go[15] * in2[3];
        }
        // Path 17: (2,2)->0
        {
            const float w = weights[17 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[4] += w * 0.4472135901f * go[0] * in2[4];
            acc[5] += w * 0.4472135901f * go[0] * in2[5];
            acc[6] += w * 0.4472135901f * go[0] * in2[6];
            acc[7] += w * 0.4472135901f * go[0] * in2[7];
            acc[8] += w * 0.4472135901f * go[0] * in2[8];
        }
        // Path 18: (2,2)->1
        {
            const float w = weights[18 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[4] += w * -0.3162277607f * go[1] * in2[5];
            acc[4] += w * 0.3162277607f * go[3] * in2[7];
            acc[4] += w * -0.6324555213f * go[2] * in2[8];
            acc[5] += w * 0.3162277607f * go[1] * in2[4];
            acc[5] += w * 0.5477225538f * go[3] * in2[6];
            acc[5] += w * -0.3162277607f * go[2] * in2[7];
            acc[5] += w * 0.3162277607f * go[3] * in2[8];
            acc[6] += w * -0.5477225538f * go[3] * in2[5];
            acc[6] += w * 0.5477225538f * go[1] * in2[7];
            acc[7] += w * -0.3162277607f * go[3] * in2[4];
            acc[7] += w * 0.3162277607f * go[2] * in2[5];
            acc[7] += w * -0.5477225538f * go[1] * in2[6];
            acc[7] += w * 0.3162277607f * go[1] * in2[8];
            acc[8] += w * 0.6324555213f * go[2] * in2[4];
            acc[8] += w * -0.3162277607f * go[3] * in2[5];
            acc[8] += w * -0.3162277607f * go[1] * in2[7];
        }
        // Path 19: (2,2)->2
        {
            const float w = weights[19 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[4] += w * -0.5345224892f * go[6] * in2[4];
            acc[4] += w * 0.4629100588f * go[7] * in2[5];
            acc[4] += w * -0.5345224892f * go[4] * in2[6];
            acc[4] += w * 0.4629100588f * go[5] * in2[7];
            acc[5] += w * 0.4629100588f * go[7] * in2[4];
            acc[5] += w * 0.2672612446f * go[6] * in2[5];
            acc[5] += w * -0.4629100588f * go[8] * in2[5];
            acc[5] += w * 0.2672612446f * go[5] * in2[6];
            acc[5] += w * 0.4629100588f * go[4] * in2[7];
            acc[5] += w * -0.4629100588f * go[5] * in2[8];
            acc[6] += w * -0.5345224892f * go[4] * in2[4];
            acc[6] += w * 0.2672612446f * go[5] * in2[5];
            acc[6] += w * 0.5345224892f * go[6] * in2[6];
            acc[6] += w * 0.2672612446f * go[7] * in2[7];
            acc[6] += w * -0.5345224892f * go[8] * in2[8];
            acc[7] += w * 0.4629100588f * go[5] * in2[4];
            acc[7] += w * 0.4629100588f * go[4] * in2[5];
            acc[7] += w * 0.2672612446f * go[7] * in2[6];
            acc[7] += w * 0.2672612446f * go[6] * in2[7];
            acc[7] += w * 0.4629100588f * go[8] * in2[7];
            acc[7] += w * 0.4629100588f * go[7] * in2[8];
            acc[8] += w * -0.4629100588f * go[5] * in2[5];
            acc[8] += w * -0.5345224892f * go[8] * in2[6];
            acc[8] += w * 0.4629100588f * go[7] * in2[7];
            acc[8] += w * -0.5345224892f * go[6] * in2[8];
        }
        // Path 20: (2,2)->3
        {
            const float w = weights[20 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[4] += w * 0.4999999918f * go[9] * in2[5];
            acc[4] += w * 0.3872983429f * go[11] * in2[5];
            acc[4] += w * 0.7071067679f * go[14] * in2[6];
            acc[4] += w * -0.3872983429f * go[13] * in2[7];
            acc[4] += w * 0.4999999918f * go[15] * in2[7];
            acc[4] += w * 0.3162277692f * go[12] * in2[8];
            acc[5] += w * -0.4999999918f * go[9] * in2[4];
            acc[5] += w * -0.3872983429f * go[11] * in2[4];
            acc[5] += w * 0.4472135802f * go[13] * in2[6];
            acc[5] += w * -0.6324555384f * go[12] * in2[7];
            acc[5] += w * -0.3872983429f * go[13] * in2[8];
            acc[5] += w * -0.4999999918f * go[15] * in2[8];
            acc[6] += w * -0.7071067679f * go[14] * in2[4];
            acc[6] += w * -0.4472135802f * go[13] * in2[5];
            acc[6] += w * 0.4472135802f * go[11] * in2[7];
            acc[6] += w * 0.7071067679f * go[10] * in2[8];
            acc[7] += w * 0.3872983429f * go[13] * in2[4];
            acc[7] += w * -0.4999999918f * go[15] * in2[4];
            acc[7] += w * 0.6324555384f * go[12] * in2[5];
            acc[7] += w * -0.4472135802f * go[11] * in2[6];
            acc[7] += w * 0.4999999918f * go[9] * in2[8];
            acc[7] += w * -0.3872983429f * go[11] * in2[8];
            acc[8] += w * -0.3162277692f * go[12] * in2[4];
            acc[8] += w * 0.3872983429f * go[13] * in2[5];
            acc[8] += w * 0.4999999918f * go[15] * in2[5];
            acc[8] += w * -0.7071067679f * go[10] * in2[6];
            acc[8] += w * -0.4999999918f * go[9] * in2[7];
            acc[8] += w * 0.3872983429f * go[11] * in2[7];
        }
        // Path 21: (2,3)->1
        {
            const float w = weights[21 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[4] += w * 0.4629100412f * go[3] * in2[9];
            acc[4] += w * 0.3779644803f * go[2] * in2[10];
            acc[4] += w * -0.1195228589f * go[3] * in2[11];
            acc[4] += w * -0.1195228589f * go[1] * in2[13];
            acc[4] += w * -0.4629100412f * go[1] * in2[15];
            acc[5] += w * 0.3779644803f * go[3] * in2[10];
            acc[5] += w * 0.4780914358f * go[2] * in2[11];
            acc[5] += w * -0.2927700119f * go[1] * in2[12];
            acc[5] += w * -0.3779644803f * go[1] * in2[14];
            acc[6] += w * 0.4140393398f * go[1] * in2[11];
            acc[6] += w * 0.5070925636f * go[2] * in2[12];
            acc[6] += w * 0.4140393398f * go[3] * in2[13];
            acc[7] += w * 0.3779644803f * go[1] * in2[10];
            acc[7] += w * -0.2927700119f * go[3] * in2[12];
            acc[7] += w * 0.4780914358f * go[2] * in2[13];
            acc[7] += w * 0.3779644803f * go[3] * in2[14];
            acc[8] += w * 0.4629100412f * go[1] * in2[9];
            acc[8] += w * 0.1195228589f * go[1] * in2[11];
            acc[8] += w * -0.1195228589f * go[3] * in2[13];
            acc[8] += w * 0.3779644803f * go[2] * in2[14];
            acc[8] += w * 0.4629100412f * go[3] * in2[15];
        }
        // Path 22: (2,3)->2
        {
            const float w = weights[22 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[4] += w * -0.4225771204f * go[5] * in2[9];
            acc[4] += w * -0.3273268423f * go[5] * in2[11];
            acc[4] += w * -0.2672612446f * go[8] * in2[12];
            acc[4] += w * 0.3273268423f * go[7] * in2[13];
            acc[4] += w * -0.5976142935f * go[6] * in2[14];
            acc[4] += w * -0.4225771204f * go[7] * in2[15];
            acc[5] += w * 0.4225771204f * go[4] * in2[9];
            acc[5] += w * 0.3273268423f * go[4] * in2[11];
            acc[5] += w * 0.5345224892f * go[7] * in2[12];
            acc[5] += w * -0.3779644601f * go[6] * in2[13];
            acc[5] += w * 0.3273268423f * go[8] * in2[13];
            acc[5] += w * 0.4225771204f * go[8] * in2[15];
            acc[6] += w * -0.5976142935f * go[8] * in2[10];
            acc[6] += w * -0.3779644601f * go[7] * in2[11];
            acc[6] += w * 0.3779644601f * go[5] * in2[13];
            acc[6] += w * 0.5976142935f * go[4] * in2[14];
            acc[7] += w * -0.4225771204f * go[8] * in2[9];
            acc[7] += w * 0.3779644601f * go[6] * in2[11];
            acc[7] += w * 0.3273268423f * go[8] * in2[11];
            acc[7] += w * -0.5345224892f * go[5] * in2[12];
            acc[7] += w * -0.3273268423f * go[4] * in2[13];
            acc[7] += w * 0.4225771204f * go[4] * in2[15];
            acc[8] += w * 0.4225771204f * go[7] * in2[9];
            acc[8] += w * 0.5976142935f * go[6] * in2[10];
            acc[8] += w * -0.3273268423f * go[7] * in2[11];
            acc[8] += w * 0.2672612446f * go[4] * in2[12];
            acc[8] += w * -0.3273268423f * go[5] * in2[13];
            acc[8] += w * -0.4225771204f * go[5] * in2[15];
        }
        // Path 23: (2,3)->3
        {
            const float w = weights[23 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[4] += w * -0.2886751401f * go[13] * in2[9];
            acc[4] += w * -0.5773502803f * go[12] * in2[10];
            acc[4] += w * 0.4472135802f * go[13] * in2[11];
            acc[4] += w * 0.2886751401f * go[15] * in2[11];
            acc[4] += w * -0.5773502803f * go[10] * in2[12];
            acc[4] += w * -0.2886751401f * go[9] * in2[13];
            acc[4] += w * 0.4472135802f * go[11] * in2[13];
            acc[4] += w * 0.2886751401f * go[11] * in2[15];
            acc[5] += w * 0.4564354668f * go[14] * in2[9];
            acc[5] += w * 0.3535533840f * go[13] * in2[10];
            acc[5] += w * -0.4564354668f * go[15] * in2[10];
            acc[5] += w * 0.1825741828f * go[12] * in2[11];
            acc[5] += w * -0.3535533840f * go[14] * in2[11];
            acc[5] += w * 0.1825741828f * go[11] * in2[12];
            acc[5] += w * 0.3535533840f * go[10] * in2[13];
            acc[5] += w * 0.4564354668f * go[9] * in2[14];
            acc[5] += w * -0.3535533840f * go[11] * in2[14];
            acc[5] += w * -0.4564354668f * go[10] * in2[15];
            acc[6] += w * -0.6454972118f * go[9] * in2[9];
            acc[6] += w * 0.3872983429f * go[11] * in2[11];
            acc[6] += w * 0.5163977773f * go[12] * in2[12];
            acc[6] += w * 0.3872983429f * go[13] * in2[13];
            acc[6] += w * -0.6454972118f * go[15] * in2[15];
            acc[7] += w * 0.4564354668f * go[10] * in2[9];
            acc[7] += w * 0.4564354668f * go[9] * in2[10];
            acc[7] += w * 0.3535533840f * go[11] * in2[10];
            acc[7] += w * 0.3535533840f * go[10] * in2[11];
            acc[7] += w * 0.1825741828f * go[13] * in2[12];
            acc[7] += w * 0.1825741828f * go[12] * in2[13];
            acc[7] += w * 0.3535533840f * go[14] * in2[13];
            acc[7] += w * 0.3535533840f * go[13] * in2[14];
            acc[7] += w * 0.4564354668f * go[15] * in2[14];
            acc[7] += w * 0.4564354668f * go[14] * in2[15];
            acc[8] += w * -0.2886751401f * go[11] * in2[9];
            acc[8] += w * -0.2886751401f * go[9] * in2[11];
            acc[8] += w * -0.4472135802f * go[11] * in2[11];
            acc[8] += w * -0.5773502803f * go[14] * in2[12];
            acc[8] += w * 0.4472135802f * go[13] * in2[13];
            acc[8] += w * -0.2886751401f * go[15] * in2[13];
            acc[8] += w * -0.5773502803f * go[12] * in2[14];
            acc[8] += w * -0.2886751401f * go[13] * in2[15];
        }
        // Path 24: (3,0)->3
        {
            const float w = weights[24 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[9] += w * 0.9999999836f * go[9] * in2[0];
            acc[10] += w * 0.9999999836f * go[10] * in2[0];
            acc[11] += w * 0.9999999836f * go[11] * in2[0];
            acc[12] += w * 0.9999999836f * go[12] * in2[0];
            acc[13] += w * 0.9999999836f * go[13] * in2[0];
            acc[14] += w * 0.9999999836f * go[14] * in2[0];
            acc[15] += w * 0.9999999836f * go[15] * in2[0];
        }
        // Path 25: (3,1)->2
        {
            const float w = weights[25 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[9] += w * 0.5976142935f * go[8] * in2[1];
            acc[9] += w * 0.5976142935f * go[4] * in2[3];
            acc[10] += w * 0.4879500459f * go[7] * in2[1];
            acc[10] += w * 0.4879500459f * go[4] * in2[2];
            acc[10] += w * 0.4879500459f * go[5] * in2[3];
            acc[11] += w * 0.5345224892f * go[6] * in2[1];
            acc[11] += w * 0.1543033474f * go[8] * in2[1];
            acc[11] += w * 0.6172133895f * go[5] * in2[2];
            acc[11] += w * -0.1543033474f * go[4] * in2[3];
            acc[12] += w * -0.3779644601f * go[5] * in2[1];
            acc[12] += w * 0.6546536846f * go[6] * in2[2];
            acc[12] += w * -0.3779644601f * go[7] * in2[3];
            acc[13] += w * -0.1543033474f * go[4] * in2[1];
            acc[13] += w * 0.6172133895f * go[7] * in2[2];
            acc[13] += w * 0.5345224892f * go[6] * in2[3];
            acc[13] += w * -0.1543033474f * go[8] * in2[3];
            acc[14] += w * -0.4879500459f * go[5] * in2[1];
            acc[14] += w * 0.4879500459f * go[8] * in2[2];
            acc[14] += w * 0.4879500459f * go[7] * in2[3];
            acc[15] += w * -0.5976142935f * go[4] * in2[1];
            acc[15] += w * 0.5976142935f * go[8] * in2[3];
        }
        // Path 26: (3,1)->3
        {
            const float w = weights[26 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[9] += w * 0.3535533840f * go[10] * in2[1];
            acc[9] += w * 0.8660254007f * go[15] * in2[2];
            acc[9] += w * -0.3535533840f * go[14] * in2[3];
            acc[10] += w * -0.3535533840f * go[9] * in2[1];
            acc[10] += w * 0.4564354668f * go[11] * in2[1];
            acc[10] += w * 0.5773502803f * go[14] * in2[2];
            acc[10] += w * -0.4564354668f * go[13] * in2[3];
            acc[10] += w * -0.3535533840f * go[15] * in2[3];
            acc[11] += w * -0.4564354668f * go[10] * in2[1];
            acc[11] += w * 0.2886751401f * go[13] * in2[2];
            acc[11] += w * -0.7071067679f * go[12] * in2[3];
            acc[11] += w * -0.4564354668f * go[14] * in2[3];
            acc[12] += w * -0.7071067679f * go[13] * in2[1];
            acc[12] += w * 0.7071067679f * go[11] * in2[3];
            acc[13] += w * 0.7071067679f * go[12] * in2[1];
            acc[13] += w * -0.4564354668f * go[14] * in2[1];
            acc[13] += w * -0.2886751401f * go[11] * in2[2];
            acc[13] += w * 0.4564354668f * go[10] * in2[3];
            acc[14] += w * 0.4564354668f * go[13] * in2[1];
            acc[14] += w * -0.3535533840f * go[15] * in2[1];
            acc[14] += w * -0.5773502803f * go[10] * in2[2];
            acc[14] += w * 0.3535533840f * go[9] * in2[3];
            acc[14] += w * 0.4564354668f * go[11] * in2[3];
            acc[15] += w * 0.3535533840f * go[14] * in2[1];
            acc[15] += w * -0.8660254007f * go[9] * in2[2];
            acc[15] += w * 0.3535533840f * go[10] * in2[3];
        }
        // Path 27: (3,2)->1
        {
            const float w = weights[27 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[9] += w * 0.4629100412f * go[3] * in2[4];
            acc[9] += w * 0.4629100412f * go[1] * in2[8];
            acc[10] += w * 0.3779644803f * go[2] * in2[4];
            acc[10] += w * 0.3779644803f * go[3] * in2[5];
            acc[10] += w * 0.3779644803f * go[1] * in2[7];
            acc[11] += w * -0.1195228589f * go[3] * in2[4];
            acc[11] += w * 0.4780914358f * go[2] * in2[5];
            acc[11] += w * 0.4140393398f * go[1] * in2[6];
            acc[11] += w * 0.1195228589f * go[1] * in2[8];
            acc[12] += w * -0.2927700119f * go[1] * in2[5];
            acc[12] += w * 0.5070925636f * go[2] * in2[6];
            acc[12] += w * -0.2927700119f * go[3] * in2[7];
            acc[13] += w * -0.1195228589f * go[1] * in2[4];
            acc[13] += w * 0.4140393398f * go[3] * in2[6];
            acc[13] += w * 0.4780914358f * go[2] * in2[7];
            acc[13] += w * -0.1195228589f * go[3] * in2[8];
            acc[14] += w * -0.3779644803f * go[1] * in2[5];
            acc[14] += w * 0.3779644803f * go[3] * in2[7];
            acc[14] += w * 0.3779644803f * go[2] * in2[8];
            acc[15] += w * -0.4629100412f * go[1] * in2[4];
            acc[15] += w * 0.4629100412f * go[3] * in2[8];
        }
        // Path 28: (3,2)->2
        {
            const float w = weights[28 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[9] += w * 0.4225771204f * go[5] * in2[4];
            acc[9] += w * -0.4225771204f * go[4] * in2[5];
            acc[9] += w * 0.4225771204f * go[8] * in2[7];
            acc[9] += w * -0.4225771204f * go[7] * in2[8];
            acc[10] += w * 0.5976142935f * go[8] * in2[6];
            acc[10] += w * -0.5976142935f * go[6] * in2[8];
            acc[11] += w * 0.3273268423f * go[5] * in2[4];
            acc[11] += w * -0.3273268423f * go[4] * in2[5];
            acc[11] += w * 0.3779644601f * go[7] * in2[6];
            acc[11] += w * -0.3779644601f * go[6] * in2[7];
            acc[11] += w * -0.3273268423f * go[8] * in2[7];
            acc[11] += w * 0.3273268423f * go[7] * in2[8];
            acc[12] += w * 0.2672612446f * go[8] * in2[4];
            acc[12] += w * -0.5345224892f * go[7] * in2[5];
            acc[12] += w * 0.5345224892f * go[5] * in2[7];
            acc[12] += w * -0.2672612446f * go[4] * in2[8];
            acc[13] += w * -0.3273268423f * go[7] * in2[4];
            acc[13] += w * 0.3779644601f * go[6] * in2[5];
            acc[13] += w * -0.3273268423f * go[8] * in2[5];
            acc[13] += w * -0.3779644601f * go[5] * in2[6];
            acc[13] += w * 0.3273268423f * go[4] * in2[7];
            acc[13] += w * 0.3273268423f * go[5] * in2[8];
            acc[14] += w * 0.5976142935f * go[6] * in2[4];
            acc[14] += w * -0.5976142935f * go[4] * in2[6];
            acc[15] += w * 0.4225771204f * go[7] * in2[4];
            acc[15] += w * -0.4225771204f * go[8] * in2[5];
            acc[15] += w * -0.4225771204f * go[4] * in2[7];
            acc[15] += w * 0.4225771204f * go[5] * in2[8];
        }
        // Path 29: (3,2)->3
        {
            const float w = weights[29 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[9] += w * -0.2886751401f * go[13] * in2[4];
            acc[9] += w * 0.4564354668f * go[14] * in2[5];
            acc[9] += w * -0.6454972118f * go[9] * in2[6];
            acc[9] += w * 0.4564354668f * go[10] * in2[7];
            acc[9] += w * -0.2886751401f * go[11] * in2[8];
            acc[10] += w * -0.5773502803f * go[12] * in2[4];
            acc[10] += w * 0.3535533840f * go[13] * in2[5];
            acc[10] += w * -0.4564354668f * go[15] * in2[5];
            acc[10] += w * 0.4564354668f * go[9] * in2[7];
            acc[10] += w * 0.3535533840f * go[11] * in2[7];
            acc[11] += w * 0.4472135802f * go[13] * in2[4];
            acc[11] += w * 0.2886751401f * go[15] * in2[4];
            acc[11] += w * 0.1825741828f * go[12] * in2[5];
            acc[11] += w * -0.3535533840f * go[14] * in2[5];
            acc[11] += w * 0.3872983429f * go[11] * in2[6];
            acc[11] += w * 0.3535533840f * go[10] * in2[7];
            acc[11] += w * -0.2886751401f * go[9] * in2[8];
            acc[11] += w * -0.4472135802f * go[11] * in2[8];
            acc[12] += w * -0.5773502803f * go[10] * in2[4];
            acc[12] += w * 0.1825741828f * go[11] * in2[5];
            acc[12] += w * 0.5163977773f * go[12] * in2[6];
            acc[12] += w * 0.1825741828f * go[13] * in2[7];
            acc[12] += w * -0.5773502803f * go[14] * in2[8];
            acc[13] += w * -0.2886751401f * go[9] * in2[4];
            acc[13] += w * 0.4472135802f * go[11] * in2[4];
            acc[13] += w * 0.3535533840f * go[10] * in2[5];
            acc[13] += w * 0.3872983429f * go[13] * in2[6];
            acc[13] += w * 0.1825741828f * go[12] * in2[7];
            acc[13] += w * 0.3535533840f * go[14] * in2[7];
            acc[13] += w * 0.4472135802f * go[13] * in2[8];
            acc[13] += w * -0.2886751401f * go[15] * in2[8];
            acc[14] += w * 0.4564354668f * go[9] * in2[5];
            acc[14] += w * -0.3535533840f * go[11] * in2[5];
            acc[14] += w * 0.3535533840f * go[13] * in2[7];
            acc[14] += w * 0.4564354668f * go[15] * in2[7];
            acc[14] += w * -0.5773502803f * go[12] * in2[8];
            acc[15] += w * 0.2886751401f * go[11] * in2[4];
            acc[15] += w * -0.4564354668f * go[10] * in2[5];
            acc[15] += w * -0.6454972118f * go[15] * in2[6];
            acc[15] += w * 0.4564354668f * go[14] * in2[7];
            acc[15] += w * -0.2886751401f * go[13] * in2[8];
        }
        // Path 30: (3,3)->0
        {
            const float w = weights[30 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[9] += w * 0.3779644668f * go[0] * in2[9];
            acc[10] += w * 0.3779644668f * go[0] * in2[10];
            acc[11] += w * 0.3779644668f * go[0] * in2[11];
            acc[12] += w * 0.3779644668f * go[0] * in2[12];
            acc[13] += w * 0.3779644668f * go[0] * in2[13];
            acc[14] += w * 0.3779644668f * go[0] * in2[14];
            acc[15] += w * 0.3779644668f * go[0] * in2[15];
        }
        // Path 31: (3,3)->1
        {
            const float w = weights[31 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[9] += w * -0.2314550206f * go[1] * in2[10];
            acc[9] += w * 0.2314550206f * go[3] * in2[14];
            acc[9] += w * -0.5669467075f * go[2] * in2[15];
            acc[10] += w * 0.2314550206f * go[1] * in2[9];
            acc[10] += w * -0.2988071538f * go[1] * in2[11];
            acc[10] += w * 0.2988071538f * go[3] * in2[13];
            acc[10] += w * -0.3779644803f * go[2] * in2[14];
            acc[10] += w * 0.2314550206f * go[3] * in2[15];
            acc[11] += w * 0.2988071538f * go[1] * in2[10];
            acc[11] += w * 0.4629100412f * go[3] * in2[12];
            acc[11] += w * -0.1889822401f * go[2] * in2[13];
            acc[11] += w * 0.2988071538f * go[3] * in2[14];
            acc[12] += w * -0.4629100412f * go[3] * in2[11];
            acc[12] += w * 0.4629100412f * go[1] * in2[13];
            acc[13] += w * -0.2988071538f * go[3] * in2[10];
            acc[13] += w * 0.1889822401f * go[2] * in2[11];
            acc[13] += w * -0.4629100412f * go[1] * in2[12];
            acc[13] += w * 0.2988071538f * go[1] * in2[14];
            acc[14] += w * -0.2314550206f * go[3] * in2[9];
            acc[14] += w * 0.3779644803f * go[2] * in2[10];
            acc[14] += w * -0.2988071538f * go[3] * in2[11];
            acc[14] += w * -0.2988071538f * go[1] * in2[13];
            acc[14] += w * 0.2314550206f * go[1] * in2[15];
            acc[15] += w * 0.5669467075f * go[2] * in2[9];
            acc[15] += w * -0.2314550206f * go[3] * in2[10];
            acc[15] += w * -0.2314550206f * go[1] * in2[14];
        }
        // Path 32: (3,3)->2
        {
            const float w = weights[32 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[9] += w * -0.5455447150f * go[6] * in2[9];
            acc[9] += w * 0.3857583768f * go[7] * in2[10];
            acc[9] += w * -0.2439750229f * go[8] * in2[11];
            acc[9] += w * -0.2439750229f * go[4] * in2[13];
            acc[9] += w * 0.3857583768f * go[5] * in2[14];
            acc[10] += w * 0.3857583768f * go[7] * in2[9];
            acc[10] += w * 0.2988071467f * go[7] * in2[11];
            acc[10] += w * -0.4879500459f * go[4] * in2[12];
            acc[10] += w * 0.2988071467f * go[5] * in2[13];
            acc[10] += w * -0.3857583768f * go[5] * in2[15];
            acc[11] += w * -0.2439750229f * go[8] * in2[9];
            acc[11] += w * 0.2988071467f * go[7] * in2[10];
            acc[11] += w * 0.3273268423f * go[6] * in2[11];
            acc[11] += w * -0.3779644601f * go[8] * in2[11];
            acc[11] += w * 0.1543033474f * go[5] * in2[12];
            acc[11] += w * 0.3779644601f * go[4] * in2[13];
            acc[11] += w * -0.2988071467f * go[5] * in2[14];
            acc[11] += w * 0.2439750229f * go[4] * in2[15];
            acc[12] += w * -0.4879500459f * go[4] * in2[10];
            acc[12] += w * 0.1543033474f * go[5] * in2[11];
            acc[12] += w * 0.4364357787f * go[6] * in2[12];
            acc[12] += w * 0.1543033474f * go[7] * in2[13];
            acc[12] += w * -0.4879500459f * go[8] * in2[14];
            acc[13] += w * -0.2439750229f * go[4] * in2[9];
            acc[13] += w * 0.2988071467f * go[5] * in2[10];
            acc[13] += w * 0.3779644601f * go[4] * in2[11];
            acc[13] += w * 0.1543033474f * go[7] * in2[12];
            acc[13] += w * 0.3273268423f * go[6] * in2[13];
            acc[13] += w * 0.3779644601f * go[8] * in2[13];
            acc[13] += w * 0.2988071467f * go[7] * in2[14];
            acc[13] += w * -0.2439750229f * go[8] * in2[15];
            acc[14] += w * 0.3857583768f * go[5] * in2[9];
            acc[14] += w * -0.2988071467f * go[5] * in2[11];
            acc[14] += w * -0.4879500459f * go[8] * in2[12];
            acc[14] += w * 0.2988071467f * go[7] * in2[13];
            acc[14] += w * 0.3857583768f * go[7] * in2[15];
            acc[15] += w * -0.3857583768f * go[5] * in2[10];
            acc[15] += w * 0.2439750229f * go[4] * in2[11];
            acc[15] += w * -0.2439750229f * go[8] * in2[13];
            acc[15] += w * 0.3857583768f * go[7] * in2[14];
            acc[15] += w * -0.5455447150f * go[6] * in2[15];
        }
        // Path 33: (3,3)->3
        {
            const float w = weights[33 * c_in_count * c_out_count + c_in * c_out_count + c_out];
            acc[9] += w * 0.4082483091f * go[11] * in2[10];
            acc[9] += w * -0.4082483091f * go[10] * in2[11];
            acc[9] += w * -0.4082483091f * go[15] * in2[12];
            acc[9] += w * 0.4082483091f * go[14] * in2[13];
            acc[9] += w * -0.4082483091f * go[13] * in2[14];
            acc[9] += w * 0.4082483091f * go[12] * in2[15];
            acc[10] += w * -0.4082483091f * go[11] * in2[9];
            acc[10] += w * 0.4082483091f * go[9] * in2[11];
            acc[10] += w * 0.4082483091f * go[14] * in2[12];
            acc[10] += w * 0.4082483091f * go[15] * in2[13];
            acc[10] += w * -0.4082483091f * go[12] * in2[14];
            acc[10] += w * -0.4082483091f * go[13] * in2[15];
            acc[11] += w * 0.4082483091f * go[10] * in2[9];
            acc[11] += w * -0.4082483091f * go[9] * in2[10];
            acc[11] += w * 0.4082483091f * go[13] * in2[12];
            acc[11] += w * -0.4082483091f * go[12] * in2[13];
            acc[11] += w * -0.4082483091f * go[15] * in2[14];
            acc[11] += w * 0.4082483091f * go[14] * in2[15];
            acc[12] += w * 0.4082483091f * go[15] * in2[9];
            acc[12] += w * -0.4082483091f * go[14] * in2[10];
            acc[12] += w * -0.4082483091f * go[13] * in2[11];
            acc[12] += w * 0.4082483091f * go[11] * in2[13];
            acc[12] += w * 0.4082483091f * go[10] * in2[14];
            acc[12] += w * -0.4082483091f * go[9] * in2[15];
            acc[13] += w * -0.4082483091f * go[14] * in2[9];
            acc[13] += w * -0.4082483091f * go[15] * in2[10];
            acc[13] += w * 0.4082483091f * go[12] * in2[11];
            acc[13] += w * -0.4082483091f * go[11] * in2[12];
            acc[13] += w * 0.4082483091f * go[9] * in2[14];
            acc[13] += w * 0.4082483091f * go[10] * in2[15];
            acc[14] += w * 0.4082483091f * go[13] * in2[9];
            acc[14] += w * 0.4082483091f * go[12] * in2[10];
            acc[14] += w * 0.4082483091f * go[15] * in2[11];
            acc[14] += w * -0.4082483091f * go[10] * in2[12];
            acc[14] += w * -0.4082483091f * go[9] * in2[13];
            acc[14] += w * -0.4082483091f * go[11] * in2[15];
            acc[15] += w * -0.4082483091f * go[12] * in2[9];
            acc[15] += w * 0.4082483091f * go[13] * in2[10];
            acc[15] += w * -0.4082483091f * go[14] * in2[11];
            acc[15] += w * 0.4082483091f * go[9] * in2[12];
            acc[15] += w * -0.4082483091f * go[10] * in2[13];
            acc[15] += w * 0.4082483091f * go[11] * in2[14];
        }
    }

    #pragma unroll
    for (int i = 0; i < 16; i++) {
        grad_in1[i] = acc[i];
    }
}

// Full tensor product backward for grad_input2
// Computes grad_in2[:] for one sample (sum over all c_in, c_out)
// grad_in2[m2] = sum_{c_in, c_out, paths} w[path,c_in,c_out] * cg * grad_out[c_out,m_out] * in1[c_in,m1]
__device__ __forceinline__ void tensor_product_backward_input2_unrolled(
    const float* __restrict__ in1,           // [C_in, 16] for this sample
    const float* __restrict__ weights,       // [NUM_PATHS, C_in, C_out]
    const float* __restrict__ grad_out,      // [C_out, 16] for this sample
    float* __restrict__ grad_in2,            // [16] output for this sample
    int c_in_count,
    int c_out_count
) {
    float acc[16] = {0};

    for (int c_in = 0; c_in < c_in_count; c_in++) {
        const float* inp1 = in1 + c_in * 16;

        for (int c_out = 0; c_out < c_out_count; c_out++) {
            const float* go = grad_out + c_out * 16;

            // Path 0: (0,0)->0
            {
                const float w = weights[0 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[0] += w * 1.0000000000f * go[0] * inp1[0];
            }
            // Path 1: (0,1)->1
            {
                const float w = weights[1 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[1] += w * 0.9999999821f * go[1] * inp1[0];
                acc[2] += w * 0.9999999821f * go[2] * inp1[0];
                acc[3] += w * 0.9999999821f * go[3] * inp1[0];
            }
            // Path 2: (0,2)->2
            {
                const float w = weights[2 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[4] += w * 0.9999999880f * go[4] * inp1[0];
                acc[5] += w * 0.9999999880f * go[5] * inp1[0];
                acc[6] += w * 0.9999999880f * go[6] * inp1[0];
                acc[7] += w * 0.9999999880f * go[7] * inp1[0];
                acc[8] += w * 0.9999999880f * go[8] * inp1[0];
            }
            // Path 3: (0,3)->3
            {
                const float w = weights[3 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[9] += w * 0.9999999836f * go[9] * inp1[0];
                acc[10] += w * 0.9999999836f * go[10] * inp1[0];
                acc[11] += w * 0.9999999836f * go[11] * inp1[0];
                acc[12] += w * 0.9999999836f * go[12] * inp1[0];
                acc[13] += w * 0.9999999836f * go[13] * inp1[0];
                acc[14] += w * 0.9999999836f * go[14] * inp1[0];
                acc[15] += w * 0.9999999836f * go[15] * inp1[0];
            }
            // Path 4: (1,0)->1
            {
                const float w = weights[4 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[0] += w * 0.9999999821f * go[1] * inp1[1];
                acc[0] += w * 0.9999999821f * go[2] * inp1[2];
                acc[0] += w * 0.9999999821f * go[3] * inp1[3];
            }
            // Path 5: (1,1)->0
            {
                const float w = weights[5 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[1] += w * 0.5773502588f * go[0] * inp1[1];
                acc[2] += w * 0.5773502588f * go[0] * inp1[2];
                acc[3] += w * 0.5773502588f * go[0] * inp1[3];
            }
            // Path 6: (1,1)->1
            {
                const float w = weights[6 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[2] += w * 0.7071068069f * go[3] * inp1[1];
                acc[3] += w * -0.7071068069f * go[2] * inp1[1];
                acc[1] += w * -0.7071068069f * go[3] * inp1[2];
                acc[3] += w * 0.7071068069f * go[1] * inp1[2];
                acc[1] += w * 0.7071068069f * go[2] * inp1[3];
                acc[2] += w * -0.7071068069f * go[1] * inp1[3];
            }
            // Path 7: (1,1)->2
            {
                const float w = weights[7 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[1] += w * -0.4082482836f * go[6] * inp1[1];
                acc[1] += w * -0.7071067764f * go[8] * inp1[1];
                acc[2] += w * 0.7071067764f * go[5] * inp1[1];
                acc[3] += w * 0.7071067764f * go[4] * inp1[1];
                acc[1] += w * 0.7071067764f * go[5] * inp1[2];
                acc[2] += w * 0.8164965671f * go[6] * inp1[2];
                acc[3] += w * 0.7071067764f * go[7] * inp1[2];
                acc[1] += w * 0.7071067764f * go[4] * inp1[3];
                acc[2] += w * 0.7071067764f * go[7] * inp1[3];
                acc[3] += w * -0.4082482836f * go[6] * inp1[3];
                acc[3] += w * 0.7071067764f * go[8] * inp1[3];
            }
            // Path 8: (1,2)->1
            {
                const float w = weights[8 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[4] += w * 0.5477225538f * go[3] * inp1[1];
                acc[5] += w * 0.5477225538f * go[2] * inp1[1];
                acc[6] += w * -0.3162277607f * go[1] * inp1[1];
                acc[8] += w * -0.5477225538f * go[1] * inp1[1];
                acc[5] += w * 0.5477225538f * go[1] * inp1[2];
                acc[6] += w * 0.6324555213f * go[2] * inp1[2];
                acc[7] += w * 0.5477225538f * go[3] * inp1[2];
                acc[4] += w * 0.5477225538f * go[1] * inp1[3];
                acc[6] += w * -0.3162277607f * go[3] * inp1[3];
                acc[7] += w * 0.5477225538f * go[2] * inp1[3];
                acc[8] += w * 0.5477225538f * go[3] * inp1[3];
            }
            // Path 9: (1,2)->2
            {
                const float w = weights[9 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[4] += w * -0.4082482836f * go[5] * inp1[1];
                acc[5] += w * 0.4082482836f * go[4] * inp1[1];
                acc[6] += w * 0.7071067764f * go[7] * inp1[1];
                acc[7] += w * -0.7071067764f * go[6] * inp1[1];
                acc[7] += w * 0.4082482836f * go[8] * inp1[1];
                acc[8] += w * -0.4082482836f * go[7] * inp1[1];
                acc[4] += w * -0.8164965671f * go[8] * inp1[2];
                acc[5] += w * -0.4082482836f * go[7] * inp1[2];
                acc[7] += w * 0.4082482836f * go[5] * inp1[2];
                acc[8] += w * 0.8164965671f * go[4] * inp1[2];
                acc[4] += w * 0.4082482836f * go[7] * inp1[3];
                acc[5] += w * 0.7071067764f * go[6] * inp1[3];
                acc[5] += w * 0.4082482836f * go[8] * inp1[3];
                acc[6] += w * -0.7071067764f * go[5] * inp1[3];
                acc[7] += w * -0.4082482836f * go[4] * inp1[3];
                acc[8] += w * -0.4082482836f * go[5] * inp1[3];
            }
            // Path 10: (1,2)->3
            {
                const float w = weights[10 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[4] += w * -0.1825741828f * go[13] * inp1[1];
                acc[4] += w * -0.7071067679f * go[15] * inp1[1];
                acc[5] += w * -0.4472135802f * go[12] * inp1[1];
                acc[5] += w * -0.5773502803f * go[14] * inp1[1];
                acc[6] += w * 0.6324555384f * go[11] * inp1[1];
                acc[7] += w * 0.5773502803f * go[10] * inp1[1];
                acc[8] += w * 0.7071067679f * go[9] * inp1[1];
                acc[8] += w * 0.1825741828f * go[11] * inp1[1];
                acc[4] += w * 0.5773502803f * go[10] * inp1[2];
                acc[5] += w * 0.7302967312f * go[11] * inp1[2];
                acc[6] += w * 0.7745966857f * go[12] * inp1[2];
                acc[7] += w * 0.7302967312f * go[13] * inp1[2];
                acc[8] += w * 0.5773502803f * go[14] * inp1[2];
                acc[4] += w * 0.7071067679f * go[9] * inp1[3];
                acc[4] += w * -0.1825741828f * go[11] * inp1[3];
                acc[5] += w * 0.5773502803f * go[10] * inp1[3];
                acc[6] += w * 0.6324555384f * go[13] * inp1[3];
                acc[7] += w * -0.4472135802f * go[12] * inp1[3];
                acc[7] += w * 0.5773502803f * go[14] * inp1[3];
                acc[8] += w * -0.1825741828f * go[13] * inp1[3];
                acc[8] += w * 0.7071067679f * go[15] * inp1[3];
            }
            // Path 11: (1,3)->2
            {
                const float w = weights[11 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[9] += w * 0.5976142935f * go[8] * inp1[1];
                acc[10] += w * 0.4879500459f * go[7] * inp1[1];
                acc[11] += w * 0.5345224892f * go[6] * inp1[1];
                acc[11] += w * 0.1543033474f * go[8] * inp1[1];
                acc[12] += w * -0.3779644601f * go[5] * inp1[1];
                acc[13] += w * -0.1543033474f * go[4] * inp1[1];
                acc[14] += w * -0.4879500459f * go[5] * inp1[1];
                acc[15] += w * -0.5976142935f * go[4] * inp1[1];
                acc[10] += w * 0.4879500459f * go[4] * inp1[2];
                acc[11] += w * 0.6172133895f * go[5] * inp1[2];
                acc[12] += w * 0.6546536846f * go[6] * inp1[2];
                acc[13] += w * 0.6172133895f * go[7] * inp1[2];
                acc[14] += w * 0.4879500459f * go[8] * inp1[2];
                acc[9] += w * 0.5976142935f * go[4] * inp1[3];
                acc[10] += w * 0.4879500459f * go[5] * inp1[3];
                acc[11] += w * -0.1543033474f * go[4] * inp1[3];
                acc[12] += w * -0.3779644601f * go[7] * inp1[3];
                acc[13] += w * 0.5345224892f * go[6] * inp1[3];
                acc[13] += w * -0.1543033474f * go[8] * inp1[3];
                acc[14] += w * 0.4879500459f * go[7] * inp1[3];
                acc[15] += w * 0.5976142935f * go[8] * inp1[3];
            }
            // Path 12: (1,3)->3
            {
                const float w = weights[12 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[9] += w * -0.3535533840f * go[10] * inp1[1];
                acc[10] += w * 0.3535533840f * go[9] * inp1[1];
                acc[10] += w * -0.4564354668f * go[11] * inp1[1];
                acc[11] += w * 0.4564354668f * go[10] * inp1[1];
                acc[12] += w * 0.7071067679f * go[13] * inp1[1];
                acc[13] += w * -0.7071067679f * go[12] * inp1[1];
                acc[13] += w * 0.4564354668f * go[14] * inp1[1];
                acc[14] += w * -0.4564354668f * go[13] * inp1[1];
                acc[14] += w * 0.3535533840f * go[15] * inp1[1];
                acc[15] += w * -0.3535533840f * go[14] * inp1[1];
                acc[9] += w * -0.8660254007f * go[15] * inp1[2];
                acc[10] += w * -0.5773502803f * go[14] * inp1[2];
                acc[11] += w * -0.2886751401f * go[13] * inp1[2];
                acc[13] += w * 0.2886751401f * go[11] * inp1[2];
                acc[14] += w * 0.5773502803f * go[10] * inp1[2];
                acc[15] += w * 0.8660254007f * go[9] * inp1[2];
                acc[9] += w * 0.3535533840f * go[14] * inp1[3];
                acc[10] += w * 0.4564354668f * go[13] * inp1[3];
                acc[10] += w * 0.3535533840f * go[15] * inp1[3];
                acc[11] += w * 0.7071067679f * go[12] * inp1[3];
                acc[11] += w * 0.4564354668f * go[14] * inp1[3];
                acc[12] += w * -0.7071067679f * go[11] * inp1[3];
                acc[13] += w * -0.4564354668f * go[10] * inp1[3];
                acc[14] += w * -0.3535533840f * go[9] * inp1[3];
                acc[14] += w * -0.4564354668f * go[11] * inp1[3];
                acc[15] += w * -0.3535533840f * go[10] * inp1[3];
            }
            // Path 13: (2,0)->2
            {
                const float w = weights[13 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[0] += w * 0.9999999880f * go[4] * inp1[4];
                acc[0] += w * 0.9999999880f * go[5] * inp1[5];
                acc[0] += w * 0.9999999880f * go[6] * inp1[6];
                acc[0] += w * 0.9999999880f * go[7] * inp1[7];
                acc[0] += w * 0.9999999880f * go[8] * inp1[8];
            }
            // Path 14: (2,1)->1
            {
                const float w = weights[14 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[1] += w * 0.5477225538f * go[3] * inp1[4];
                acc[3] += w * 0.5477225538f * go[1] * inp1[4];
                acc[1] += w * 0.5477225538f * go[2] * inp1[5];
                acc[2] += w * 0.5477225538f * go[1] * inp1[5];
                acc[1] += w * -0.3162277607f * go[1] * inp1[6];
                acc[2] += w * 0.6324555213f * go[2] * inp1[6];
                acc[3] += w * -0.3162277607f * go[3] * inp1[6];
                acc[2] += w * 0.5477225538f * go[3] * inp1[7];
                acc[3] += w * 0.5477225538f * go[2] * inp1[7];
                acc[1] += w * -0.5477225538f * go[1] * inp1[8];
                acc[3] += w * 0.5477225538f * go[3] * inp1[8];
            }
            // Path 15: (2,1)->2
            {
                const float w = weights[15 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[1] += w * 0.4082482836f * go[5] * inp1[4];
                acc[2] += w * 0.8164965671f * go[8] * inp1[4];
                acc[3] += w * -0.4082482836f * go[7] * inp1[4];
                acc[1] += w * -0.4082482836f * go[4] * inp1[5];
                acc[2] += w * 0.4082482836f * go[7] * inp1[5];
                acc[3] += w * -0.7071067764f * go[6] * inp1[5];
                acc[3] += w * -0.4082482836f * go[8] * inp1[5];
                acc[1] += w * -0.7071067764f * go[7] * inp1[6];
                acc[3] += w * 0.7071067764f * go[5] * inp1[6];
                acc[1] += w * 0.7071067764f * go[6] * inp1[7];
                acc[1] += w * -0.4082482836f * go[8] * inp1[7];
                acc[2] += w * -0.4082482836f * go[5] * inp1[7];
                acc[3] += w * 0.4082482836f * go[4] * inp1[7];
                acc[1] += w * 0.4082482836f * go[7] * inp1[8];
                acc[2] += w * -0.8164965671f * go[4] * inp1[8];
                acc[3] += w * 0.4082482836f * go[5] * inp1[8];
            }
            // Path 16: (2,1)->3
            {
                const float w = weights[16 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[1] += w * -0.1825741828f * go[13] * inp1[4];
                acc[1] += w * -0.7071067679f * go[15] * inp1[4];
                acc[2] += w * 0.5773502803f * go[10] * inp1[4];
                acc[3] += w * 0.7071067679f * go[9] * inp1[4];
                acc[3] += w * -0.1825741828f * go[11] * inp1[4];
                acc[1] += w * -0.4472135802f * go[12] * inp1[5];
                acc[1] += w * -0.5773502803f * go[14] * inp1[5];
                acc[2] += w * 0.7302967312f * go[11] * inp1[5];
                acc[3] += w * 0.5773502803f * go[10] * inp1[5];
                acc[1] += w * 0.6324555384f * go[11] * inp1[6];
                acc[2] += w * 0.7745966857f * go[12] * inp1[6];
                acc[3] += w * 0.6324555384f * go[13] * inp1[6];
                acc[1] += w * 0.5773502803f * go[10] * inp1[7];
                acc[2] += w * 0.7302967312f * go[13] * inp1[7];
                acc[3] += w * -0.4472135802f * go[12] * inp1[7];
                acc[3] += w * 0.5773502803f * go[14] * inp1[7];
                acc[1] += w * 0.7071067679f * go[9] * inp1[8];
                acc[1] += w * 0.1825741828f * go[11] * inp1[8];
                acc[2] += w * 0.5773502803f * go[14] * inp1[8];
                acc[3] += w * -0.1825741828f * go[13] * inp1[8];
                acc[3] += w * 0.7071067679f * go[15] * inp1[8];
            }
            // Path 17: (2,2)->0
            {
                const float w = weights[17 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[4] += w * 0.4472135901f * go[0] * inp1[4];
                acc[5] += w * 0.4472135901f * go[0] * inp1[5];
                acc[6] += w * 0.4472135901f * go[0] * inp1[6];
                acc[7] += w * 0.4472135901f * go[0] * inp1[7];
                acc[8] += w * 0.4472135901f * go[0] * inp1[8];
            }
            // Path 18: (2,2)->1
            {
                const float w = weights[18 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[5] += w * -0.3162277607f * go[1] * inp1[4];
                acc[7] += w * 0.3162277607f * go[3] * inp1[4];
                acc[8] += w * -0.6324555213f * go[2] * inp1[4];
                acc[4] += w * 0.3162277607f * go[1] * inp1[5];
                acc[6] += w * 0.5477225538f * go[3] * inp1[5];
                acc[7] += w * -0.3162277607f * go[2] * inp1[5];
                acc[8] += w * 0.3162277607f * go[3] * inp1[5];
                acc[5] += w * -0.5477225538f * go[3] * inp1[6];
                acc[7] += w * 0.5477225538f * go[1] * inp1[6];
                acc[4] += w * -0.3162277607f * go[3] * inp1[7];
                acc[5] += w * 0.3162277607f * go[2] * inp1[7];
                acc[6] += w * -0.5477225538f * go[1] * inp1[7];
                acc[8] += w * 0.3162277607f * go[1] * inp1[7];
                acc[4] += w * 0.6324555213f * go[2] * inp1[8];
                acc[5] += w * -0.3162277607f * go[3] * inp1[8];
                acc[7] += w * -0.3162277607f * go[1] * inp1[8];
            }
            // Path 19: (2,2)->2
            {
                const float w = weights[19 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[4] += w * -0.5345224892f * go[6] * inp1[4];
                acc[5] += w * 0.4629100588f * go[7] * inp1[4];
                acc[6] += w * -0.5345224892f * go[4] * inp1[4];
                acc[7] += w * 0.4629100588f * go[5] * inp1[4];
                acc[4] += w * 0.4629100588f * go[7] * inp1[5];
                acc[5] += w * 0.2672612446f * go[6] * inp1[5];
                acc[5] += w * -0.4629100588f * go[8] * inp1[5];
                acc[6] += w * 0.2672612446f * go[5] * inp1[5];
                acc[7] += w * 0.4629100588f * go[4] * inp1[5];
                acc[8] += w * -0.4629100588f * go[5] * inp1[5];
                acc[4] += w * -0.5345224892f * go[4] * inp1[6];
                acc[5] += w * 0.2672612446f * go[5] * inp1[6];
                acc[6] += w * 0.5345224892f * go[6] * inp1[6];
                acc[7] += w * 0.2672612446f * go[7] * inp1[6];
                acc[8] += w * -0.5345224892f * go[8] * inp1[6];
                acc[4] += w * 0.4629100588f * go[5] * inp1[7];
                acc[5] += w * 0.4629100588f * go[4] * inp1[7];
                acc[6] += w * 0.2672612446f * go[7] * inp1[7];
                acc[7] += w * 0.2672612446f * go[6] * inp1[7];
                acc[7] += w * 0.4629100588f * go[8] * inp1[7];
                acc[8] += w * 0.4629100588f * go[7] * inp1[7];
                acc[5] += w * -0.4629100588f * go[5] * inp1[8];
                acc[6] += w * -0.5345224892f * go[8] * inp1[8];
                acc[7] += w * 0.4629100588f * go[7] * inp1[8];
                acc[8] += w * -0.5345224892f * go[6] * inp1[8];
            }
            // Path 20: (2,2)->3
            {
                const float w = weights[20 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[5] += w * 0.4999999918f * go[9] * inp1[4];
                acc[5] += w * 0.3872983429f * go[11] * inp1[4];
                acc[6] += w * 0.7071067679f * go[14] * inp1[4];
                acc[7] += w * -0.3872983429f * go[13] * inp1[4];
                acc[7] += w * 0.4999999918f * go[15] * inp1[4];
                acc[8] += w * 0.3162277692f * go[12] * inp1[4];
                acc[4] += w * -0.4999999918f * go[9] * inp1[5];
                acc[4] += w * -0.3872983429f * go[11] * inp1[5];
                acc[6] += w * 0.4472135802f * go[13] * inp1[5];
                acc[7] += w * -0.6324555384f * go[12] * inp1[5];
                acc[8] += w * -0.3872983429f * go[13] * inp1[5];
                acc[8] += w * -0.4999999918f * go[15] * inp1[5];
                acc[4] += w * -0.7071067679f * go[14] * inp1[6];
                acc[5] += w * -0.4472135802f * go[13] * inp1[6];
                acc[7] += w * 0.4472135802f * go[11] * inp1[6];
                acc[8] += w * 0.7071067679f * go[10] * inp1[6];
                acc[4] += w * 0.3872983429f * go[13] * inp1[7];
                acc[4] += w * -0.4999999918f * go[15] * inp1[7];
                acc[5] += w * 0.6324555384f * go[12] * inp1[7];
                acc[6] += w * -0.4472135802f * go[11] * inp1[7];
                acc[8] += w * 0.4999999918f * go[9] * inp1[7];
                acc[8] += w * -0.3872983429f * go[11] * inp1[7];
                acc[4] += w * -0.3162277692f * go[12] * inp1[8];
                acc[5] += w * 0.3872983429f * go[13] * inp1[8];
                acc[5] += w * 0.4999999918f * go[15] * inp1[8];
                acc[6] += w * -0.7071067679f * go[10] * inp1[8];
                acc[7] += w * -0.4999999918f * go[9] * inp1[8];
                acc[7] += w * 0.3872983429f * go[11] * inp1[8];
            }
            // Path 21: (2,3)->1
            {
                const float w = weights[21 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[9] += w * 0.4629100412f * go[3] * inp1[4];
                acc[10] += w * 0.3779644803f * go[2] * inp1[4];
                acc[11] += w * -0.1195228589f * go[3] * inp1[4];
                acc[13] += w * -0.1195228589f * go[1] * inp1[4];
                acc[15] += w * -0.4629100412f * go[1] * inp1[4];
                acc[10] += w * 0.3779644803f * go[3] * inp1[5];
                acc[11] += w * 0.4780914358f * go[2] * inp1[5];
                acc[12] += w * -0.2927700119f * go[1] * inp1[5];
                acc[14] += w * -0.3779644803f * go[1] * inp1[5];
                acc[11] += w * 0.4140393398f * go[1] * inp1[6];
                acc[12] += w * 0.5070925636f * go[2] * inp1[6];
                acc[13] += w * 0.4140393398f * go[3] * inp1[6];
                acc[10] += w * 0.3779644803f * go[1] * inp1[7];
                acc[12] += w * -0.2927700119f * go[3] * inp1[7];
                acc[13] += w * 0.4780914358f * go[2] * inp1[7];
                acc[14] += w * 0.3779644803f * go[3] * inp1[7];
                acc[9] += w * 0.4629100412f * go[1] * inp1[8];
                acc[11] += w * 0.1195228589f * go[1] * inp1[8];
                acc[13] += w * -0.1195228589f * go[3] * inp1[8];
                acc[14] += w * 0.3779644803f * go[2] * inp1[8];
                acc[15] += w * 0.4629100412f * go[3] * inp1[8];
            }
            // Path 22: (2,3)->2
            {
                const float w = weights[22 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[9] += w * -0.4225771204f * go[5] * inp1[4];
                acc[11] += w * -0.3273268423f * go[5] * inp1[4];
                acc[12] += w * -0.2672612446f * go[8] * inp1[4];
                acc[13] += w * 0.3273268423f * go[7] * inp1[4];
                acc[14] += w * -0.5976142935f * go[6] * inp1[4];
                acc[15] += w * -0.4225771204f * go[7] * inp1[4];
                acc[9] += w * 0.4225771204f * go[4] * inp1[5];
                acc[11] += w * 0.3273268423f * go[4] * inp1[5];
                acc[12] += w * 0.5345224892f * go[7] * inp1[5];
                acc[13] += w * -0.3779644601f * go[6] * inp1[5];
                acc[13] += w * 0.3273268423f * go[8] * inp1[5];
                acc[15] += w * 0.4225771204f * go[8] * inp1[5];
                acc[10] += w * -0.5976142935f * go[8] * inp1[6];
                acc[11] += w * -0.3779644601f * go[7] * inp1[6];
                acc[13] += w * 0.3779644601f * go[5] * inp1[6];
                acc[14] += w * 0.5976142935f * go[4] * inp1[6];
                acc[9] += w * -0.4225771204f * go[8] * inp1[7];
                acc[11] += w * 0.3779644601f * go[6] * inp1[7];
                acc[11] += w * 0.3273268423f * go[8] * inp1[7];
                acc[12] += w * -0.5345224892f * go[5] * inp1[7];
                acc[13] += w * -0.3273268423f * go[4] * inp1[7];
                acc[15] += w * 0.4225771204f * go[4] * inp1[7];
                acc[9] += w * 0.4225771204f * go[7] * inp1[8];
                acc[10] += w * 0.5976142935f * go[6] * inp1[8];
                acc[11] += w * -0.3273268423f * go[7] * inp1[8];
                acc[12] += w * 0.2672612446f * go[4] * inp1[8];
                acc[13] += w * -0.3273268423f * go[5] * inp1[8];
                acc[15] += w * -0.4225771204f * go[5] * inp1[8];
            }
            // Path 23: (2,3)->3
            {
                const float w = weights[23 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[9] += w * -0.2886751401f * go[13] * inp1[4];
                acc[10] += w * -0.5773502803f * go[12] * inp1[4];
                acc[11] += w * 0.4472135802f * go[13] * inp1[4];
                acc[11] += w * 0.2886751401f * go[15] * inp1[4];
                acc[12] += w * -0.5773502803f * go[10] * inp1[4];
                acc[13] += w * -0.2886751401f * go[9] * inp1[4];
                acc[13] += w * 0.4472135802f * go[11] * inp1[4];
                acc[15] += w * 0.2886751401f * go[11] * inp1[4];
                acc[9] += w * 0.4564354668f * go[14] * inp1[5];
                acc[10] += w * 0.3535533840f * go[13] * inp1[5];
                acc[10] += w * -0.4564354668f * go[15] * inp1[5];
                acc[11] += w * 0.1825741828f * go[12] * inp1[5];
                acc[11] += w * -0.3535533840f * go[14] * inp1[5];
                acc[12] += w * 0.1825741828f * go[11] * inp1[5];
                acc[13] += w * 0.3535533840f * go[10] * inp1[5];
                acc[14] += w * 0.4564354668f * go[9] * inp1[5];
                acc[14] += w * -0.3535533840f * go[11] * inp1[5];
                acc[15] += w * -0.4564354668f * go[10] * inp1[5];
                acc[9] += w * -0.6454972118f * go[9] * inp1[6];
                acc[11] += w * 0.3872983429f * go[11] * inp1[6];
                acc[12] += w * 0.5163977773f * go[12] * inp1[6];
                acc[13] += w * 0.3872983429f * go[13] * inp1[6];
                acc[15] += w * -0.6454972118f * go[15] * inp1[6];
                acc[9] += w * 0.4564354668f * go[10] * inp1[7];
                acc[10] += w * 0.4564354668f * go[9] * inp1[7];
                acc[10] += w * 0.3535533840f * go[11] * inp1[7];
                acc[11] += w * 0.3535533840f * go[10] * inp1[7];
                acc[12] += w * 0.1825741828f * go[13] * inp1[7];
                acc[13] += w * 0.1825741828f * go[12] * inp1[7];
                acc[13] += w * 0.3535533840f * go[14] * inp1[7];
                acc[14] += w * 0.3535533840f * go[13] * inp1[7];
                acc[14] += w * 0.4564354668f * go[15] * inp1[7];
                acc[15] += w * 0.4564354668f * go[14] * inp1[7];
                acc[9] += w * -0.2886751401f * go[11] * inp1[8];
                acc[11] += w * -0.2886751401f * go[9] * inp1[8];
                acc[11] += w * -0.4472135802f * go[11] * inp1[8];
                acc[12] += w * -0.5773502803f * go[14] * inp1[8];
                acc[13] += w * 0.4472135802f * go[13] * inp1[8];
                acc[13] += w * -0.2886751401f * go[15] * inp1[8];
                acc[14] += w * -0.5773502803f * go[12] * inp1[8];
                acc[15] += w * -0.2886751401f * go[13] * inp1[8];
            }
            // Path 24: (3,0)->3
            {
                const float w = weights[24 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[0] += w * 0.9999999836f * go[9] * inp1[9];
                acc[0] += w * 0.9999999836f * go[10] * inp1[10];
                acc[0] += w * 0.9999999836f * go[11] * inp1[11];
                acc[0] += w * 0.9999999836f * go[12] * inp1[12];
                acc[0] += w * 0.9999999836f * go[13] * inp1[13];
                acc[0] += w * 0.9999999836f * go[14] * inp1[14];
                acc[0] += w * 0.9999999836f * go[15] * inp1[15];
            }
            // Path 25: (3,1)->2
            {
                const float w = weights[25 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[1] += w * 0.5976142935f * go[8] * inp1[9];
                acc[3] += w * 0.5976142935f * go[4] * inp1[9];
                acc[1] += w * 0.4879500459f * go[7] * inp1[10];
                acc[2] += w * 0.4879500459f * go[4] * inp1[10];
                acc[3] += w * 0.4879500459f * go[5] * inp1[10];
                acc[1] += w * 0.5345224892f * go[6] * inp1[11];
                acc[1] += w * 0.1543033474f * go[8] * inp1[11];
                acc[2] += w * 0.6172133895f * go[5] * inp1[11];
                acc[3] += w * -0.1543033474f * go[4] * inp1[11];
                acc[1] += w * -0.3779644601f * go[5] * inp1[12];
                acc[2] += w * 0.6546536846f * go[6] * inp1[12];
                acc[3] += w * -0.3779644601f * go[7] * inp1[12];
                acc[1] += w * -0.1543033474f * go[4] * inp1[13];
                acc[2] += w * 0.6172133895f * go[7] * inp1[13];
                acc[3] += w * 0.5345224892f * go[6] * inp1[13];
                acc[3] += w * -0.1543033474f * go[8] * inp1[13];
                acc[1] += w * -0.4879500459f * go[5] * inp1[14];
                acc[2] += w * 0.4879500459f * go[8] * inp1[14];
                acc[3] += w * 0.4879500459f * go[7] * inp1[14];
                acc[1] += w * -0.5976142935f * go[4] * inp1[15];
                acc[3] += w * 0.5976142935f * go[8] * inp1[15];
            }
            // Path 26: (3,1)->3
            {
                const float w = weights[26 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[1] += w * 0.3535533840f * go[10] * inp1[9];
                acc[2] += w * 0.8660254007f * go[15] * inp1[9];
                acc[3] += w * -0.3535533840f * go[14] * inp1[9];
                acc[1] += w * -0.3535533840f * go[9] * inp1[10];
                acc[1] += w * 0.4564354668f * go[11] * inp1[10];
                acc[2] += w * 0.5773502803f * go[14] * inp1[10];
                acc[3] += w * -0.4564354668f * go[13] * inp1[10];
                acc[3] += w * -0.3535533840f * go[15] * inp1[10];
                acc[1] += w * -0.4564354668f * go[10] * inp1[11];
                acc[2] += w * 0.2886751401f * go[13] * inp1[11];
                acc[3] += w * -0.7071067679f * go[12] * inp1[11];
                acc[3] += w * -0.4564354668f * go[14] * inp1[11];
                acc[1] += w * -0.7071067679f * go[13] * inp1[12];
                acc[3] += w * 0.7071067679f * go[11] * inp1[12];
                acc[1] += w * 0.7071067679f * go[12] * inp1[13];
                acc[1] += w * -0.4564354668f * go[14] * inp1[13];
                acc[2] += w * -0.2886751401f * go[11] * inp1[13];
                acc[3] += w * 0.4564354668f * go[10] * inp1[13];
                acc[1] += w * 0.4564354668f * go[13] * inp1[14];
                acc[1] += w * -0.3535533840f * go[15] * inp1[14];
                acc[2] += w * -0.5773502803f * go[10] * inp1[14];
                acc[3] += w * 0.3535533840f * go[9] * inp1[14];
                acc[3] += w * 0.4564354668f * go[11] * inp1[14];
                acc[1] += w * 0.3535533840f * go[14] * inp1[15];
                acc[2] += w * -0.8660254007f * go[9] * inp1[15];
                acc[3] += w * 0.3535533840f * go[10] * inp1[15];
            }
            // Path 27: (3,2)->1
            {
                const float w = weights[27 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[4] += w * 0.4629100412f * go[3] * inp1[9];
                acc[8] += w * 0.4629100412f * go[1] * inp1[9];
                acc[4] += w * 0.3779644803f * go[2] * inp1[10];
                acc[5] += w * 0.3779644803f * go[3] * inp1[10];
                acc[7] += w * 0.3779644803f * go[1] * inp1[10];
                acc[4] += w * -0.1195228589f * go[3] * inp1[11];
                acc[5] += w * 0.4780914358f * go[2] * inp1[11];
                acc[6] += w * 0.4140393398f * go[1] * inp1[11];
                acc[8] += w * 0.1195228589f * go[1] * inp1[11];
                acc[5] += w * -0.2927700119f * go[1] * inp1[12];
                acc[6] += w * 0.5070925636f * go[2] * inp1[12];
                acc[7] += w * -0.2927700119f * go[3] * inp1[12];
                acc[4] += w * -0.1195228589f * go[1] * inp1[13];
                acc[6] += w * 0.4140393398f * go[3] * inp1[13];
                acc[7] += w * 0.4780914358f * go[2] * inp1[13];
                acc[8] += w * -0.1195228589f * go[3] * inp1[13];
                acc[5] += w * -0.3779644803f * go[1] * inp1[14];
                acc[7] += w * 0.3779644803f * go[3] * inp1[14];
                acc[8] += w * 0.3779644803f * go[2] * inp1[14];
                acc[4] += w * -0.4629100412f * go[1] * inp1[15];
                acc[8] += w * 0.4629100412f * go[3] * inp1[15];
            }
            // Path 28: (3,2)->2
            {
                const float w = weights[28 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[4] += w * 0.4225771204f * go[5] * inp1[9];
                acc[5] += w * -0.4225771204f * go[4] * inp1[9];
                acc[7] += w * 0.4225771204f * go[8] * inp1[9];
                acc[8] += w * -0.4225771204f * go[7] * inp1[9];
                acc[6] += w * 0.5976142935f * go[8] * inp1[10];
                acc[8] += w * -0.5976142935f * go[6] * inp1[10];
                acc[4] += w * 0.3273268423f * go[5] * inp1[11];
                acc[5] += w * -0.3273268423f * go[4] * inp1[11];
                acc[6] += w * 0.3779644601f * go[7] * inp1[11];
                acc[7] += w * -0.3779644601f * go[6] * inp1[11];
                acc[7] += w * -0.3273268423f * go[8] * inp1[11];
                acc[8] += w * 0.3273268423f * go[7] * inp1[11];
                acc[4] += w * 0.2672612446f * go[8] * inp1[12];
                acc[5] += w * -0.5345224892f * go[7] * inp1[12];
                acc[7] += w * 0.5345224892f * go[5] * inp1[12];
                acc[8] += w * -0.2672612446f * go[4] * inp1[12];
                acc[4] += w * -0.3273268423f * go[7] * inp1[13];
                acc[5] += w * 0.3779644601f * go[6] * inp1[13];
                acc[5] += w * -0.3273268423f * go[8] * inp1[13];
                acc[6] += w * -0.3779644601f * go[5] * inp1[13];
                acc[7] += w * 0.3273268423f * go[4] * inp1[13];
                acc[8] += w * 0.3273268423f * go[5] * inp1[13];
                acc[4] += w * 0.5976142935f * go[6] * inp1[14];
                acc[6] += w * -0.5976142935f * go[4] * inp1[14];
                acc[4] += w * 0.4225771204f * go[7] * inp1[15];
                acc[5] += w * -0.4225771204f * go[8] * inp1[15];
                acc[7] += w * -0.4225771204f * go[4] * inp1[15];
                acc[8] += w * 0.4225771204f * go[5] * inp1[15];
            }
            // Path 29: (3,2)->3
            {
                const float w = weights[29 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[4] += w * -0.2886751401f * go[13] * inp1[9];
                acc[5] += w * 0.4564354668f * go[14] * inp1[9];
                acc[6] += w * -0.6454972118f * go[9] * inp1[9];
                acc[7] += w * 0.4564354668f * go[10] * inp1[9];
                acc[8] += w * -0.2886751401f * go[11] * inp1[9];
                acc[4] += w * -0.5773502803f * go[12] * inp1[10];
                acc[5] += w * 0.3535533840f * go[13] * inp1[10];
                acc[5] += w * -0.4564354668f * go[15] * inp1[10];
                acc[7] += w * 0.4564354668f * go[9] * inp1[10];
                acc[7] += w * 0.3535533840f * go[11] * inp1[10];
                acc[4] += w * 0.4472135802f * go[13] * inp1[11];
                acc[4] += w * 0.2886751401f * go[15] * inp1[11];
                acc[5] += w * 0.1825741828f * go[12] * inp1[11];
                acc[5] += w * -0.3535533840f * go[14] * inp1[11];
                acc[6] += w * 0.3872983429f * go[11] * inp1[11];
                acc[7] += w * 0.3535533840f * go[10] * inp1[11];
                acc[8] += w * -0.2886751401f * go[9] * inp1[11];
                acc[8] += w * -0.4472135802f * go[11] * inp1[11];
                acc[4] += w * -0.5773502803f * go[10] * inp1[12];
                acc[5] += w * 0.1825741828f * go[11] * inp1[12];
                acc[6] += w * 0.5163977773f * go[12] * inp1[12];
                acc[7] += w * 0.1825741828f * go[13] * inp1[12];
                acc[8] += w * -0.5773502803f * go[14] * inp1[12];
                acc[4] += w * -0.2886751401f * go[9] * inp1[13];
                acc[4] += w * 0.4472135802f * go[11] * inp1[13];
                acc[5] += w * 0.3535533840f * go[10] * inp1[13];
                acc[6] += w * 0.3872983429f * go[13] * inp1[13];
                acc[7] += w * 0.1825741828f * go[12] * inp1[13];
                acc[7] += w * 0.3535533840f * go[14] * inp1[13];
                acc[8] += w * 0.4472135802f * go[13] * inp1[13];
                acc[8] += w * -0.2886751401f * go[15] * inp1[13];
                acc[5] += w * 0.4564354668f * go[9] * inp1[14];
                acc[5] += w * -0.3535533840f * go[11] * inp1[14];
                acc[7] += w * 0.3535533840f * go[13] * inp1[14];
                acc[7] += w * 0.4564354668f * go[15] * inp1[14];
                acc[8] += w * -0.5773502803f * go[12] * inp1[14];
                acc[4] += w * 0.2886751401f * go[11] * inp1[15];
                acc[5] += w * -0.4564354668f * go[10] * inp1[15];
                acc[6] += w * -0.6454972118f * go[15] * inp1[15];
                acc[7] += w * 0.4564354668f * go[14] * inp1[15];
                acc[8] += w * -0.2886751401f * go[13] * inp1[15];
            }
            // Path 30: (3,3)->0
            {
                const float w = weights[30 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[9] += w * 0.3779644668f * go[0] * inp1[9];
                acc[10] += w * 0.3779644668f * go[0] * inp1[10];
                acc[11] += w * 0.3779644668f * go[0] * inp1[11];
                acc[12] += w * 0.3779644668f * go[0] * inp1[12];
                acc[13] += w * 0.3779644668f * go[0] * inp1[13];
                acc[14] += w * 0.3779644668f * go[0] * inp1[14];
                acc[15] += w * 0.3779644668f * go[0] * inp1[15];
            }
            // Path 31: (3,3)->1
            {
                const float w = weights[31 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[10] += w * -0.2314550206f * go[1] * inp1[9];
                acc[14] += w * 0.2314550206f * go[3] * inp1[9];
                acc[15] += w * -0.5669467075f * go[2] * inp1[9];
                acc[9] += w * 0.2314550206f * go[1] * inp1[10];
                acc[11] += w * -0.2988071538f * go[1] * inp1[10];
                acc[13] += w * 0.2988071538f * go[3] * inp1[10];
                acc[14] += w * -0.3779644803f * go[2] * inp1[10];
                acc[15] += w * 0.2314550206f * go[3] * inp1[10];
                acc[10] += w * 0.2988071538f * go[1] * inp1[11];
                acc[12] += w * 0.4629100412f * go[3] * inp1[11];
                acc[13] += w * -0.1889822401f * go[2] * inp1[11];
                acc[14] += w * 0.2988071538f * go[3] * inp1[11];
                acc[11] += w * -0.4629100412f * go[3] * inp1[12];
                acc[13] += w * 0.4629100412f * go[1] * inp1[12];
                acc[10] += w * -0.2988071538f * go[3] * inp1[13];
                acc[11] += w * 0.1889822401f * go[2] * inp1[13];
                acc[12] += w * -0.4629100412f * go[1] * inp1[13];
                acc[14] += w * 0.2988071538f * go[1] * inp1[13];
                acc[9] += w * -0.2314550206f * go[3] * inp1[14];
                acc[10] += w * 0.3779644803f * go[2] * inp1[14];
                acc[11] += w * -0.2988071538f * go[3] * inp1[14];
                acc[13] += w * -0.2988071538f * go[1] * inp1[14];
                acc[15] += w * 0.2314550206f * go[1] * inp1[14];
                acc[9] += w * 0.5669467075f * go[2] * inp1[15];
                acc[10] += w * -0.2314550206f * go[3] * inp1[15];
                acc[14] += w * -0.2314550206f * go[1] * inp1[15];
            }
            // Path 32: (3,3)->2
            {
                const float w = weights[32 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[9] += w * -0.5455447150f * go[6] * inp1[9];
                acc[10] += w * 0.3857583768f * go[7] * inp1[9];
                acc[11] += w * -0.2439750229f * go[8] * inp1[9];
                acc[13] += w * -0.2439750229f * go[4] * inp1[9];
                acc[14] += w * 0.3857583768f * go[5] * inp1[9];
                acc[9] += w * 0.3857583768f * go[7] * inp1[10];
                acc[11] += w * 0.2988071467f * go[7] * inp1[10];
                acc[12] += w * -0.4879500459f * go[4] * inp1[10];
                acc[13] += w * 0.2988071467f * go[5] * inp1[10];
                acc[15] += w * -0.3857583768f * go[5] * inp1[10];
                acc[9] += w * -0.2439750229f * go[8] * inp1[11];
                acc[10] += w * 0.2988071467f * go[7] * inp1[11];
                acc[11] += w * 0.3273268423f * go[6] * inp1[11];
                acc[11] += w * -0.3779644601f * go[8] * inp1[11];
                acc[12] += w * 0.1543033474f * go[5] * inp1[11];
                acc[13] += w * 0.3779644601f * go[4] * inp1[11];
                acc[14] += w * -0.2988071467f * go[5] * inp1[11];
                acc[15] += w * 0.2439750229f * go[4] * inp1[11];
                acc[10] += w * -0.4879500459f * go[4] * inp1[12];
                acc[11] += w * 0.1543033474f * go[5] * inp1[12];
                acc[12] += w * 0.4364357787f * go[6] * inp1[12];
                acc[13] += w * 0.1543033474f * go[7] * inp1[12];
                acc[14] += w * -0.4879500459f * go[8] * inp1[12];
                acc[9] += w * -0.2439750229f * go[4] * inp1[13];
                acc[10] += w * 0.2988071467f * go[5] * inp1[13];
                acc[11] += w * 0.3779644601f * go[4] * inp1[13];
                acc[12] += w * 0.1543033474f * go[7] * inp1[13];
                acc[13] += w * 0.3273268423f * go[6] * inp1[13];
                acc[13] += w * 0.3779644601f * go[8] * inp1[13];
                acc[14] += w * 0.2988071467f * go[7] * inp1[13];
                acc[15] += w * -0.2439750229f * go[8] * inp1[13];
                acc[9] += w * 0.3857583768f * go[5] * inp1[14];
                acc[11] += w * -0.2988071467f * go[5] * inp1[14];
                acc[12] += w * -0.4879500459f * go[8] * inp1[14];
                acc[13] += w * 0.2988071467f * go[7] * inp1[14];
                acc[15] += w * 0.3857583768f * go[7] * inp1[14];
                acc[10] += w * -0.3857583768f * go[5] * inp1[15];
                acc[11] += w * 0.2439750229f * go[4] * inp1[15];
                acc[13] += w * -0.2439750229f * go[8] * inp1[15];
                acc[14] += w * 0.3857583768f * go[7] * inp1[15];
                acc[15] += w * -0.5455447150f * go[6] * inp1[15];
            }
            // Path 33: (3,3)->3
            {
                const float w = weights[33 * c_in_count * c_out_count + c_in * c_out_count + c_out];
                acc[10] += w * 0.4082483091f * go[11] * inp1[9];
                acc[11] += w * -0.4082483091f * go[10] * inp1[9];
                acc[12] += w * -0.4082483091f * go[15] * inp1[9];
                acc[13] += w * 0.4082483091f * go[14] * inp1[9];
                acc[14] += w * -0.4082483091f * go[13] * inp1[9];
                acc[15] += w * 0.4082483091f * go[12] * inp1[9];
                acc[9] += w * -0.4082483091f * go[11] * inp1[10];
                acc[11] += w * 0.4082483091f * go[9] * inp1[10];
                acc[12] += w * 0.4082483091f * go[14] * inp1[10];
                acc[13] += w * 0.4082483091f * go[15] * inp1[10];
                acc[14] += w * -0.4082483091f * go[12] * inp1[10];
                acc[15] += w * -0.4082483091f * go[13] * inp1[10];
                acc[9] += w * 0.4082483091f * go[10] * inp1[11];
                acc[10] += w * -0.4082483091f * go[9] * inp1[11];
                acc[12] += w * 0.4082483091f * go[13] * inp1[11];
                acc[13] += w * -0.4082483091f * go[12] * inp1[11];
                acc[14] += w * -0.4082483091f * go[15] * inp1[11];
                acc[15] += w * 0.4082483091f * go[14] * inp1[11];
                acc[9] += w * 0.4082483091f * go[15] * inp1[12];
                acc[10] += w * -0.4082483091f * go[14] * inp1[12];
                acc[11] += w * -0.4082483091f * go[13] * inp1[12];
                acc[13] += w * 0.4082483091f * go[11] * inp1[12];
                acc[14] += w * 0.4082483091f * go[10] * inp1[12];
                acc[15] += w * -0.4082483091f * go[9] * inp1[12];
                acc[9] += w * -0.4082483091f * go[14] * inp1[13];
                acc[10] += w * -0.4082483091f * go[15] * inp1[13];
                acc[11] += w * 0.4082483091f * go[12] * inp1[13];
                acc[12] += w * -0.4082483091f * go[11] * inp1[13];
                acc[14] += w * 0.4082483091f * go[9] * inp1[13];
                acc[15] += w * 0.4082483091f * go[10] * inp1[13];
                acc[9] += w * 0.4082483091f * go[13] * inp1[14];
                acc[10] += w * 0.4082483091f * go[12] * inp1[14];
                acc[11] += w * 0.4082483091f * go[15] * inp1[14];
                acc[12] += w * -0.4082483091f * go[10] * inp1[14];
                acc[13] += w * -0.4082483091f * go[9] * inp1[14];
                acc[15] += w * -0.4082483091f * go[11] * inp1[14];
                acc[9] += w * -0.4082483091f * go[12] * inp1[15];
                acc[10] += w * 0.4082483091f * go[13] * inp1[15];
                acc[11] += w * -0.4082483091f * go[14] * inp1[15];
                acc[12] += w * 0.4082483091f * go[9] * inp1[15];
                acc[13] += w * -0.4082483091f * go[10] * inp1[15];
                acc[14] += w * 0.4082483091f * go[11] * inp1[15];
            }
        }
    }

    #pragma unroll
    for (int i = 0; i < 16; i++) {
        grad_in2[i] = acc[i];
    }
}

// Per-pair tensor product backward for grad_input2
// Processes a single (c_in, c_out) pair, accumulates into acc[16]
// This enables parallelization over (c_in, c_out) pairs
__device__ __forceinline__ void tensor_product_backward_input2_per_pair(
    const float* __restrict__ inp1,          // [16] for this c_in
    const float* __restrict__ go,            // [16] for this c_out
    const float* __restrict__ weights,       // [NUM_PATHS, C_in, C_out]
    float* __restrict__ acc,                 // [16] accumulator (caller's local array)
    int c_in,
    int c_out,
    int c_in_count,
    int c_out_count
) {
    // Path 0: (0,0)->0
    {
        const float w = weights[0 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[0] += w * 1.0000000000f * go[0] * inp1[0];
    }
    // Path 1: (0,1)->1
    {
        const float w = weights[1 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[1] += w * 0.9999999821f * go[1] * inp1[0];
        acc[2] += w * 0.9999999821f * go[2] * inp1[0];
        acc[3] += w * 0.9999999821f * go[3] * inp1[0];
    }
    // Path 2: (0,2)->2
    {
        const float w = weights[2 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[4] += w * 0.9999999880f * go[4] * inp1[0];
        acc[5] += w * 0.9999999880f * go[5] * inp1[0];
        acc[6] += w * 0.9999999880f * go[6] * inp1[0];
        acc[7] += w * 0.9999999880f * go[7] * inp1[0];
        acc[8] += w * 0.9999999880f * go[8] * inp1[0];
    }
    // Path 3: (0,3)->3
    {
        const float w = weights[3 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[9] += w * 0.9999999836f * go[9] * inp1[0];
        acc[10] += w * 0.9999999836f * go[10] * inp1[0];
        acc[11] += w * 0.9999999836f * go[11] * inp1[0];
        acc[12] += w * 0.9999999836f * go[12] * inp1[0];
        acc[13] += w * 0.9999999836f * go[13] * inp1[0];
        acc[14] += w * 0.9999999836f * go[14] * inp1[0];
        acc[15] += w * 0.9999999836f * go[15] * inp1[0];
    }
    // Path 4: (1,0)->1
    {
        const float w = weights[4 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[0] += w * 0.9999999821f * go[1] * inp1[1];
        acc[0] += w * 0.9999999821f * go[2] * inp1[2];
        acc[0] += w * 0.9999999821f * go[3] * inp1[3];
    }
    // Path 5: (1,1)->0
    {
        const float w = weights[5 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[1] += w * 0.5773502588f * go[0] * inp1[1];
        acc[2] += w * 0.5773502588f * go[0] * inp1[2];
        acc[3] += w * 0.5773502588f * go[0] * inp1[3];
    }
    // Path 6: (1,1)->1
    {
        const float w = weights[6 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[2] += w * 0.7071068069f * go[3] * inp1[1];
        acc[3] += w * -0.7071068069f * go[2] * inp1[1];
        acc[1] += w * -0.7071068069f * go[3] * inp1[2];
        acc[3] += w * 0.7071068069f * go[1] * inp1[2];
        acc[1] += w * 0.7071068069f * go[2] * inp1[3];
        acc[2] += w * -0.7071068069f * go[1] * inp1[3];
    }
    // Path 7: (1,1)->2
    {
        const float w = weights[7 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[1] += w * -0.4082482836f * go[6] * inp1[1];
        acc[1] += w * -0.7071067764f * go[8] * inp1[1];
        acc[2] += w * 0.7071067764f * go[5] * inp1[1];
        acc[3] += w * 0.7071067764f * go[4] * inp1[1];
        acc[1] += w * 0.7071067764f * go[5] * inp1[2];
        acc[2] += w * 0.8164965671f * go[6] * inp1[2];
        acc[3] += w * 0.7071067764f * go[7] * inp1[2];
        acc[1] += w * 0.7071067764f * go[4] * inp1[3];
        acc[2] += w * 0.7071067764f * go[7] * inp1[3];
        acc[3] += w * -0.4082482836f * go[6] * inp1[3];
        acc[3] += w * 0.7071067764f * go[8] * inp1[3];
    }
    // Path 8: (1,2)->1
    {
        const float w = weights[8 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[4] += w * 0.5477225538f * go[3] * inp1[1];
        acc[5] += w * 0.5477225538f * go[2] * inp1[1];
        acc[6] += w * -0.3162277607f * go[1] * inp1[1];
        acc[8] += w * -0.5477225538f * go[1] * inp1[1];
        acc[5] += w * 0.5477225538f * go[1] * inp1[2];
        acc[6] += w * 0.6324555213f * go[2] * inp1[2];
        acc[7] += w * 0.5477225538f * go[3] * inp1[2];
        acc[4] += w * 0.5477225538f * go[1] * inp1[3];
        acc[6] += w * -0.3162277607f * go[3] * inp1[3];
        acc[7] += w * 0.5477225538f * go[2] * inp1[3];
        acc[8] += w * 0.5477225538f * go[3] * inp1[3];
    }
    // Path 9: (1,2)->2
    {
        const float w = weights[9 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[4] += w * -0.4082482836f * go[5] * inp1[1];
        acc[5] += w * 0.4082482836f * go[4] * inp1[1];
        acc[6] += w * 0.7071067764f * go[7] * inp1[1];
        acc[7] += w * -0.7071067764f * go[6] * inp1[1];
        acc[7] += w * 0.4082482836f * go[8] * inp1[1];
        acc[8] += w * -0.4082482836f * go[7] * inp1[1];
        acc[4] += w * -0.8164965671f * go[8] * inp1[2];
        acc[5] += w * -0.4082482836f * go[7] * inp1[2];
        acc[7] += w * 0.4082482836f * go[5] * inp1[2];
        acc[8] += w * 0.8164965671f * go[4] * inp1[2];
        acc[4] += w * 0.4082482836f * go[7] * inp1[3];
        acc[5] += w * 0.7071067764f * go[6] * inp1[3];
        acc[5] += w * 0.4082482836f * go[8] * inp1[3];
        acc[6] += w * -0.7071067764f * go[5] * inp1[3];
        acc[7] += w * -0.4082482836f * go[4] * inp1[3];
        acc[8] += w * -0.4082482836f * go[5] * inp1[3];
    }
    // Path 10: (1,2)->3
    {
        const float w = weights[10 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[4] += w * -0.1825741828f * go[13] * inp1[1];
        acc[4] += w * -0.7071067679f * go[15] * inp1[1];
        acc[5] += w * -0.4472135802f * go[12] * inp1[1];
        acc[5] += w * -0.5773502803f * go[14] * inp1[1];
        acc[6] += w * 0.6324555384f * go[11] * inp1[1];
        acc[7] += w * 0.5773502803f * go[10] * inp1[1];
        acc[8] += w * 0.7071067679f * go[9] * inp1[1];
        acc[8] += w * 0.1825741828f * go[11] * inp1[1];
        acc[4] += w * 0.5773502803f * go[10] * inp1[2];
        acc[5] += w * 0.7302967312f * go[11] * inp1[2];
        acc[6] += w * 0.7745966857f * go[12] * inp1[2];
        acc[7] += w * 0.7302967312f * go[13] * inp1[2];
        acc[8] += w * 0.5773502803f * go[14] * inp1[2];
        acc[4] += w * 0.7071067679f * go[9] * inp1[3];
        acc[4] += w * -0.1825741828f * go[11] * inp1[3];
        acc[5] += w * 0.5773502803f * go[10] * inp1[3];
        acc[6] += w * 0.6324555384f * go[13] * inp1[3];
        acc[7] += w * -0.4472135802f * go[12] * inp1[3];
        acc[7] += w * 0.5773502803f * go[14] * inp1[3];
        acc[8] += w * -0.1825741828f * go[13] * inp1[3];
        acc[8] += w * 0.7071067679f * go[15] * inp1[3];
    }
    // Path 11: (1,3)->2
    {
        const float w = weights[11 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[9] += w * 0.5976142935f * go[8] * inp1[1];
        acc[10] += w * 0.4879500459f * go[7] * inp1[1];
        acc[11] += w * 0.5345224892f * go[6] * inp1[1];
        acc[11] += w * 0.1543033474f * go[8] * inp1[1];
        acc[12] += w * -0.3779644601f * go[5] * inp1[1];
        acc[13] += w * -0.1543033474f * go[4] * inp1[1];
        acc[14] += w * -0.4879500459f * go[5] * inp1[1];
        acc[15] += w * -0.5976142935f * go[4] * inp1[1];
        acc[10] += w * 0.4879500459f * go[4] * inp1[2];
        acc[11] += w * 0.6172133895f * go[5] * inp1[2];
        acc[12] += w * 0.6546536846f * go[6] * inp1[2];
        acc[13] += w * 0.6172133895f * go[7] * inp1[2];
        acc[14] += w * 0.4879500459f * go[8] * inp1[2];
        acc[9] += w * 0.5976142935f * go[4] * inp1[3];
        acc[10] += w * 0.4879500459f * go[5] * inp1[3];
        acc[11] += w * -0.1543033474f * go[4] * inp1[3];
        acc[12] += w * -0.3779644601f * go[7] * inp1[3];
        acc[13] += w * 0.5345224892f * go[6] * inp1[3];
        acc[13] += w * -0.1543033474f * go[8] * inp1[3];
        acc[14] += w * 0.4879500459f * go[7] * inp1[3];
        acc[15] += w * 0.5976142935f * go[8] * inp1[3];
    }
    // Path 12: (1,3)->3
    {
        const float w = weights[12 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[9] += w * -0.3535533840f * go[10] * inp1[1];
        acc[10] += w * 0.3535533840f * go[9] * inp1[1];
        acc[10] += w * -0.4564354668f * go[11] * inp1[1];
        acc[11] += w * 0.4564354668f * go[10] * inp1[1];
        acc[12] += w * 0.7071067679f * go[13] * inp1[1];
        acc[13] += w * -0.7071067679f * go[12] * inp1[1];
        acc[13] += w * 0.4564354668f * go[14] * inp1[1];
        acc[14] += w * -0.4564354668f * go[13] * inp1[1];
        acc[14] += w * 0.3535533840f * go[15] * inp1[1];
        acc[15] += w * -0.3535533840f * go[14] * inp1[1];
        acc[9] += w * -0.8660254007f * go[15] * inp1[2];
        acc[10] += w * -0.5773502803f * go[14] * inp1[2];
        acc[11] += w * -0.2886751401f * go[13] * inp1[2];
        acc[13] += w * 0.2886751401f * go[11] * inp1[2];
        acc[14] += w * 0.5773502803f * go[10] * inp1[2];
        acc[15] += w * 0.8660254007f * go[9] * inp1[2];
        acc[9] += w * 0.3535533840f * go[14] * inp1[3];
        acc[10] += w * 0.4564354668f * go[13] * inp1[3];
        acc[10] += w * 0.3535533840f * go[15] * inp1[3];
        acc[11] += w * 0.7071067679f * go[12] * inp1[3];
        acc[11] += w * 0.4564354668f * go[14] * inp1[3];
        acc[12] += w * -0.7071067679f * go[11] * inp1[3];
        acc[13] += w * -0.4564354668f * go[10] * inp1[3];
        acc[14] += w * -0.3535533840f * go[9] * inp1[3];
        acc[14] += w * -0.4564354668f * go[11] * inp1[3];
        acc[15] += w * -0.3535533840f * go[10] * inp1[3];
    }
    // Path 13: (2,0)->2
    {
        const float w = weights[13 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[0] += w * 0.9999999880f * go[4] * inp1[4];
        acc[0] += w * 0.9999999880f * go[5] * inp1[5];
        acc[0] += w * 0.9999999880f * go[6] * inp1[6];
        acc[0] += w * 0.9999999880f * go[7] * inp1[7];
        acc[0] += w * 0.9999999880f * go[8] * inp1[8];
    }
    // Path 14: (2,1)->1
    {
        const float w = weights[14 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[1] += w * 0.5477225538f * go[3] * inp1[4];
        acc[3] += w * 0.5477225538f * go[1] * inp1[4];
        acc[1] += w * 0.5477225538f * go[2] * inp1[5];
        acc[2] += w * 0.5477225538f * go[1] * inp1[5];
        acc[1] += w * -0.3162277607f * go[1] * inp1[6];
        acc[2] += w * 0.6324555213f * go[2] * inp1[6];
        acc[3] += w * -0.3162277607f * go[3] * inp1[6];
        acc[2] += w * 0.5477225538f * go[3] * inp1[7];
        acc[3] += w * 0.5477225538f * go[2] * inp1[7];
        acc[1] += w * -0.5477225538f * go[1] * inp1[8];
        acc[3] += w * 0.5477225538f * go[3] * inp1[8];
    }
    // Path 15: (2,1)->2
    {
        const float w = weights[15 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[1] += w * 0.4082482836f * go[5] * inp1[4];
        acc[2] += w * 0.8164965671f * go[8] * inp1[4];
        acc[3] += w * -0.4082482836f * go[7] * inp1[4];
        acc[1] += w * -0.4082482836f * go[4] * inp1[5];
        acc[2] += w * 0.4082482836f * go[7] * inp1[5];
        acc[3] += w * -0.7071067764f * go[6] * inp1[5];
        acc[3] += w * -0.4082482836f * go[8] * inp1[5];
        acc[1] += w * -0.7071067764f * go[7] * inp1[6];
        acc[3] += w * 0.7071067764f * go[5] * inp1[6];
        acc[1] += w * 0.7071067764f * go[6] * inp1[7];
        acc[1] += w * -0.4082482836f * go[8] * inp1[7];
        acc[2] += w * -0.4082482836f * go[5] * inp1[7];
        acc[3] += w * 0.4082482836f * go[4] * inp1[7];
        acc[1] += w * 0.4082482836f * go[7] * inp1[8];
        acc[2] += w * -0.8164965671f * go[4] * inp1[8];
        acc[3] += w * 0.4082482836f * go[5] * inp1[8];
    }
    // Path 16: (2,1)->3
    {
        const float w = weights[16 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[1] += w * -0.1825741828f * go[13] * inp1[4];
        acc[1] += w * -0.7071067679f * go[15] * inp1[4];
        acc[2] += w * 0.5773502803f * go[10] * inp1[4];
        acc[3] += w * 0.7071067679f * go[9] * inp1[4];
        acc[3] += w * -0.1825741828f * go[11] * inp1[4];
        acc[1] += w * -0.4472135802f * go[12] * inp1[5];
        acc[1] += w * -0.5773502803f * go[14] * inp1[5];
        acc[2] += w * 0.7302967312f * go[11] * inp1[5];
        acc[3] += w * 0.5773502803f * go[10] * inp1[5];
        acc[1] += w * 0.6324555384f * go[11] * inp1[6];
        acc[2] += w * 0.7745966857f * go[12] * inp1[6];
        acc[3] += w * 0.6324555384f * go[13] * inp1[6];
        acc[1] += w * 0.5773502803f * go[10] * inp1[7];
        acc[2] += w * 0.7302967312f * go[13] * inp1[7];
        acc[3] += w * -0.4472135802f * go[12] * inp1[7];
        acc[3] += w * 0.5773502803f * go[14] * inp1[7];
        acc[1] += w * 0.7071067679f * go[9] * inp1[8];
        acc[1] += w * 0.1825741828f * go[11] * inp1[8];
        acc[2] += w * 0.5773502803f * go[14] * inp1[8];
        acc[3] += w * -0.1825741828f * go[13] * inp1[8];
        acc[3] += w * 0.7071067679f * go[15] * inp1[8];
    }
    // Path 17: (2,2)->0
    {
        const float w = weights[17 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[4] += w * 0.4472135901f * go[0] * inp1[4];
        acc[5] += w * 0.4472135901f * go[0] * inp1[5];
        acc[6] += w * 0.4472135901f * go[0] * inp1[6];
        acc[7] += w * 0.4472135901f * go[0] * inp1[7];
        acc[8] += w * 0.4472135901f * go[0] * inp1[8];
    }
    // Path 18: (2,2)->1
    {
        const float w = weights[18 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[5] += w * -0.3162277607f * go[1] * inp1[4];
        acc[7] += w * 0.3162277607f * go[3] * inp1[4];
        acc[8] += w * -0.6324555213f * go[2] * inp1[4];
        acc[4] += w * 0.3162277607f * go[1] * inp1[5];
        acc[6] += w * 0.5477225538f * go[3] * inp1[5];
        acc[7] += w * -0.3162277607f * go[2] * inp1[5];
        acc[8] += w * 0.3162277607f * go[3] * inp1[5];
        acc[5] += w * -0.5477225538f * go[3] * inp1[6];
        acc[7] += w * 0.5477225538f * go[1] * inp1[6];
        acc[4] += w * -0.3162277607f * go[3] * inp1[7];
        acc[5] += w * 0.3162277607f * go[2] * inp1[7];
        acc[6] += w * -0.5477225538f * go[1] * inp1[7];
        acc[8] += w * 0.3162277607f * go[1] * inp1[7];
        acc[4] += w * 0.6324555213f * go[2] * inp1[8];
        acc[5] += w * -0.3162277607f * go[3] * inp1[8];
        acc[7] += w * -0.3162277607f * go[1] * inp1[8];
    }
    // Path 19: (2,2)->2
    {
        const float w = weights[19 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[4] += w * -0.5345224892f * go[6] * inp1[4];
        acc[5] += w * 0.4629100588f * go[7] * inp1[4];
        acc[6] += w * -0.5345224892f * go[4] * inp1[4];
        acc[7] += w * 0.4629100588f * go[5] * inp1[4];
        acc[4] += w * 0.4629100588f * go[7] * inp1[5];
        acc[5] += w * 0.2672612446f * go[6] * inp1[5];
        acc[5] += w * -0.4629100588f * go[8] * inp1[5];
        acc[6] += w * 0.2672612446f * go[5] * inp1[5];
        acc[7] += w * 0.4629100588f * go[4] * inp1[5];
        acc[8] += w * -0.4629100588f * go[5] * inp1[5];
        acc[4] += w * -0.5345224892f * go[4] * inp1[6];
        acc[5] += w * 0.2672612446f * go[5] * inp1[6];
        acc[6] += w * 0.5345224892f * go[6] * inp1[6];
        acc[7] += w * 0.2672612446f * go[7] * inp1[6];
        acc[8] += w * -0.5345224892f * go[8] * inp1[6];
        acc[4] += w * 0.4629100588f * go[5] * inp1[7];
        acc[5] += w * 0.4629100588f * go[4] * inp1[7];
        acc[6] += w * 0.2672612446f * go[7] * inp1[7];
        acc[7] += w * 0.2672612446f * go[6] * inp1[7];
        acc[7] += w * 0.4629100588f * go[8] * inp1[7];
        acc[8] += w * 0.4629100588f * go[7] * inp1[7];
        acc[5] += w * -0.4629100588f * go[5] * inp1[8];
        acc[6] += w * -0.5345224892f * go[8] * inp1[8];
        acc[7] += w * 0.4629100588f * go[7] * inp1[8];
        acc[8] += w * -0.5345224892f * go[6] * inp1[8];
    }
    // Path 20: (2,2)->3
    {
        const float w = weights[20 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[5] += w * 0.4999999918f * go[9] * inp1[4];
        acc[5] += w * 0.3872983429f * go[11] * inp1[4];
        acc[6] += w * 0.7071067679f * go[14] * inp1[4];
        acc[7] += w * -0.3872983429f * go[13] * inp1[4];
        acc[7] += w * 0.4999999918f * go[15] * inp1[4];
        acc[8] += w * 0.3162277692f * go[12] * inp1[4];
        acc[4] += w * -0.4999999918f * go[9] * inp1[5];
        acc[4] += w * -0.3872983429f * go[11] * inp1[5];
        acc[6] += w * 0.4472135802f * go[13] * inp1[5];
        acc[7] += w * -0.6324555384f * go[12] * inp1[5];
        acc[8] += w * -0.3872983429f * go[13] * inp1[5];
        acc[8] += w * -0.4999999918f * go[15] * inp1[5];
        acc[4] += w * -0.7071067679f * go[14] * inp1[6];
        acc[5] += w * -0.4472135802f * go[13] * inp1[6];
        acc[7] += w * 0.4472135802f * go[11] * inp1[6];
        acc[8] += w * 0.7071067679f * go[10] * inp1[6];
        acc[4] += w * 0.3872983429f * go[13] * inp1[7];
        acc[4] += w * -0.4999999918f * go[15] * inp1[7];
        acc[5] += w * 0.6324555384f * go[12] * inp1[7];
        acc[6] += w * -0.4472135802f * go[11] * inp1[7];
        acc[8] += w * 0.4999999918f * go[9] * inp1[7];
        acc[8] += w * -0.3872983429f * go[11] * inp1[7];
        acc[4] += w * -0.3162277692f * go[12] * inp1[8];
        acc[5] += w * 0.3872983429f * go[13] * inp1[8];
        acc[5] += w * 0.4999999918f * go[15] * inp1[8];
        acc[6] += w * -0.7071067679f * go[10] * inp1[8];
        acc[7] += w * -0.4999999918f * go[9] * inp1[8];
        acc[7] += w * 0.3872983429f * go[11] * inp1[8];
    }
    // Path 21: (2,3)->1
    {
        const float w = weights[21 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[9] += w * 0.4629100412f * go[3] * inp1[4];
        acc[10] += w * 0.3779644803f * go[2] * inp1[4];
        acc[11] += w * -0.1195228589f * go[3] * inp1[4];
        acc[13] += w * -0.1195228589f * go[1] * inp1[4];
        acc[15] += w * -0.4629100412f * go[1] * inp1[4];
        acc[10] += w * 0.3779644803f * go[3] * inp1[5];
        acc[11] += w * 0.4780914358f * go[2] * inp1[5];
        acc[12] += w * -0.2927700119f * go[1] * inp1[5];
        acc[14] += w * -0.3779644803f * go[1] * inp1[5];
        acc[11] += w * 0.4140393398f * go[1] * inp1[6];
        acc[12] += w * 0.5070925636f * go[2] * inp1[6];
        acc[13] += w * 0.4140393398f * go[3] * inp1[6];
        acc[10] += w * 0.3779644803f * go[1] * inp1[7];
        acc[12] += w * -0.2927700119f * go[3] * inp1[7];
        acc[13] += w * 0.4780914358f * go[2] * inp1[7];
        acc[14] += w * 0.3779644803f * go[3] * inp1[7];
        acc[9] += w * 0.4629100412f * go[1] * inp1[8];
        acc[11] += w * 0.1195228589f * go[1] * inp1[8];
        acc[13] += w * -0.1195228589f * go[3] * inp1[8];
        acc[14] += w * 0.3779644803f * go[2] * inp1[8];
        acc[15] += w * 0.4629100412f * go[3] * inp1[8];
    }
    // Path 22: (2,3)->2
    {
        const float w = weights[22 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[9] += w * -0.4225771204f * go[5] * inp1[4];
        acc[11] += w * -0.3273268423f * go[5] * inp1[4];
        acc[12] += w * -0.2672612446f * go[8] * inp1[4];
        acc[13] += w * 0.3273268423f * go[7] * inp1[4];
        acc[14] += w * -0.5976142935f * go[6] * inp1[4];
        acc[15] += w * -0.4225771204f * go[7] * inp1[4];
        acc[9] += w * 0.4225771204f * go[4] * inp1[5];
        acc[11] += w * 0.3273268423f * go[4] * inp1[5];
        acc[12] += w * 0.5345224892f * go[7] * inp1[5];
        acc[13] += w * -0.3779644601f * go[6] * inp1[5];
        acc[13] += w * 0.3273268423f * go[8] * inp1[5];
        acc[15] += w * 0.4225771204f * go[8] * inp1[5];
        acc[10] += w * -0.5976142935f * go[8] * inp1[6];
        acc[11] += w * -0.3779644601f * go[7] * inp1[6];
        acc[13] += w * 0.3779644601f * go[5] * inp1[6];
        acc[14] += w * 0.5976142935f * go[4] * inp1[6];
        acc[9] += w * -0.4225771204f * go[8] * inp1[7];
        acc[11] += w * 0.3779644601f * go[6] * inp1[7];
        acc[11] += w * 0.3273268423f * go[8] * inp1[7];
        acc[12] += w * -0.5345224892f * go[5] * inp1[7];
        acc[13] += w * -0.3273268423f * go[4] * inp1[7];
        acc[15] += w * 0.4225771204f * go[4] * inp1[7];
        acc[9] += w * 0.4225771204f * go[7] * inp1[8];
        acc[10] += w * 0.5976142935f * go[6] * inp1[8];
        acc[11] += w * -0.3273268423f * go[7] * inp1[8];
        acc[12] += w * 0.2672612446f * go[4] * inp1[8];
        acc[13] += w * -0.3273268423f * go[5] * inp1[8];
        acc[15] += w * -0.4225771204f * go[5] * inp1[8];
    }
    // Path 23: (2,3)->3
    {
        const float w = weights[23 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[9] += w * -0.2886751401f * go[13] * inp1[4];
        acc[10] += w * -0.5773502803f * go[12] * inp1[4];
        acc[11] += w * 0.4472135802f * go[13] * inp1[4];
        acc[11] += w * 0.2886751401f * go[15] * inp1[4];
        acc[12] += w * -0.5773502803f * go[10] * inp1[4];
        acc[13] += w * -0.2886751401f * go[9] * inp1[4];
        acc[13] += w * 0.4472135802f * go[11] * inp1[4];
        acc[15] += w * 0.2886751401f * go[11] * inp1[4];
        acc[9] += w * 0.4564354668f * go[14] * inp1[5];
        acc[10] += w * 0.3535533840f * go[13] * inp1[5];
        acc[10] += w * -0.4564354668f * go[15] * inp1[5];
        acc[11] += w * 0.1825741828f * go[12] * inp1[5];
        acc[11] += w * -0.3535533840f * go[14] * inp1[5];
        acc[12] += w * 0.1825741828f * go[11] * inp1[5];
        acc[13] += w * 0.3535533840f * go[10] * inp1[5];
        acc[14] += w * 0.4564354668f * go[9] * inp1[5];
        acc[14] += w * -0.3535533840f * go[11] * inp1[5];
        acc[15] += w * -0.4564354668f * go[10] * inp1[5];
        acc[9] += w * -0.6454972118f * go[9] * inp1[6];
        acc[11] += w * 0.3872983429f * go[11] * inp1[6];
        acc[12] += w * 0.5163977773f * go[12] * inp1[6];
        acc[13] += w * 0.3872983429f * go[13] * inp1[6];
        acc[15] += w * -0.6454972118f * go[15] * inp1[6];
        acc[9] += w * 0.4564354668f * go[10] * inp1[7];
        acc[10] += w * 0.4564354668f * go[9] * inp1[7];
        acc[10] += w * 0.3535533840f * go[11] * inp1[7];
        acc[11] += w * 0.3535533840f * go[10] * inp1[7];
        acc[12] += w * 0.1825741828f * go[13] * inp1[7];
        acc[13] += w * 0.1825741828f * go[12] * inp1[7];
        acc[13] += w * 0.3535533840f * go[14] * inp1[7];
        acc[14] += w * 0.3535533840f * go[13] * inp1[7];
        acc[14] += w * 0.4564354668f * go[15] * inp1[7];
        acc[15] += w * 0.4564354668f * go[14] * inp1[7];
        acc[9] += w * -0.2886751401f * go[11] * inp1[8];
        acc[11] += w * -0.2886751401f * go[9] * inp1[8];
        acc[11] += w * -0.4472135802f * go[11] * inp1[8];
        acc[12] += w * -0.5773502803f * go[14] * inp1[8];
        acc[13] += w * 0.4472135802f * go[13] * inp1[8];
        acc[13] += w * -0.2886751401f * go[15] * inp1[8];
        acc[14] += w * -0.5773502803f * go[12] * inp1[8];
        acc[15] += w * -0.2886751401f * go[13] * inp1[8];
    }
    // Path 24: (3,0)->3
    {
        const float w = weights[24 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[0] += w * 0.9999999836f * go[9] * inp1[9];
        acc[0] += w * 0.9999999836f * go[10] * inp1[10];
        acc[0] += w * 0.9999999836f * go[11] * inp1[11];
        acc[0] += w * 0.9999999836f * go[12] * inp1[12];
        acc[0] += w * 0.9999999836f * go[13] * inp1[13];
        acc[0] += w * 0.9999999836f * go[14] * inp1[14];
        acc[0] += w * 0.9999999836f * go[15] * inp1[15];
    }
    // Path 25: (3,1)->2
    {
        const float w = weights[25 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[1] += w * 0.5976142935f * go[8] * inp1[9];
        acc[3] += w * 0.5976142935f * go[4] * inp1[9];
        acc[1] += w * 0.4879500459f * go[7] * inp1[10];
        acc[2] += w * 0.4879500459f * go[4] * inp1[10];
        acc[3] += w * 0.4879500459f * go[5] * inp1[10];
        acc[1] += w * 0.5345224892f * go[6] * inp1[11];
        acc[1] += w * 0.1543033474f * go[8] * inp1[11];
        acc[2] += w * 0.6172133895f * go[5] * inp1[11];
        acc[3] += w * -0.1543033474f * go[4] * inp1[11];
        acc[1] += w * -0.3779644601f * go[5] * inp1[12];
        acc[2] += w * 0.6546536846f * go[6] * inp1[12];
        acc[3] += w * -0.3779644601f * go[7] * inp1[12];
        acc[1] += w * -0.1543033474f * go[4] * inp1[13];
        acc[2] += w * 0.6172133895f * go[7] * inp1[13];
        acc[3] += w * 0.5345224892f * go[6] * inp1[13];
        acc[3] += w * -0.1543033474f * go[8] * inp1[13];
        acc[1] += w * -0.4879500459f * go[5] * inp1[14];
        acc[2] += w * 0.4879500459f * go[8] * inp1[14];
        acc[3] += w * 0.4879500459f * go[7] * inp1[14];
        acc[1] += w * -0.5976142935f * go[4] * inp1[15];
        acc[3] += w * 0.5976142935f * go[8] * inp1[15];
    }
    // Path 26: (3,1)->3
    {
        const float w = weights[26 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[1] += w * 0.3535533840f * go[10] * inp1[9];
        acc[2] += w * 0.8660254007f * go[15] * inp1[9];
        acc[3] += w * -0.3535533840f * go[14] * inp1[9];
        acc[1] += w * -0.3535533840f * go[9] * inp1[10];
        acc[1] += w * 0.4564354668f * go[11] * inp1[10];
        acc[2] += w * 0.5773502803f * go[14] * inp1[10];
        acc[3] += w * -0.4564354668f * go[13] * inp1[10];
        acc[3] += w * -0.3535533840f * go[15] * inp1[10];
        acc[1] += w * -0.4564354668f * go[10] * inp1[11];
        acc[2] += w * 0.2886751401f * go[13] * inp1[11];
        acc[3] += w * -0.7071067679f * go[12] * inp1[11];
        acc[3] += w * -0.4564354668f * go[14] * inp1[11];
        acc[1] += w * -0.7071067679f * go[13] * inp1[12];
        acc[3] += w * 0.7071067679f * go[11] * inp1[12];
        acc[1] += w * 0.7071067679f * go[12] * inp1[13];
        acc[1] += w * -0.4564354668f * go[14] * inp1[13];
        acc[2] += w * -0.2886751401f * go[11] * inp1[13];
        acc[3] += w * 0.4564354668f * go[10] * inp1[13];
        acc[1] += w * 0.4564354668f * go[13] * inp1[14];
        acc[1] += w * -0.3535533840f * go[15] * inp1[14];
        acc[2] += w * -0.5773502803f * go[10] * inp1[14];
        acc[3] += w * 0.3535533840f * go[9] * inp1[14];
        acc[3] += w * 0.4564354668f * go[11] * inp1[14];
        acc[1] += w * 0.3535533840f * go[14] * inp1[15];
        acc[2] += w * -0.8660254007f * go[9] * inp1[15];
        acc[3] += w * 0.3535533840f * go[10] * inp1[15];
    }
    // Path 27: (3,2)->1
    {
        const float w = weights[27 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[4] += w * 0.4629100412f * go[3] * inp1[9];
        acc[8] += w * 0.4629100412f * go[1] * inp1[9];
        acc[4] += w * 0.3779644803f * go[2] * inp1[10];
        acc[5] += w * 0.3779644803f * go[3] * inp1[10];
        acc[7] += w * 0.3779644803f * go[1] * inp1[10];
        acc[4] += w * -0.1195228589f * go[3] * inp1[11];
        acc[5] += w * 0.4780914358f * go[2] * inp1[11];
        acc[6] += w * 0.4140393398f * go[1] * inp1[11];
        acc[8] += w * 0.1195228589f * go[1] * inp1[11];
        acc[5] += w * -0.2927700119f * go[1] * inp1[12];
        acc[6] += w * 0.5070925636f * go[2] * inp1[12];
        acc[7] += w * -0.2927700119f * go[3] * inp1[12];
        acc[4] += w * -0.1195228589f * go[1] * inp1[13];
        acc[6] += w * 0.4140393398f * go[3] * inp1[13];
        acc[7] += w * 0.4780914358f * go[2] * inp1[13];
        acc[8] += w * -0.1195228589f * go[3] * inp1[13];
        acc[5] += w * -0.3779644803f * go[1] * inp1[14];
        acc[7] += w * 0.3779644803f * go[3] * inp1[14];
        acc[8] += w * 0.3779644803f * go[2] * inp1[14];
        acc[4] += w * -0.4629100412f * go[1] * inp1[15];
        acc[8] += w * 0.4629100412f * go[3] * inp1[15];
    }
    // Path 28: (3,2)->2
    {
        const float w = weights[28 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[4] += w * 0.4225771204f * go[5] * inp1[9];
        acc[5] += w * -0.4225771204f * go[4] * inp1[9];
        acc[7] += w * 0.4225771204f * go[8] * inp1[9];
        acc[8] += w * -0.4225771204f * go[7] * inp1[9];
        acc[6] += w * 0.5976142935f * go[8] * inp1[10];
        acc[8] += w * -0.5976142935f * go[6] * inp1[10];
        acc[4] += w * 0.3273268423f * go[5] * inp1[11];
        acc[5] += w * -0.3273268423f * go[4] * inp1[11];
        acc[6] += w * 0.3779644601f * go[7] * inp1[11];
        acc[7] += w * -0.3779644601f * go[6] * inp1[11];
        acc[7] += w * -0.3273268423f * go[8] * inp1[11];
        acc[8] += w * 0.3273268423f * go[7] * inp1[11];
        acc[4] += w * 0.2672612446f * go[8] * inp1[12];
        acc[5] += w * -0.5345224892f * go[7] * inp1[12];
        acc[7] += w * 0.5345224892f * go[5] * inp1[12];
        acc[8] += w * -0.2672612446f * go[4] * inp1[12];
        acc[4] += w * -0.3273268423f * go[7] * inp1[13];
        acc[5] += w * 0.3779644601f * go[6] * inp1[13];
        acc[5] += w * -0.3273268423f * go[8] * inp1[13];
        acc[6] += w * -0.3779644601f * go[5] * inp1[13];
        acc[7] += w * 0.3273268423f * go[4] * inp1[13];
        acc[8] += w * 0.3273268423f * go[5] * inp1[13];
        acc[4] += w * 0.5976142935f * go[6] * inp1[14];
        acc[6] += w * -0.5976142935f * go[4] * inp1[14];
        acc[4] += w * 0.4225771204f * go[7] * inp1[15];
        acc[5] += w * -0.4225771204f * go[8] * inp1[15];
        acc[7] += w * -0.4225771204f * go[4] * inp1[15];
        acc[8] += w * 0.4225771204f * go[5] * inp1[15];
    }
    // Path 29: (3,2)->3
    {
        const float w = weights[29 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[4] += w * -0.2886751401f * go[13] * inp1[9];
        acc[5] += w * 0.4564354668f * go[14] * inp1[9];
        acc[6] += w * -0.6454972118f * go[9] * inp1[9];
        acc[7] += w * 0.4564354668f * go[10] * inp1[9];
        acc[8] += w * -0.2886751401f * go[11] * inp1[9];
        acc[4] += w * -0.5773502803f * go[12] * inp1[10];
        acc[5] += w * 0.3535533840f * go[13] * inp1[10];
        acc[5] += w * -0.4564354668f * go[15] * inp1[10];
        acc[7] += w * 0.4564354668f * go[9] * inp1[10];
        acc[7] += w * 0.3535533840f * go[11] * inp1[10];
        acc[4] += w * 0.4472135802f * go[13] * inp1[11];
        acc[4] += w * 0.2886751401f * go[15] * inp1[11];
        acc[5] += w * 0.1825741828f * go[12] * inp1[11];
        acc[5] += w * -0.3535533840f * go[14] * inp1[11];
        acc[6] += w * 0.3872983429f * go[11] * inp1[11];
        acc[7] += w * 0.3535533840f * go[10] * inp1[11];
        acc[8] += w * -0.2886751401f * go[9] * inp1[11];
        acc[8] += w * -0.4472135802f * go[11] * inp1[11];
        acc[4] += w * -0.5773502803f * go[10] * inp1[12];
        acc[5] += w * 0.1825741828f * go[11] * inp1[12];
        acc[6] += w * 0.5163977773f * go[12] * inp1[12];
        acc[7] += w * 0.1825741828f * go[13] * inp1[12];
        acc[8] += w * -0.5773502803f * go[14] * inp1[12];
        acc[4] += w * -0.2886751401f * go[9] * inp1[13];
        acc[4] += w * 0.4472135802f * go[11] * inp1[13];
        acc[5] += w * 0.3535533840f * go[10] * inp1[13];
        acc[6] += w * 0.3872983429f * go[13] * inp1[13];
        acc[7] += w * 0.1825741828f * go[12] * inp1[13];
        acc[7] += w * 0.3535533840f * go[14] * inp1[13];
        acc[8] += w * 0.4472135802f * go[13] * inp1[13];
        acc[8] += w * -0.2886751401f * go[15] * inp1[13];
        acc[5] += w * 0.4564354668f * go[9] * inp1[14];
        acc[5] += w * -0.3535533840f * go[11] * inp1[14];
        acc[7] += w * 0.3535533840f * go[13] * inp1[14];
        acc[7] += w * 0.4564354668f * go[15] * inp1[14];
        acc[8] += w * -0.5773502803f * go[12] * inp1[14];
        acc[4] += w * 0.2886751401f * go[11] * inp1[15];
        acc[5] += w * -0.4564354668f * go[10] * inp1[15];
        acc[6] += w * -0.6454972118f * go[15] * inp1[15];
        acc[7] += w * 0.4564354668f * go[14] * inp1[15];
        acc[8] += w * -0.2886751401f * go[13] * inp1[15];
    }
    // Path 30: (3,3)->0
    {
        const float w = weights[30 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[9] += w * 0.3779644668f * go[0] * inp1[9];
        acc[10] += w * 0.3779644668f * go[0] * inp1[10];
        acc[11] += w * 0.3779644668f * go[0] * inp1[11];
        acc[12] += w * 0.3779644668f * go[0] * inp1[12];
        acc[13] += w * 0.3779644668f * go[0] * inp1[13];
        acc[14] += w * 0.3779644668f * go[0] * inp1[14];
        acc[15] += w * 0.3779644668f * go[0] * inp1[15];
    }
    // Path 31: (3,3)->1
    {
        const float w = weights[31 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[10] += w * -0.2314550206f * go[1] * inp1[9];
        acc[14] += w * 0.2314550206f * go[3] * inp1[9];
        acc[15] += w * -0.5669467075f * go[2] * inp1[9];
        acc[9] += w * 0.2314550206f * go[1] * inp1[10];
        acc[11] += w * -0.2988071538f * go[1] * inp1[10];
        acc[13] += w * 0.2988071538f * go[3] * inp1[10];
        acc[14] += w * -0.3779644803f * go[2] * inp1[10];
        acc[15] += w * 0.2314550206f * go[3] * inp1[10];
        acc[10] += w * 0.2988071538f * go[1] * inp1[11];
        acc[12] += w * 0.4629100412f * go[3] * inp1[11];
        acc[13] += w * -0.1889822401f * go[2] * inp1[11];
        acc[14] += w * 0.2988071538f * go[3] * inp1[11];
        acc[11] += w * -0.4629100412f * go[3] * inp1[12];
        acc[13] += w * 0.4629100412f * go[1] * inp1[12];
        acc[10] += w * -0.2988071538f * go[3] * inp1[13];
        acc[11] += w * 0.1889822401f * go[2] * inp1[13];
        acc[12] += w * -0.4629100412f * go[1] * inp1[13];
        acc[14] += w * 0.2988071538f * go[1] * inp1[13];
        acc[9] += w * -0.2314550206f * go[3] * inp1[14];
        acc[10] += w * 0.3779644803f * go[2] * inp1[14];
        acc[11] += w * -0.2988071538f * go[3] * inp1[14];
        acc[13] += w * -0.2988071538f * go[1] * inp1[14];
        acc[15] += w * 0.2314550206f * go[1] * inp1[14];
        acc[9] += w * 0.5669467075f * go[2] * inp1[15];
        acc[10] += w * -0.2314550206f * go[3] * inp1[15];
        acc[14] += w * -0.2314550206f * go[1] * inp1[15];
    }
    // Path 32: (3,3)->2
    {
        const float w = weights[32 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[9] += w * -0.5455447150f * go[6] * inp1[9];
        acc[10] += w * 0.3857583768f * go[7] * inp1[9];
        acc[11] += w * -0.2439750229f * go[8] * inp1[9];
        acc[13] += w * -0.2439750229f * go[4] * inp1[9];
        acc[14] += w * 0.3857583768f * go[5] * inp1[9];
        acc[9] += w * 0.3857583768f * go[7] * inp1[10];
        acc[11] += w * 0.2988071467f * go[7] * inp1[10];
        acc[12] += w * -0.4879500459f * go[4] * inp1[10];
        acc[13] += w * 0.2988071467f * go[5] * inp1[10];
        acc[15] += w * -0.3857583768f * go[5] * inp1[10];
        acc[9] += w * -0.2439750229f * go[8] * inp1[11];
        acc[10] += w * 0.2988071467f * go[7] * inp1[11];
        acc[11] += w * 0.3273268423f * go[6] * inp1[11];
        acc[11] += w * -0.3779644601f * go[8] * inp1[11];
        acc[12] += w * 0.1543033474f * go[5] * inp1[11];
        acc[13] += w * 0.3779644601f * go[4] * inp1[11];
        acc[14] += w * -0.2988071467f * go[5] * inp1[11];
        acc[15] += w * 0.2439750229f * go[4] * inp1[11];
        acc[10] += w * -0.4879500459f * go[4] * inp1[12];
        acc[11] += w * 0.1543033474f * go[5] * inp1[12];
        acc[12] += w * 0.4364357787f * go[6] * inp1[12];
        acc[13] += w * 0.1543033474f * go[7] * inp1[12];
        acc[14] += w * -0.4879500459f * go[8] * inp1[12];
        acc[9] += w * -0.2439750229f * go[4] * inp1[13];
        acc[10] += w * 0.2988071467f * go[5] * inp1[13];
        acc[11] += w * 0.3779644601f * go[4] * inp1[13];
        acc[12] += w * 0.1543033474f * go[7] * inp1[13];
        acc[13] += w * 0.3273268423f * go[6] * inp1[13];
        acc[13] += w * 0.3779644601f * go[8] * inp1[13];
        acc[14] += w * 0.2988071467f * go[7] * inp1[13];
        acc[15] += w * -0.2439750229f * go[8] * inp1[13];
        acc[9] += w * 0.3857583768f * go[5] * inp1[14];
        acc[11] += w * -0.2988071467f * go[5] * inp1[14];
        acc[12] += w * -0.4879500459f * go[8] * inp1[14];
        acc[13] += w * 0.2988071467f * go[7] * inp1[14];
        acc[15] += w * 0.3857583768f * go[7] * inp1[14];
        acc[10] += w * -0.3857583768f * go[5] * inp1[15];
        acc[11] += w * 0.2439750229f * go[4] * inp1[15];
        acc[13] += w * -0.2439750229f * go[8] * inp1[15];
        acc[14] += w * 0.3857583768f * go[7] * inp1[15];
        acc[15] += w * -0.5455447150f * go[6] * inp1[15];
    }
    // Path 33: (3,3)->3
    {
        const float w = weights[33 * c_in_count * c_out_count + c_in * c_out_count + c_out];
        acc[10] += w * 0.4082483091f * go[11] * inp1[9];
        acc[11] += w * -0.4082483091f * go[10] * inp1[9];
        acc[12] += w * -0.4082483091f * go[15] * inp1[9];
        acc[13] += w * 0.4082483091f * go[14] * inp1[9];
        acc[14] += w * -0.4082483091f * go[13] * inp1[9];
        acc[15] += w * 0.4082483091f * go[12] * inp1[9];
        acc[9] += w * -0.4082483091f * go[11] * inp1[10];
        acc[11] += w * 0.4082483091f * go[9] * inp1[10];
        acc[12] += w * 0.4082483091f * go[14] * inp1[10];
        acc[13] += w * 0.4082483091f * go[15] * inp1[10];
        acc[14] += w * -0.4082483091f * go[12] * inp1[10];
        acc[15] += w * -0.4082483091f * go[13] * inp1[10];
        acc[9] += w * 0.4082483091f * go[10] * inp1[11];
        acc[10] += w * -0.4082483091f * go[9] * inp1[11];
        acc[12] += w * 0.4082483091f * go[13] * inp1[11];
        acc[13] += w * -0.4082483091f * go[12] * inp1[11];
        acc[14] += w * -0.4082483091f * go[15] * inp1[11];
        acc[15] += w * 0.4082483091f * go[14] * inp1[11];
        acc[9] += w * 0.4082483091f * go[15] * inp1[12];
        acc[10] += w * -0.4082483091f * go[14] * inp1[12];
        acc[11] += w * -0.4082483091f * go[13] * inp1[12];
        acc[13] += w * 0.4082483091f * go[11] * inp1[12];
        acc[14] += w * 0.4082483091f * go[10] * inp1[12];
        acc[15] += w * -0.4082483091f * go[9] * inp1[12];
        acc[9] += w * -0.4082483091f * go[14] * inp1[13];
        acc[10] += w * -0.4082483091f * go[15] * inp1[13];
        acc[11] += w * 0.4082483091f * go[12] * inp1[13];
        acc[12] += w * -0.4082483091f * go[11] * inp1[13];
        acc[14] += w * 0.4082483091f * go[9] * inp1[13];
        acc[15] += w * 0.4082483091f * go[10] * inp1[13];
        acc[9] += w * 0.4082483091f * go[13] * inp1[14];
        acc[10] += w * 0.4082483091f * go[12] * inp1[14];
        acc[11] += w * 0.4082483091f * go[15] * inp1[14];
        acc[12] += w * -0.4082483091f * go[10] * inp1[14];
        acc[13] += w * -0.4082483091f * go[9] * inp1[14];
        acc[15] += w * -0.4082483091f * go[11] * inp1[14];
        acc[9] += w * -0.4082483091f * go[12] * inp1[15];
        acc[10] += w * 0.4082483091f * go[13] * inp1[15];
        acc[11] += w * -0.4082483091f * go[14] * inp1[15];
        acc[12] += w * 0.4082483091f * go[9] * inp1[15];
        acc[13] += w * -0.4082483091f * go[10] * inp1[15];
        acc[14] += w * 0.4082483091f * go[11] * inp1[15];
    }
}

// Full tensor product backward for grad_weights
// For one sample: computes contribution to grad_weights for all paths
// grad_w[path,c_in,c_out] += sum_{cg} cg * in1[c_in,m1] * in2[m2] * grad_out[c_out,m_out]
// Returns partial sums that need to be accumulated across samples
__device__ __forceinline__ void tensor_product_backward_weights_unrolled(
    const float* __restrict__ in1,           // [C_in, 16] for this sample
    const float* __restrict__ in2,           // [16] for this sample
    const float* __restrict__ grad_out,      // [C_out, 16] for this sample
    float* __restrict__ grad_weights,        // [NUM_PATHS, C_in, C_out] - atomicAdd to this
    int c_in_count,
    int c_out_count
) {
    for (int c_in = 0; c_in < c_in_count; c_in++) {
        const float* inp1 = in1 + c_in * 16;

        for (int c_out = 0; c_out < c_out_count; c_out++) {
            const float* go = grad_out + c_out * 16;

            // Path 0: (0,0)->0
            {
                float grad_w = 0.0f;
                grad_w += 1.0000000000f * inp1[0] * in2[0] * go[0];
                atomicAdd(&grad_weights[0 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 1: (0,1)->1
            {
                float grad_w = 0.0f;
                grad_w += 0.9999999821f * inp1[0] * in2[1] * go[1];
                grad_w += 0.9999999821f * inp1[0] * in2[2] * go[2];
                grad_w += 0.9999999821f * inp1[0] * in2[3] * go[3];
                atomicAdd(&grad_weights[1 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 2: (0,2)->2
            {
                float grad_w = 0.0f;
                grad_w += 0.9999999880f * inp1[0] * in2[4] * go[4];
                grad_w += 0.9999999880f * inp1[0] * in2[5] * go[5];
                grad_w += 0.9999999880f * inp1[0] * in2[6] * go[6];
                grad_w += 0.9999999880f * inp1[0] * in2[7] * go[7];
                grad_w += 0.9999999880f * inp1[0] * in2[8] * go[8];
                atomicAdd(&grad_weights[2 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 3: (0,3)->3
            {
                float grad_w = 0.0f;
                grad_w += 0.9999999836f * inp1[0] * in2[9] * go[9];
                grad_w += 0.9999999836f * inp1[0] * in2[10] * go[10];
                grad_w += 0.9999999836f * inp1[0] * in2[11] * go[11];
                grad_w += 0.9999999836f * inp1[0] * in2[12] * go[12];
                grad_w += 0.9999999836f * inp1[0] * in2[13] * go[13];
                grad_w += 0.9999999836f * inp1[0] * in2[14] * go[14];
                grad_w += 0.9999999836f * inp1[0] * in2[15] * go[15];
                atomicAdd(&grad_weights[3 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 4: (1,0)->1
            {
                float grad_w = 0.0f;
                grad_w += 0.9999999821f * inp1[1] * in2[0] * go[1];
                grad_w += 0.9999999821f * inp1[2] * in2[0] * go[2];
                grad_w += 0.9999999821f * inp1[3] * in2[0] * go[3];
                atomicAdd(&grad_weights[4 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 5: (1,1)->0
            {
                float grad_w = 0.0f;
                grad_w += 0.5773502588f * inp1[1] * in2[1] * go[0];
                grad_w += 0.5773502588f * inp1[2] * in2[2] * go[0];
                grad_w += 0.5773502588f * inp1[3] * in2[3] * go[0];
                atomicAdd(&grad_weights[5 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 6: (1,1)->1
            {
                float grad_w = 0.0f;
                grad_w += 0.7071068069f * inp1[1] * in2[2] * go[3];
                grad_w += -0.7071068069f * inp1[1] * in2[3] * go[2];
                grad_w += -0.7071068069f * inp1[2] * in2[1] * go[3];
                grad_w += 0.7071068069f * inp1[2] * in2[3] * go[1];
                grad_w += 0.7071068069f * inp1[3] * in2[1] * go[2];
                grad_w += -0.7071068069f * inp1[3] * in2[2] * go[1];
                atomicAdd(&grad_weights[6 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 7: (1,1)->2
            {
                float grad_w = 0.0f;
                grad_w += -0.4082482836f * inp1[1] * in2[1] * go[6];
                grad_w += -0.7071067764f * inp1[1] * in2[1] * go[8];
                grad_w += 0.7071067764f * inp1[1] * in2[2] * go[5];
                grad_w += 0.7071067764f * inp1[1] * in2[3] * go[4];
                grad_w += 0.7071067764f * inp1[2] * in2[1] * go[5];
                grad_w += 0.8164965671f * inp1[2] * in2[2] * go[6];
                grad_w += 0.7071067764f * inp1[2] * in2[3] * go[7];
                grad_w += 0.7071067764f * inp1[3] * in2[1] * go[4];
                grad_w += 0.7071067764f * inp1[3] * in2[2] * go[7];
                grad_w += -0.4082482836f * inp1[3] * in2[3] * go[6];
                grad_w += 0.7071067764f * inp1[3] * in2[3] * go[8];
                atomicAdd(&grad_weights[7 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 8: (1,2)->1
            {
                float grad_w = 0.0f;
                grad_w += 0.5477225538f * inp1[1] * in2[4] * go[3];
                grad_w += 0.5477225538f * inp1[1] * in2[5] * go[2];
                grad_w += -0.3162277607f * inp1[1] * in2[6] * go[1];
                grad_w += -0.5477225538f * inp1[1] * in2[8] * go[1];
                grad_w += 0.5477225538f * inp1[2] * in2[5] * go[1];
                grad_w += 0.6324555213f * inp1[2] * in2[6] * go[2];
                grad_w += 0.5477225538f * inp1[2] * in2[7] * go[3];
                grad_w += 0.5477225538f * inp1[3] * in2[4] * go[1];
                grad_w += -0.3162277607f * inp1[3] * in2[6] * go[3];
                grad_w += 0.5477225538f * inp1[3] * in2[7] * go[2];
                grad_w += 0.5477225538f * inp1[3] * in2[8] * go[3];
                atomicAdd(&grad_weights[8 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 9: (1,2)->2
            {
                float grad_w = 0.0f;
                grad_w += -0.4082482836f * inp1[1] * in2[4] * go[5];
                grad_w += 0.4082482836f * inp1[1] * in2[5] * go[4];
                grad_w += 0.7071067764f * inp1[1] * in2[6] * go[7];
                grad_w += -0.7071067764f * inp1[1] * in2[7] * go[6];
                grad_w += 0.4082482836f * inp1[1] * in2[7] * go[8];
                grad_w += -0.4082482836f * inp1[1] * in2[8] * go[7];
                grad_w += -0.8164965671f * inp1[2] * in2[4] * go[8];
                grad_w += -0.4082482836f * inp1[2] * in2[5] * go[7];
                grad_w += 0.4082482836f * inp1[2] * in2[7] * go[5];
                grad_w += 0.8164965671f * inp1[2] * in2[8] * go[4];
                grad_w += 0.4082482836f * inp1[3] * in2[4] * go[7];
                grad_w += 0.7071067764f * inp1[3] * in2[5] * go[6];
                grad_w += 0.4082482836f * inp1[3] * in2[5] * go[8];
                grad_w += -0.7071067764f * inp1[3] * in2[6] * go[5];
                grad_w += -0.4082482836f * inp1[3] * in2[7] * go[4];
                grad_w += -0.4082482836f * inp1[3] * in2[8] * go[5];
                atomicAdd(&grad_weights[9 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 10: (1,2)->3
            {
                float grad_w = 0.0f;
                grad_w += -0.1825741828f * inp1[1] * in2[4] * go[13];
                grad_w += -0.7071067679f * inp1[1] * in2[4] * go[15];
                grad_w += -0.4472135802f * inp1[1] * in2[5] * go[12];
                grad_w += -0.5773502803f * inp1[1] * in2[5] * go[14];
                grad_w += 0.6324555384f * inp1[1] * in2[6] * go[11];
                grad_w += 0.5773502803f * inp1[1] * in2[7] * go[10];
                grad_w += 0.7071067679f * inp1[1] * in2[8] * go[9];
                grad_w += 0.1825741828f * inp1[1] * in2[8] * go[11];
                grad_w += 0.5773502803f * inp1[2] * in2[4] * go[10];
                grad_w += 0.7302967312f * inp1[2] * in2[5] * go[11];
                grad_w += 0.7745966857f * inp1[2] * in2[6] * go[12];
                grad_w += 0.7302967312f * inp1[2] * in2[7] * go[13];
                grad_w += 0.5773502803f * inp1[2] * in2[8] * go[14];
                grad_w += 0.7071067679f * inp1[3] * in2[4] * go[9];
                grad_w += -0.1825741828f * inp1[3] * in2[4] * go[11];
                grad_w += 0.5773502803f * inp1[3] * in2[5] * go[10];
                grad_w += 0.6324555384f * inp1[3] * in2[6] * go[13];
                grad_w += -0.4472135802f * inp1[3] * in2[7] * go[12];
                grad_w += 0.5773502803f * inp1[3] * in2[7] * go[14];
                grad_w += -0.1825741828f * inp1[3] * in2[8] * go[13];
                grad_w += 0.7071067679f * inp1[3] * in2[8] * go[15];
                atomicAdd(&grad_weights[10 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 11: (1,3)->2
            {
                float grad_w = 0.0f;
                grad_w += 0.5976142935f * inp1[1] * in2[9] * go[8];
                grad_w += 0.4879500459f * inp1[1] * in2[10] * go[7];
                grad_w += 0.5345224892f * inp1[1] * in2[11] * go[6];
                grad_w += 0.1543033474f * inp1[1] * in2[11] * go[8];
                grad_w += -0.3779644601f * inp1[1] * in2[12] * go[5];
                grad_w += -0.1543033474f * inp1[1] * in2[13] * go[4];
                grad_w += -0.4879500459f * inp1[1] * in2[14] * go[5];
                grad_w += -0.5976142935f * inp1[1] * in2[15] * go[4];
                grad_w += 0.4879500459f * inp1[2] * in2[10] * go[4];
                grad_w += 0.6172133895f * inp1[2] * in2[11] * go[5];
                grad_w += 0.6546536846f * inp1[2] * in2[12] * go[6];
                grad_w += 0.6172133895f * inp1[2] * in2[13] * go[7];
                grad_w += 0.4879500459f * inp1[2] * in2[14] * go[8];
                grad_w += 0.5976142935f * inp1[3] * in2[9] * go[4];
                grad_w += 0.4879500459f * inp1[3] * in2[10] * go[5];
                grad_w += -0.1543033474f * inp1[3] * in2[11] * go[4];
                grad_w += -0.3779644601f * inp1[3] * in2[12] * go[7];
                grad_w += 0.5345224892f * inp1[3] * in2[13] * go[6];
                grad_w += -0.1543033474f * inp1[3] * in2[13] * go[8];
                grad_w += 0.4879500459f * inp1[3] * in2[14] * go[7];
                grad_w += 0.5976142935f * inp1[3] * in2[15] * go[8];
                atomicAdd(&grad_weights[11 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 12: (1,3)->3
            {
                float grad_w = 0.0f;
                grad_w += -0.3535533840f * inp1[1] * in2[9] * go[10];
                grad_w += 0.3535533840f * inp1[1] * in2[10] * go[9];
                grad_w += -0.4564354668f * inp1[1] * in2[10] * go[11];
                grad_w += 0.4564354668f * inp1[1] * in2[11] * go[10];
                grad_w += 0.7071067679f * inp1[1] * in2[12] * go[13];
                grad_w += -0.7071067679f * inp1[1] * in2[13] * go[12];
                grad_w += 0.4564354668f * inp1[1] * in2[13] * go[14];
                grad_w += -0.4564354668f * inp1[1] * in2[14] * go[13];
                grad_w += 0.3535533840f * inp1[1] * in2[14] * go[15];
                grad_w += -0.3535533840f * inp1[1] * in2[15] * go[14];
                grad_w += -0.8660254007f * inp1[2] * in2[9] * go[15];
                grad_w += -0.5773502803f * inp1[2] * in2[10] * go[14];
                grad_w += -0.2886751401f * inp1[2] * in2[11] * go[13];
                grad_w += 0.2886751401f * inp1[2] * in2[13] * go[11];
                grad_w += 0.5773502803f * inp1[2] * in2[14] * go[10];
                grad_w += 0.8660254007f * inp1[2] * in2[15] * go[9];
                grad_w += 0.3535533840f * inp1[3] * in2[9] * go[14];
                grad_w += 0.4564354668f * inp1[3] * in2[10] * go[13];
                grad_w += 0.3535533840f * inp1[3] * in2[10] * go[15];
                grad_w += 0.7071067679f * inp1[3] * in2[11] * go[12];
                grad_w += 0.4564354668f * inp1[3] * in2[11] * go[14];
                grad_w += -0.7071067679f * inp1[3] * in2[12] * go[11];
                grad_w += -0.4564354668f * inp1[3] * in2[13] * go[10];
                grad_w += -0.3535533840f * inp1[3] * in2[14] * go[9];
                grad_w += -0.4564354668f * inp1[3] * in2[14] * go[11];
                grad_w += -0.3535533840f * inp1[3] * in2[15] * go[10];
                atomicAdd(&grad_weights[12 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 13: (2,0)->2
            {
                float grad_w = 0.0f;
                grad_w += 0.9999999880f * inp1[4] * in2[0] * go[4];
                grad_w += 0.9999999880f * inp1[5] * in2[0] * go[5];
                grad_w += 0.9999999880f * inp1[6] * in2[0] * go[6];
                grad_w += 0.9999999880f * inp1[7] * in2[0] * go[7];
                grad_w += 0.9999999880f * inp1[8] * in2[0] * go[8];
                atomicAdd(&grad_weights[13 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 14: (2,1)->1
            {
                float grad_w = 0.0f;
                grad_w += 0.5477225538f * inp1[4] * in2[1] * go[3];
                grad_w += 0.5477225538f * inp1[4] * in2[3] * go[1];
                grad_w += 0.5477225538f * inp1[5] * in2[1] * go[2];
                grad_w += 0.5477225538f * inp1[5] * in2[2] * go[1];
                grad_w += -0.3162277607f * inp1[6] * in2[1] * go[1];
                grad_w += 0.6324555213f * inp1[6] * in2[2] * go[2];
                grad_w += -0.3162277607f * inp1[6] * in2[3] * go[3];
                grad_w += 0.5477225538f * inp1[7] * in2[2] * go[3];
                grad_w += 0.5477225538f * inp1[7] * in2[3] * go[2];
                grad_w += -0.5477225538f * inp1[8] * in2[1] * go[1];
                grad_w += 0.5477225538f * inp1[8] * in2[3] * go[3];
                atomicAdd(&grad_weights[14 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 15: (2,1)->2
            {
                float grad_w = 0.0f;
                grad_w += 0.4082482836f * inp1[4] * in2[1] * go[5];
                grad_w += 0.8164965671f * inp1[4] * in2[2] * go[8];
                grad_w += -0.4082482836f * inp1[4] * in2[3] * go[7];
                grad_w += -0.4082482836f * inp1[5] * in2[1] * go[4];
                grad_w += 0.4082482836f * inp1[5] * in2[2] * go[7];
                grad_w += -0.7071067764f * inp1[5] * in2[3] * go[6];
                grad_w += -0.4082482836f * inp1[5] * in2[3] * go[8];
                grad_w += -0.7071067764f * inp1[6] * in2[1] * go[7];
                grad_w += 0.7071067764f * inp1[6] * in2[3] * go[5];
                grad_w += 0.7071067764f * inp1[7] * in2[1] * go[6];
                grad_w += -0.4082482836f * inp1[7] * in2[1] * go[8];
                grad_w += -0.4082482836f * inp1[7] * in2[2] * go[5];
                grad_w += 0.4082482836f * inp1[7] * in2[3] * go[4];
                grad_w += 0.4082482836f * inp1[8] * in2[1] * go[7];
                grad_w += -0.8164965671f * inp1[8] * in2[2] * go[4];
                grad_w += 0.4082482836f * inp1[8] * in2[3] * go[5];
                atomicAdd(&grad_weights[15 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 16: (2,1)->3
            {
                float grad_w = 0.0f;
                grad_w += -0.1825741828f * inp1[4] * in2[1] * go[13];
                grad_w += -0.7071067679f * inp1[4] * in2[1] * go[15];
                grad_w += 0.5773502803f * inp1[4] * in2[2] * go[10];
                grad_w += 0.7071067679f * inp1[4] * in2[3] * go[9];
                grad_w += -0.1825741828f * inp1[4] * in2[3] * go[11];
                grad_w += -0.4472135802f * inp1[5] * in2[1] * go[12];
                grad_w += -0.5773502803f * inp1[5] * in2[1] * go[14];
                grad_w += 0.7302967312f * inp1[5] * in2[2] * go[11];
                grad_w += 0.5773502803f * inp1[5] * in2[3] * go[10];
                grad_w += 0.6324555384f * inp1[6] * in2[1] * go[11];
                grad_w += 0.7745966857f * inp1[6] * in2[2] * go[12];
                grad_w += 0.6324555384f * inp1[6] * in2[3] * go[13];
                grad_w += 0.5773502803f * inp1[7] * in2[1] * go[10];
                grad_w += 0.7302967312f * inp1[7] * in2[2] * go[13];
                grad_w += -0.4472135802f * inp1[7] * in2[3] * go[12];
                grad_w += 0.5773502803f * inp1[7] * in2[3] * go[14];
                grad_w += 0.7071067679f * inp1[8] * in2[1] * go[9];
                grad_w += 0.1825741828f * inp1[8] * in2[1] * go[11];
                grad_w += 0.5773502803f * inp1[8] * in2[2] * go[14];
                grad_w += -0.1825741828f * inp1[8] * in2[3] * go[13];
                grad_w += 0.7071067679f * inp1[8] * in2[3] * go[15];
                atomicAdd(&grad_weights[16 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 17: (2,2)->0
            {
                float grad_w = 0.0f;
                grad_w += 0.4472135901f * inp1[4] * in2[4] * go[0];
                grad_w += 0.4472135901f * inp1[5] * in2[5] * go[0];
                grad_w += 0.4472135901f * inp1[6] * in2[6] * go[0];
                grad_w += 0.4472135901f * inp1[7] * in2[7] * go[0];
                grad_w += 0.4472135901f * inp1[8] * in2[8] * go[0];
                atomicAdd(&grad_weights[17 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 18: (2,2)->1
            {
                float grad_w = 0.0f;
                grad_w += -0.3162277607f * inp1[4] * in2[5] * go[1];
                grad_w += 0.3162277607f * inp1[4] * in2[7] * go[3];
                grad_w += -0.6324555213f * inp1[4] * in2[8] * go[2];
                grad_w += 0.3162277607f * inp1[5] * in2[4] * go[1];
                grad_w += 0.5477225538f * inp1[5] * in2[6] * go[3];
                grad_w += -0.3162277607f * inp1[5] * in2[7] * go[2];
                grad_w += 0.3162277607f * inp1[5] * in2[8] * go[3];
                grad_w += -0.5477225538f * inp1[6] * in2[5] * go[3];
                grad_w += 0.5477225538f * inp1[6] * in2[7] * go[1];
                grad_w += -0.3162277607f * inp1[7] * in2[4] * go[3];
                grad_w += 0.3162277607f * inp1[7] * in2[5] * go[2];
                grad_w += -0.5477225538f * inp1[7] * in2[6] * go[1];
                grad_w += 0.3162277607f * inp1[7] * in2[8] * go[1];
                grad_w += 0.6324555213f * inp1[8] * in2[4] * go[2];
                grad_w += -0.3162277607f * inp1[8] * in2[5] * go[3];
                grad_w += -0.3162277607f * inp1[8] * in2[7] * go[1];
                atomicAdd(&grad_weights[18 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 19: (2,2)->2
            {
                float grad_w = 0.0f;
                grad_w += -0.5345224892f * inp1[4] * in2[4] * go[6];
                grad_w += 0.4629100588f * inp1[4] * in2[5] * go[7];
                grad_w += -0.5345224892f * inp1[4] * in2[6] * go[4];
                grad_w += 0.4629100588f * inp1[4] * in2[7] * go[5];
                grad_w += 0.4629100588f * inp1[5] * in2[4] * go[7];
                grad_w += 0.2672612446f * inp1[5] * in2[5] * go[6];
                grad_w += -0.4629100588f * inp1[5] * in2[5] * go[8];
                grad_w += 0.2672612446f * inp1[5] * in2[6] * go[5];
                grad_w += 0.4629100588f * inp1[5] * in2[7] * go[4];
                grad_w += -0.4629100588f * inp1[5] * in2[8] * go[5];
                grad_w += -0.5345224892f * inp1[6] * in2[4] * go[4];
                grad_w += 0.2672612446f * inp1[6] * in2[5] * go[5];
                grad_w += 0.5345224892f * inp1[6] * in2[6] * go[6];
                grad_w += 0.2672612446f * inp1[6] * in2[7] * go[7];
                grad_w += -0.5345224892f * inp1[6] * in2[8] * go[8];
                grad_w += 0.4629100588f * inp1[7] * in2[4] * go[5];
                grad_w += 0.4629100588f * inp1[7] * in2[5] * go[4];
                grad_w += 0.2672612446f * inp1[7] * in2[6] * go[7];
                grad_w += 0.2672612446f * inp1[7] * in2[7] * go[6];
                grad_w += 0.4629100588f * inp1[7] * in2[7] * go[8];
                grad_w += 0.4629100588f * inp1[7] * in2[8] * go[7];
                grad_w += -0.4629100588f * inp1[8] * in2[5] * go[5];
                grad_w += -0.5345224892f * inp1[8] * in2[6] * go[8];
                grad_w += 0.4629100588f * inp1[8] * in2[7] * go[7];
                grad_w += -0.5345224892f * inp1[8] * in2[8] * go[6];
                atomicAdd(&grad_weights[19 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 20: (2,2)->3
            {
                float grad_w = 0.0f;
                grad_w += 0.4999999918f * inp1[4] * in2[5] * go[9];
                grad_w += 0.3872983429f * inp1[4] * in2[5] * go[11];
                grad_w += 0.7071067679f * inp1[4] * in2[6] * go[14];
                grad_w += -0.3872983429f * inp1[4] * in2[7] * go[13];
                grad_w += 0.4999999918f * inp1[4] * in2[7] * go[15];
                grad_w += 0.3162277692f * inp1[4] * in2[8] * go[12];
                grad_w += -0.4999999918f * inp1[5] * in2[4] * go[9];
                grad_w += -0.3872983429f * inp1[5] * in2[4] * go[11];
                grad_w += 0.4472135802f * inp1[5] * in2[6] * go[13];
                grad_w += -0.6324555384f * inp1[5] * in2[7] * go[12];
                grad_w += -0.3872983429f * inp1[5] * in2[8] * go[13];
                grad_w += -0.4999999918f * inp1[5] * in2[8] * go[15];
                grad_w += -0.7071067679f * inp1[6] * in2[4] * go[14];
                grad_w += -0.4472135802f * inp1[6] * in2[5] * go[13];
                grad_w += 0.4472135802f * inp1[6] * in2[7] * go[11];
                grad_w += 0.7071067679f * inp1[6] * in2[8] * go[10];
                grad_w += 0.3872983429f * inp1[7] * in2[4] * go[13];
                grad_w += -0.4999999918f * inp1[7] * in2[4] * go[15];
                grad_w += 0.6324555384f * inp1[7] * in2[5] * go[12];
                grad_w += -0.4472135802f * inp1[7] * in2[6] * go[11];
                grad_w += 0.4999999918f * inp1[7] * in2[8] * go[9];
                grad_w += -0.3872983429f * inp1[7] * in2[8] * go[11];
                grad_w += -0.3162277692f * inp1[8] * in2[4] * go[12];
                grad_w += 0.3872983429f * inp1[8] * in2[5] * go[13];
                grad_w += 0.4999999918f * inp1[8] * in2[5] * go[15];
                grad_w += -0.7071067679f * inp1[8] * in2[6] * go[10];
                grad_w += -0.4999999918f * inp1[8] * in2[7] * go[9];
                grad_w += 0.3872983429f * inp1[8] * in2[7] * go[11];
                atomicAdd(&grad_weights[20 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 21: (2,3)->1
            {
                float grad_w = 0.0f;
                grad_w += 0.4629100412f * inp1[4] * in2[9] * go[3];
                grad_w += 0.3779644803f * inp1[4] * in2[10] * go[2];
                grad_w += -0.1195228589f * inp1[4] * in2[11] * go[3];
                grad_w += -0.1195228589f * inp1[4] * in2[13] * go[1];
                grad_w += -0.4629100412f * inp1[4] * in2[15] * go[1];
                grad_w += 0.3779644803f * inp1[5] * in2[10] * go[3];
                grad_w += 0.4780914358f * inp1[5] * in2[11] * go[2];
                grad_w += -0.2927700119f * inp1[5] * in2[12] * go[1];
                grad_w += -0.3779644803f * inp1[5] * in2[14] * go[1];
                grad_w += 0.4140393398f * inp1[6] * in2[11] * go[1];
                grad_w += 0.5070925636f * inp1[6] * in2[12] * go[2];
                grad_w += 0.4140393398f * inp1[6] * in2[13] * go[3];
                grad_w += 0.3779644803f * inp1[7] * in2[10] * go[1];
                grad_w += -0.2927700119f * inp1[7] * in2[12] * go[3];
                grad_w += 0.4780914358f * inp1[7] * in2[13] * go[2];
                grad_w += 0.3779644803f * inp1[7] * in2[14] * go[3];
                grad_w += 0.4629100412f * inp1[8] * in2[9] * go[1];
                grad_w += 0.1195228589f * inp1[8] * in2[11] * go[1];
                grad_w += -0.1195228589f * inp1[8] * in2[13] * go[3];
                grad_w += 0.3779644803f * inp1[8] * in2[14] * go[2];
                grad_w += 0.4629100412f * inp1[8] * in2[15] * go[3];
                atomicAdd(&grad_weights[21 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 22: (2,3)->2
            {
                float grad_w = 0.0f;
                grad_w += -0.4225771204f * inp1[4] * in2[9] * go[5];
                grad_w += -0.3273268423f * inp1[4] * in2[11] * go[5];
                grad_w += -0.2672612446f * inp1[4] * in2[12] * go[8];
                grad_w += 0.3273268423f * inp1[4] * in2[13] * go[7];
                grad_w += -0.5976142935f * inp1[4] * in2[14] * go[6];
                grad_w += -0.4225771204f * inp1[4] * in2[15] * go[7];
                grad_w += 0.4225771204f * inp1[5] * in2[9] * go[4];
                grad_w += 0.3273268423f * inp1[5] * in2[11] * go[4];
                grad_w += 0.5345224892f * inp1[5] * in2[12] * go[7];
                grad_w += -0.3779644601f * inp1[5] * in2[13] * go[6];
                grad_w += 0.3273268423f * inp1[5] * in2[13] * go[8];
                grad_w += 0.4225771204f * inp1[5] * in2[15] * go[8];
                grad_w += -0.5976142935f * inp1[6] * in2[10] * go[8];
                grad_w += -0.3779644601f * inp1[6] * in2[11] * go[7];
                grad_w += 0.3779644601f * inp1[6] * in2[13] * go[5];
                grad_w += 0.5976142935f * inp1[6] * in2[14] * go[4];
                grad_w += -0.4225771204f * inp1[7] * in2[9] * go[8];
                grad_w += 0.3779644601f * inp1[7] * in2[11] * go[6];
                grad_w += 0.3273268423f * inp1[7] * in2[11] * go[8];
                grad_w += -0.5345224892f * inp1[7] * in2[12] * go[5];
                grad_w += -0.3273268423f * inp1[7] * in2[13] * go[4];
                grad_w += 0.4225771204f * inp1[7] * in2[15] * go[4];
                grad_w += 0.4225771204f * inp1[8] * in2[9] * go[7];
                grad_w += 0.5976142935f * inp1[8] * in2[10] * go[6];
                grad_w += -0.3273268423f * inp1[8] * in2[11] * go[7];
                grad_w += 0.2672612446f * inp1[8] * in2[12] * go[4];
                grad_w += -0.3273268423f * inp1[8] * in2[13] * go[5];
                grad_w += -0.4225771204f * inp1[8] * in2[15] * go[5];
                atomicAdd(&grad_weights[22 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 23: (2,3)->3
            {
                float grad_w = 0.0f;
                grad_w += -0.2886751401f * inp1[4] * in2[9] * go[13];
                grad_w += -0.5773502803f * inp1[4] * in2[10] * go[12];
                grad_w += 0.4472135802f * inp1[4] * in2[11] * go[13];
                grad_w += 0.2886751401f * inp1[4] * in2[11] * go[15];
                grad_w += -0.5773502803f * inp1[4] * in2[12] * go[10];
                grad_w += -0.2886751401f * inp1[4] * in2[13] * go[9];
                grad_w += 0.4472135802f * inp1[4] * in2[13] * go[11];
                grad_w += 0.2886751401f * inp1[4] * in2[15] * go[11];
                grad_w += 0.4564354668f * inp1[5] * in2[9] * go[14];
                grad_w += 0.3535533840f * inp1[5] * in2[10] * go[13];
                grad_w += -0.4564354668f * inp1[5] * in2[10] * go[15];
                grad_w += 0.1825741828f * inp1[5] * in2[11] * go[12];
                grad_w += -0.3535533840f * inp1[5] * in2[11] * go[14];
                grad_w += 0.1825741828f * inp1[5] * in2[12] * go[11];
                grad_w += 0.3535533840f * inp1[5] * in2[13] * go[10];
                grad_w += 0.4564354668f * inp1[5] * in2[14] * go[9];
                grad_w += -0.3535533840f * inp1[5] * in2[14] * go[11];
                grad_w += -0.4564354668f * inp1[5] * in2[15] * go[10];
                grad_w += -0.6454972118f * inp1[6] * in2[9] * go[9];
                grad_w += 0.3872983429f * inp1[6] * in2[11] * go[11];
                grad_w += 0.5163977773f * inp1[6] * in2[12] * go[12];
                grad_w += 0.3872983429f * inp1[6] * in2[13] * go[13];
                grad_w += -0.6454972118f * inp1[6] * in2[15] * go[15];
                grad_w += 0.4564354668f * inp1[7] * in2[9] * go[10];
                grad_w += 0.4564354668f * inp1[7] * in2[10] * go[9];
                grad_w += 0.3535533840f * inp1[7] * in2[10] * go[11];
                grad_w += 0.3535533840f * inp1[7] * in2[11] * go[10];
                grad_w += 0.1825741828f * inp1[7] * in2[12] * go[13];
                grad_w += 0.1825741828f * inp1[7] * in2[13] * go[12];
                grad_w += 0.3535533840f * inp1[7] * in2[13] * go[14];
                grad_w += 0.3535533840f * inp1[7] * in2[14] * go[13];
                grad_w += 0.4564354668f * inp1[7] * in2[14] * go[15];
                grad_w += 0.4564354668f * inp1[7] * in2[15] * go[14];
                grad_w += -0.2886751401f * inp1[8] * in2[9] * go[11];
                grad_w += -0.2886751401f * inp1[8] * in2[11] * go[9];
                grad_w += -0.4472135802f * inp1[8] * in2[11] * go[11];
                grad_w += -0.5773502803f * inp1[8] * in2[12] * go[14];
                grad_w += 0.4472135802f * inp1[8] * in2[13] * go[13];
                grad_w += -0.2886751401f * inp1[8] * in2[13] * go[15];
                grad_w += -0.5773502803f * inp1[8] * in2[14] * go[12];
                grad_w += -0.2886751401f * inp1[8] * in2[15] * go[13];
                atomicAdd(&grad_weights[23 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 24: (3,0)->3
            {
                float grad_w = 0.0f;
                grad_w += 0.9999999836f * inp1[9] * in2[0] * go[9];
                grad_w += 0.9999999836f * inp1[10] * in2[0] * go[10];
                grad_w += 0.9999999836f * inp1[11] * in2[0] * go[11];
                grad_w += 0.9999999836f * inp1[12] * in2[0] * go[12];
                grad_w += 0.9999999836f * inp1[13] * in2[0] * go[13];
                grad_w += 0.9999999836f * inp1[14] * in2[0] * go[14];
                grad_w += 0.9999999836f * inp1[15] * in2[0] * go[15];
                atomicAdd(&grad_weights[24 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 25: (3,1)->2
            {
                float grad_w = 0.0f;
                grad_w += 0.5976142935f * inp1[9] * in2[1] * go[8];
                grad_w += 0.5976142935f * inp1[9] * in2[3] * go[4];
                grad_w += 0.4879500459f * inp1[10] * in2[1] * go[7];
                grad_w += 0.4879500459f * inp1[10] * in2[2] * go[4];
                grad_w += 0.4879500459f * inp1[10] * in2[3] * go[5];
                grad_w += 0.5345224892f * inp1[11] * in2[1] * go[6];
                grad_w += 0.1543033474f * inp1[11] * in2[1] * go[8];
                grad_w += 0.6172133895f * inp1[11] * in2[2] * go[5];
                grad_w += -0.1543033474f * inp1[11] * in2[3] * go[4];
                grad_w += -0.3779644601f * inp1[12] * in2[1] * go[5];
                grad_w += 0.6546536846f * inp1[12] * in2[2] * go[6];
                grad_w += -0.3779644601f * inp1[12] * in2[3] * go[7];
                grad_w += -0.1543033474f * inp1[13] * in2[1] * go[4];
                grad_w += 0.6172133895f * inp1[13] * in2[2] * go[7];
                grad_w += 0.5345224892f * inp1[13] * in2[3] * go[6];
                grad_w += -0.1543033474f * inp1[13] * in2[3] * go[8];
                grad_w += -0.4879500459f * inp1[14] * in2[1] * go[5];
                grad_w += 0.4879500459f * inp1[14] * in2[2] * go[8];
                grad_w += 0.4879500459f * inp1[14] * in2[3] * go[7];
                grad_w += -0.5976142935f * inp1[15] * in2[1] * go[4];
                grad_w += 0.5976142935f * inp1[15] * in2[3] * go[8];
                atomicAdd(&grad_weights[25 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 26: (3,1)->3
            {
                float grad_w = 0.0f;
                grad_w += 0.3535533840f * inp1[9] * in2[1] * go[10];
                grad_w += 0.8660254007f * inp1[9] * in2[2] * go[15];
                grad_w += -0.3535533840f * inp1[9] * in2[3] * go[14];
                grad_w += -0.3535533840f * inp1[10] * in2[1] * go[9];
                grad_w += 0.4564354668f * inp1[10] * in2[1] * go[11];
                grad_w += 0.5773502803f * inp1[10] * in2[2] * go[14];
                grad_w += -0.4564354668f * inp1[10] * in2[3] * go[13];
                grad_w += -0.3535533840f * inp1[10] * in2[3] * go[15];
                grad_w += -0.4564354668f * inp1[11] * in2[1] * go[10];
                grad_w += 0.2886751401f * inp1[11] * in2[2] * go[13];
                grad_w += -0.7071067679f * inp1[11] * in2[3] * go[12];
                grad_w += -0.4564354668f * inp1[11] * in2[3] * go[14];
                grad_w += -0.7071067679f * inp1[12] * in2[1] * go[13];
                grad_w += 0.7071067679f * inp1[12] * in2[3] * go[11];
                grad_w += 0.7071067679f * inp1[13] * in2[1] * go[12];
                grad_w += -0.4564354668f * inp1[13] * in2[1] * go[14];
                grad_w += -0.2886751401f * inp1[13] * in2[2] * go[11];
                grad_w += 0.4564354668f * inp1[13] * in2[3] * go[10];
                grad_w += 0.4564354668f * inp1[14] * in2[1] * go[13];
                grad_w += -0.3535533840f * inp1[14] * in2[1] * go[15];
                grad_w += -0.5773502803f * inp1[14] * in2[2] * go[10];
                grad_w += 0.3535533840f * inp1[14] * in2[3] * go[9];
                grad_w += 0.4564354668f * inp1[14] * in2[3] * go[11];
                grad_w += 0.3535533840f * inp1[15] * in2[1] * go[14];
                grad_w += -0.8660254007f * inp1[15] * in2[2] * go[9];
                grad_w += 0.3535533840f * inp1[15] * in2[3] * go[10];
                atomicAdd(&grad_weights[26 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 27: (3,2)->1
            {
                float grad_w = 0.0f;
                grad_w += 0.4629100412f * inp1[9] * in2[4] * go[3];
                grad_w += 0.4629100412f * inp1[9] * in2[8] * go[1];
                grad_w += 0.3779644803f * inp1[10] * in2[4] * go[2];
                grad_w += 0.3779644803f * inp1[10] * in2[5] * go[3];
                grad_w += 0.3779644803f * inp1[10] * in2[7] * go[1];
                grad_w += -0.1195228589f * inp1[11] * in2[4] * go[3];
                grad_w += 0.4780914358f * inp1[11] * in2[5] * go[2];
                grad_w += 0.4140393398f * inp1[11] * in2[6] * go[1];
                grad_w += 0.1195228589f * inp1[11] * in2[8] * go[1];
                grad_w += -0.2927700119f * inp1[12] * in2[5] * go[1];
                grad_w += 0.5070925636f * inp1[12] * in2[6] * go[2];
                grad_w += -0.2927700119f * inp1[12] * in2[7] * go[3];
                grad_w += -0.1195228589f * inp1[13] * in2[4] * go[1];
                grad_w += 0.4140393398f * inp1[13] * in2[6] * go[3];
                grad_w += 0.4780914358f * inp1[13] * in2[7] * go[2];
                grad_w += -0.1195228589f * inp1[13] * in2[8] * go[3];
                grad_w += -0.3779644803f * inp1[14] * in2[5] * go[1];
                grad_w += 0.3779644803f * inp1[14] * in2[7] * go[3];
                grad_w += 0.3779644803f * inp1[14] * in2[8] * go[2];
                grad_w += -0.4629100412f * inp1[15] * in2[4] * go[1];
                grad_w += 0.4629100412f * inp1[15] * in2[8] * go[3];
                atomicAdd(&grad_weights[27 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 28: (3,2)->2
            {
                float grad_w = 0.0f;
                grad_w += 0.4225771204f * inp1[9] * in2[4] * go[5];
                grad_w += -0.4225771204f * inp1[9] * in2[5] * go[4];
                grad_w += 0.4225771204f * inp1[9] * in2[7] * go[8];
                grad_w += -0.4225771204f * inp1[9] * in2[8] * go[7];
                grad_w += 0.5976142935f * inp1[10] * in2[6] * go[8];
                grad_w += -0.5976142935f * inp1[10] * in2[8] * go[6];
                grad_w += 0.3273268423f * inp1[11] * in2[4] * go[5];
                grad_w += -0.3273268423f * inp1[11] * in2[5] * go[4];
                grad_w += 0.3779644601f * inp1[11] * in2[6] * go[7];
                grad_w += -0.3779644601f * inp1[11] * in2[7] * go[6];
                grad_w += -0.3273268423f * inp1[11] * in2[7] * go[8];
                grad_w += 0.3273268423f * inp1[11] * in2[8] * go[7];
                grad_w += 0.2672612446f * inp1[12] * in2[4] * go[8];
                grad_w += -0.5345224892f * inp1[12] * in2[5] * go[7];
                grad_w += 0.5345224892f * inp1[12] * in2[7] * go[5];
                grad_w += -0.2672612446f * inp1[12] * in2[8] * go[4];
                grad_w += -0.3273268423f * inp1[13] * in2[4] * go[7];
                grad_w += 0.3779644601f * inp1[13] * in2[5] * go[6];
                grad_w += -0.3273268423f * inp1[13] * in2[5] * go[8];
                grad_w += -0.3779644601f * inp1[13] * in2[6] * go[5];
                grad_w += 0.3273268423f * inp1[13] * in2[7] * go[4];
                grad_w += 0.3273268423f * inp1[13] * in2[8] * go[5];
                grad_w += 0.5976142935f * inp1[14] * in2[4] * go[6];
                grad_w += -0.5976142935f * inp1[14] * in2[6] * go[4];
                grad_w += 0.4225771204f * inp1[15] * in2[4] * go[7];
                grad_w += -0.4225771204f * inp1[15] * in2[5] * go[8];
                grad_w += -0.4225771204f * inp1[15] * in2[7] * go[4];
                grad_w += 0.4225771204f * inp1[15] * in2[8] * go[5];
                atomicAdd(&grad_weights[28 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 29: (3,2)->3
            {
                float grad_w = 0.0f;
                grad_w += -0.2886751401f * inp1[9] * in2[4] * go[13];
                grad_w += 0.4564354668f * inp1[9] * in2[5] * go[14];
                grad_w += -0.6454972118f * inp1[9] * in2[6] * go[9];
                grad_w += 0.4564354668f * inp1[9] * in2[7] * go[10];
                grad_w += -0.2886751401f * inp1[9] * in2[8] * go[11];
                grad_w += -0.5773502803f * inp1[10] * in2[4] * go[12];
                grad_w += 0.3535533840f * inp1[10] * in2[5] * go[13];
                grad_w += -0.4564354668f * inp1[10] * in2[5] * go[15];
                grad_w += 0.4564354668f * inp1[10] * in2[7] * go[9];
                grad_w += 0.3535533840f * inp1[10] * in2[7] * go[11];
                grad_w += 0.4472135802f * inp1[11] * in2[4] * go[13];
                grad_w += 0.2886751401f * inp1[11] * in2[4] * go[15];
                grad_w += 0.1825741828f * inp1[11] * in2[5] * go[12];
                grad_w += -0.3535533840f * inp1[11] * in2[5] * go[14];
                grad_w += 0.3872983429f * inp1[11] * in2[6] * go[11];
                grad_w += 0.3535533840f * inp1[11] * in2[7] * go[10];
                grad_w += -0.2886751401f * inp1[11] * in2[8] * go[9];
                grad_w += -0.4472135802f * inp1[11] * in2[8] * go[11];
                grad_w += -0.5773502803f * inp1[12] * in2[4] * go[10];
                grad_w += 0.1825741828f * inp1[12] * in2[5] * go[11];
                grad_w += 0.5163977773f * inp1[12] * in2[6] * go[12];
                grad_w += 0.1825741828f * inp1[12] * in2[7] * go[13];
                grad_w += -0.5773502803f * inp1[12] * in2[8] * go[14];
                grad_w += -0.2886751401f * inp1[13] * in2[4] * go[9];
                grad_w += 0.4472135802f * inp1[13] * in2[4] * go[11];
                grad_w += 0.3535533840f * inp1[13] * in2[5] * go[10];
                grad_w += 0.3872983429f * inp1[13] * in2[6] * go[13];
                grad_w += 0.1825741828f * inp1[13] * in2[7] * go[12];
                grad_w += 0.3535533840f * inp1[13] * in2[7] * go[14];
                grad_w += 0.4472135802f * inp1[13] * in2[8] * go[13];
                grad_w += -0.2886751401f * inp1[13] * in2[8] * go[15];
                grad_w += 0.4564354668f * inp1[14] * in2[5] * go[9];
                grad_w += -0.3535533840f * inp1[14] * in2[5] * go[11];
                grad_w += 0.3535533840f * inp1[14] * in2[7] * go[13];
                grad_w += 0.4564354668f * inp1[14] * in2[7] * go[15];
                grad_w += -0.5773502803f * inp1[14] * in2[8] * go[12];
                grad_w += 0.2886751401f * inp1[15] * in2[4] * go[11];
                grad_w += -0.4564354668f * inp1[15] * in2[5] * go[10];
                grad_w += -0.6454972118f * inp1[15] * in2[6] * go[15];
                grad_w += 0.4564354668f * inp1[15] * in2[7] * go[14];
                grad_w += -0.2886751401f * inp1[15] * in2[8] * go[13];
                atomicAdd(&grad_weights[29 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 30: (3,3)->0
            {
                float grad_w = 0.0f;
                grad_w += 0.3779644668f * inp1[9] * in2[9] * go[0];
                grad_w += 0.3779644668f * inp1[10] * in2[10] * go[0];
                grad_w += 0.3779644668f * inp1[11] * in2[11] * go[0];
                grad_w += 0.3779644668f * inp1[12] * in2[12] * go[0];
                grad_w += 0.3779644668f * inp1[13] * in2[13] * go[0];
                grad_w += 0.3779644668f * inp1[14] * in2[14] * go[0];
                grad_w += 0.3779644668f * inp1[15] * in2[15] * go[0];
                atomicAdd(&grad_weights[30 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 31: (3,3)->1
            {
                float grad_w = 0.0f;
                grad_w += -0.2314550206f * inp1[9] * in2[10] * go[1];
                grad_w += 0.2314550206f * inp1[9] * in2[14] * go[3];
                grad_w += -0.5669467075f * inp1[9] * in2[15] * go[2];
                grad_w += 0.2314550206f * inp1[10] * in2[9] * go[1];
                grad_w += -0.2988071538f * inp1[10] * in2[11] * go[1];
                grad_w += 0.2988071538f * inp1[10] * in2[13] * go[3];
                grad_w += -0.3779644803f * inp1[10] * in2[14] * go[2];
                grad_w += 0.2314550206f * inp1[10] * in2[15] * go[3];
                grad_w += 0.2988071538f * inp1[11] * in2[10] * go[1];
                grad_w += 0.4629100412f * inp1[11] * in2[12] * go[3];
                grad_w += -0.1889822401f * inp1[11] * in2[13] * go[2];
                grad_w += 0.2988071538f * inp1[11] * in2[14] * go[3];
                grad_w += -0.4629100412f * inp1[12] * in2[11] * go[3];
                grad_w += 0.4629100412f * inp1[12] * in2[13] * go[1];
                grad_w += -0.2988071538f * inp1[13] * in2[10] * go[3];
                grad_w += 0.1889822401f * inp1[13] * in2[11] * go[2];
                grad_w += -0.4629100412f * inp1[13] * in2[12] * go[1];
                grad_w += 0.2988071538f * inp1[13] * in2[14] * go[1];
                grad_w += -0.2314550206f * inp1[14] * in2[9] * go[3];
                grad_w += 0.3779644803f * inp1[14] * in2[10] * go[2];
                grad_w += -0.2988071538f * inp1[14] * in2[11] * go[3];
                grad_w += -0.2988071538f * inp1[14] * in2[13] * go[1];
                grad_w += 0.2314550206f * inp1[14] * in2[15] * go[1];
                grad_w += 0.5669467075f * inp1[15] * in2[9] * go[2];
                grad_w += -0.2314550206f * inp1[15] * in2[10] * go[3];
                grad_w += -0.2314550206f * inp1[15] * in2[14] * go[1];
                atomicAdd(&grad_weights[31 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 32: (3,3)->2
            {
                float grad_w = 0.0f;
                grad_w += -0.5455447150f * inp1[9] * in2[9] * go[6];
                grad_w += 0.3857583768f * inp1[9] * in2[10] * go[7];
                grad_w += -0.2439750229f * inp1[9] * in2[11] * go[8];
                grad_w += -0.2439750229f * inp1[9] * in2[13] * go[4];
                grad_w += 0.3857583768f * inp1[9] * in2[14] * go[5];
                grad_w += 0.3857583768f * inp1[10] * in2[9] * go[7];
                grad_w += 0.2988071467f * inp1[10] * in2[11] * go[7];
                grad_w += -0.4879500459f * inp1[10] * in2[12] * go[4];
                grad_w += 0.2988071467f * inp1[10] * in2[13] * go[5];
                grad_w += -0.3857583768f * inp1[10] * in2[15] * go[5];
                grad_w += -0.2439750229f * inp1[11] * in2[9] * go[8];
                grad_w += 0.2988071467f * inp1[11] * in2[10] * go[7];
                grad_w += 0.3273268423f * inp1[11] * in2[11] * go[6];
                grad_w += -0.3779644601f * inp1[11] * in2[11] * go[8];
                grad_w += 0.1543033474f * inp1[11] * in2[12] * go[5];
                grad_w += 0.3779644601f * inp1[11] * in2[13] * go[4];
                grad_w += -0.2988071467f * inp1[11] * in2[14] * go[5];
                grad_w += 0.2439750229f * inp1[11] * in2[15] * go[4];
                grad_w += -0.4879500459f * inp1[12] * in2[10] * go[4];
                grad_w += 0.1543033474f * inp1[12] * in2[11] * go[5];
                grad_w += 0.4364357787f * inp1[12] * in2[12] * go[6];
                grad_w += 0.1543033474f * inp1[12] * in2[13] * go[7];
                grad_w += -0.4879500459f * inp1[12] * in2[14] * go[8];
                grad_w += -0.2439750229f * inp1[13] * in2[9] * go[4];
                grad_w += 0.2988071467f * inp1[13] * in2[10] * go[5];
                grad_w += 0.3779644601f * inp1[13] * in2[11] * go[4];
                grad_w += 0.1543033474f * inp1[13] * in2[12] * go[7];
                grad_w += 0.3273268423f * inp1[13] * in2[13] * go[6];
                grad_w += 0.3779644601f * inp1[13] * in2[13] * go[8];
                grad_w += 0.2988071467f * inp1[13] * in2[14] * go[7];
                grad_w += -0.2439750229f * inp1[13] * in2[15] * go[8];
                grad_w += 0.3857583768f * inp1[14] * in2[9] * go[5];
                grad_w += -0.2988071467f * inp1[14] * in2[11] * go[5];
                grad_w += -0.4879500459f * inp1[14] * in2[12] * go[8];
                grad_w += 0.2988071467f * inp1[14] * in2[13] * go[7];
                grad_w += 0.3857583768f * inp1[14] * in2[15] * go[7];
                grad_w += -0.3857583768f * inp1[15] * in2[10] * go[5];
                grad_w += 0.2439750229f * inp1[15] * in2[11] * go[4];
                grad_w += -0.2439750229f * inp1[15] * in2[13] * go[8];
                grad_w += 0.3857583768f * inp1[15] * in2[14] * go[7];
                grad_w += -0.5455447150f * inp1[15] * in2[15] * go[6];
                atomicAdd(&grad_weights[32 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
            // Path 33: (3,3)->3
            {
                float grad_w = 0.0f;
                grad_w += 0.4082483091f * inp1[9] * in2[10] * go[11];
                grad_w += -0.4082483091f * inp1[9] * in2[11] * go[10];
                grad_w += -0.4082483091f * inp1[9] * in2[12] * go[15];
                grad_w += 0.4082483091f * inp1[9] * in2[13] * go[14];
                grad_w += -0.4082483091f * inp1[9] * in2[14] * go[13];
                grad_w += 0.4082483091f * inp1[9] * in2[15] * go[12];
                grad_w += -0.4082483091f * inp1[10] * in2[9] * go[11];
                grad_w += 0.4082483091f * inp1[10] * in2[11] * go[9];
                grad_w += 0.4082483091f * inp1[10] * in2[12] * go[14];
                grad_w += 0.4082483091f * inp1[10] * in2[13] * go[15];
                grad_w += -0.4082483091f * inp1[10] * in2[14] * go[12];
                grad_w += -0.4082483091f * inp1[10] * in2[15] * go[13];
                grad_w += 0.4082483091f * inp1[11] * in2[9] * go[10];
                grad_w += -0.4082483091f * inp1[11] * in2[10] * go[9];
                grad_w += 0.4082483091f * inp1[11] * in2[12] * go[13];
                grad_w += -0.4082483091f * inp1[11] * in2[13] * go[12];
                grad_w += -0.4082483091f * inp1[11] * in2[14] * go[15];
                grad_w += 0.4082483091f * inp1[11] * in2[15] * go[14];
                grad_w += 0.4082483091f * inp1[12] * in2[9] * go[15];
                grad_w += -0.4082483091f * inp1[12] * in2[10] * go[14];
                grad_w += -0.4082483091f * inp1[12] * in2[11] * go[13];
                grad_w += 0.4082483091f * inp1[12] * in2[13] * go[11];
                grad_w += 0.4082483091f * inp1[12] * in2[14] * go[10];
                grad_w += -0.4082483091f * inp1[12] * in2[15] * go[9];
                grad_w += -0.4082483091f * inp1[13] * in2[9] * go[14];
                grad_w += -0.4082483091f * inp1[13] * in2[10] * go[15];
                grad_w += 0.4082483091f * inp1[13] * in2[11] * go[12];
                grad_w += -0.4082483091f * inp1[13] * in2[12] * go[11];
                grad_w += 0.4082483091f * inp1[13] * in2[14] * go[9];
                grad_w += 0.4082483091f * inp1[13] * in2[15] * go[10];
                grad_w += 0.4082483091f * inp1[14] * in2[9] * go[13];
                grad_w += 0.4082483091f * inp1[14] * in2[10] * go[12];
                grad_w += 0.4082483091f * inp1[14] * in2[11] * go[15];
                grad_w += -0.4082483091f * inp1[14] * in2[12] * go[10];
                grad_w += -0.4082483091f * inp1[14] * in2[13] * go[9];
                grad_w += -0.4082483091f * inp1[14] * in2[15] * go[11];
                grad_w += -0.4082483091f * inp1[15] * in2[9] * go[12];
                grad_w += 0.4082483091f * inp1[15] * in2[10] * go[13];
                grad_w += -0.4082483091f * inp1[15] * in2[11] * go[14];
                grad_w += 0.4082483091f * inp1[15] * in2[12] * go[9];
                grad_w += -0.4082483091f * inp1[15] * in2[13] * go[10];
                grad_w += 0.4082483091f * inp1[15] * in2[14] * go[11];
                atomicAdd(&grad_weights[33 * c_in_count * c_out_count + c_in * c_out_count + c_out], grad_w);
            }
        }
    }
}

} // namespace fused
} // namespace batteries